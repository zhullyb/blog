<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Apache HTTP Server (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Apache_HTTP_Server_Русский rootpage-Apache_HTTP_Server_Русский skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Apache HTTP Server (Русский)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Ссылки по теме</p>
<ul>
<li><a href="../en/PHP.html" title="PHP">PHP</a></li>
<li><a href="../en/MySQL.html" class="mw-redirect" title="MySQL (Русский)">MySQL (Русский)</a></li>
<li><a href="../en/PhpMyAdmin.html" title="PhpMyAdmin">PhpMyAdmin</a></li>
<li><a href="../en/Adminer.html" title="Adminer">Adminer</a></li>
<li><a href="../en/XAMPP.html" title="XAMPP">XAMPP</a></li>
<li><a href="../en/Apache_HTTP_Server/mod_perl.html" class="mw-redirect" title="Mod perl">mod_perl</a></li>
</ul>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>Эта статья или раздел нуждается в <a href="../ru/ArchWiki:Contributing.html#%D0%9F%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4" title="ArchWiki:Contributing (Русский)">переводе</a></b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Примечания:</b> в английской версии накопилось много изменений (обсуждение: <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Apache_HTTP_Server_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:Apache HTTP Server (Русский)#</a>)</div>
</div>
<p><a href="https://en.wikipedia.org/wiki/ru:Apache" class="extiw" title="wikipedia:ru:Apache">Apache HTTP Server</a>, или сокращенно Apache — популярный веб-сервер, разработанный Apache Software Foundation.
</p>
<p>Apache часто используется вместе с языком сценариев PHP и СУБД MySQL. Такую комбинацию обычно называют <a href="https://en.wikipedia.org/wiki/ru:LAMP" class="extiw" title="wikipedia:ru:LAMP">LAMP</a> (<b>L</b>inux, <b>A</b>pache, <b>M</b>ySQL, <b>P</b>HP). Эта статья объясняет, как настроить Apache и как интегрировать с ним <a href="../en/PHP.html" title="PHP">PHP</a> и <a href="../en/MySQL.html" title="MySQL">MySQL</a>.
</p>
<p>Если вам нужно быстро создать окружение для разработки и тестирования, то можете просто установить <a href="../en/XAMPP.html" class="mw-redirect" title="XAMPP (Русский)">Xampp</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0"><span class="tocnumber">1</span> <span class="toctext">Установка</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0"><span class="tocnumber">2</span> <span class="toctext">Настройка</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%D0%94%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%BE%D0%BF%D1%86%D0%B8%D0%B8"><span class="tocnumber">2.1</span> <span class="toctext">Дополнительные опции</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%D0%9F%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D0%B5_%D0%BA%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%D0%B8"><span class="tocnumber">2.2</span> <span class="toctext">Пользовательские каталоги</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#TLS/SSL"><span class="tocnumber">2.3</span> <span class="toctext">TLS/SSL</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D1%85%D0%BE%D1%81%D1%82%D1%8B"><span class="tocnumber">2.4</span> <span class="toctext">Виртуальные хосты</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%B8%D0%BC_%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE%D0%BC_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D1%85%D0%BE%D1%81%D1%82%D0%BE%D0%B2"><span class="tocnumber">2.4.1</span> <span class="toctext">Управление большим количеством виртуальных хостов</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D1%8F"><span class="tocnumber">3</span> <span class="toctext">Расширения</span></a>
<ul>
<li class="toclevel-2 tocsection-9">
<a href="#PHP"><span class="tocnumber">3.1</span> <span class="toctext">PHP</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#%D0%94%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D1%8B"><span class="tocnumber">3.1.1</span> <span class="toctext">Дополнительные параметры</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_php5_c_php-fpm_%D0%B8_mod_proxy_fcgi"><span class="tocnumber">3.1.2</span> <span class="toctext">Использование php5 c php-fpm и mod_proxy_fcgi</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_php5_c_apache2-mpm-worker_%D0%B8_mod_fcgid"><span class="tocnumber">3.1.3</span> <span class="toctext">Использование php5 c apache2-mpm-worker и mod_fcgid</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#MySQL/MariaDB"><span class="tocnumber">3.1.4</span> <span class="toctext">MySQL/MariaDB</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-14">
<a href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC"><span class="tocnumber">4</span> <span class="toctext">Решение проблем</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D0%B6%D1%83%D1%80%D0%BD%D0%B0%D0%BB%D0%B0_%D0%B8_%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B5%D0%B3%D0%BE_%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F_Apache"><span class="tocnumber">4.1</span> <span class="toctext">Просмотр журнала и текущего состояния Apache</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#PID_file_/run/httpd/httpd.pid_not_readable_(yet?)_after_start"><span class="tocnumber">4.2</span> <span class="toctext">PID file /run/httpd/httpd.pid not readable (yet?) after start</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%D0%9E%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81_Apache_2.2_%D0%B4%D0%BE_2.4"><span class="tocnumber">4.3</span> <span class="toctext">Обновление с Apache 2.2 до 2.4</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Apache_is_running_a_threaded_MPM,_but_your_PHP_Module_is_not_compiled_to_be_threadsafe"><span class="tocnumber">4.4</span> <span class="toctext">Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=apache">apache</a></span>, доступный в <a href="../ru/Official_repositories.html" title="Official repositories (Русский)">официальных репозиториях</a>.
</p>
<h2>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"></span><span class="mw-headline" id="Настройка">Настройка</span>
</h2>
<p>Файлы настроек Apache находятся в <code>/etc/httpd/conf</code>. Основным файлом является <code>/etc/httpd/conf/httpd.conf</code>, который может по ссылкам включать в себя дополнительные файлы с настройками. В большинстве случаев будет достаточно стандартных настроек из этого файла. По умолчанию корневым каталогом веб-сервера является <code>/srv/http</code>.
</p>
<p>Для старта Apache <a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Запустите">запустите</a> службу <code>httpd.service</code>.
</p>
<p>После этих действий Apache должен запуститься. Проверьте работает ли он, набрав в адресной строке браузера <code><a rel="nofollow" class="external free" href="http://localhost/">http://localhost/</a></code>. Веб-сервер должен отправить вам простую тестовую страничку.
</p>
<p>При необходимости дальнейшей настройки сервера смотрите следующие разделы.
</p>
<h3>
<span id=".D0.94.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5_.D0.BE.D0.BF.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Дополнительные_опции">Дополнительные опции</span>
</h3>
<p>Следующие опции (<i>директивы</i>) в <code>/etc/httpd/conf/httpd.conf</code> могут быть вам интересны:
</p>
<pre>User http
</pre>
<dl><dd>По соображениям безопасности при запуске сервера Apache от имени суперпользователя (напрямую или через скрипт инициализации) происходит смена идентификатора пользователя (UID), от имени которого выполняется процесс сервера. По умолчанию используется пользователь <code>http</code>, который не имеет привилегированных полномочий в системе.</dd></dl>
<pre>Listen 80
</pre>
<dl><dd>Это порт, через который Apache принимает входящие соединения. Если сервер имеет выход в интернет через маршрутизатор, необходимо будет настроить перенаправление этого порта.</dd></dl>
<dl><dd>Если вы используете Apache для разработки и тестирования, вы можете разрешить только локальный доступ к нему. Для этого укажите <code>Listen 127.0.0.1:80</code>.</dd></dl>
<pre>ServerAdmin you@example.com
</pre>
<dl><dd>Адрес электронной почты администратора, который будет выводиться, например, на странице ошибки Apache.</dd></dl>
<pre>DocumentRoot "/srv/http"
</pre>
<dl><dd>Это корневая директория Apache, в которой можно разместить ваши веб-страницы.</dd></dl>
<dl><dd>Измените ее, если нужно, но не забудьте также поменять путь в директиве <code>&lt;Directory "/srv/http"&gt;</code> на новое расположение <code>DocumentRoot</code>, иначе вы, скорее всего, получите сообщение об ошибке <b>403 Error</b> (недостаточно полномочий) при попытке получить доступ к новому корневому каталогу Apache. Также не забудьте изменить строку <code>Require all denied</code> на <code>Require all granted</code>, иначе снова получите ошибку <b>403 Error</b>. Помните, что директория DocumentRoot и ее родительские папки должны иметь разрешения на запуск для всех (можно установить командой <code>chmod o+x /path/to/DocumentRoot&gt;</code>), в противном случае вы получите ошибку <b>403 Error</b>.</dd></dl>
<pre>AllowOverride None
</pre>
<dl><dd>Запрещает переопределение настроек. Если в секции <code>&lt;Directory&gt;</code> указана эта директива, Apache будет полностью игнорировать настройки в файле <code>.htaccess</code>. Обратите внимание, что теперь такая настройка для Apache 2.4 является настройкой по умолчанию, поэтому если вы планируете использовать <code>.htaccess</code>, вам необходимо дать соответствующие разрешения. Если вы собираетесь включить модуль <code>mod_rewrite</code> или использовать настройки в <code>.htaccess</code>, вы можете определить какие из директив, объявленных в этих файлах, могут перезаписывать конфигурацию сервера. Для получения дополнительной информации обратитесь к <a rel="nofollow" class="external text" href="http://httpd.apache.org/docs/current/mod/core.html#allowoverride">документации Apache</a>.</dd></dl>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Вы можете проверить корректность настроек Apache без запуска сервера командой <code>apachectl configtest</code>.</div>
<p>Дополнительные настройки можно найти в <code>/etc/httpd/conf/extra/httpd-default.conf</code>.
</p>
<p>Чтобы полностью отключить вывод версии Apache в генерируемых сервером страницах, добавьте:
</p>
<pre>ServerSignature Off
</pre>
<p>Чтобы подавить вывод такой информации, как версии Apache и PHP, добавьте:
</p>
<pre>ServerTokens Prod
</pre>
<h3>
<span id=".D0.9F.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D1.81.D0.BA.D0.B8.D0.B5_.D0.BA.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3.D0.B8"></span><span class="mw-headline" id="Пользовательские_каталоги">Пользовательские каталоги</span>
</h3>
<p>По умолчанию доступ к каталогам пользователей возможен по адресу <code>http://localhost/~''user''/</code>, который показывает содержимое каталога <code>~/public_html</code> (его имя и расположение задается в файле <code>/etc/httpd/conf/extra/httpd-userdir.conf</code>).
</p>
<p>Если вы не хотите, чтобы пользовательские каталоги были доступны через web, закомментируйте следующую строку в <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>Include conf/extra/httpd-userdir.conf
</pre>
<p>Убедитесь, что права доступа к вашему домашнему каталогу и <code>~/public_html</code> позволяют получать доступ к файлам в них <b>всем</b> пользователям:
</p>
<pre>$ chmod o+x ~
$ chmod o+x ~/public_html
$ chmod -R o+r ~/public_html
</pre>
<p>Однако с точки зрения безопасности вышеприведенное решение слишком фривольно. Правильнее поступить по-другому. Сначала добавьте пользователя <b>http</b> в группу, которой принадлежит ваша домашняя папка. Например, если ваша домашняя папка и все ее подкаталоги принадлежат группе <b>piter</b>, можно проделать следующее:
</p>
<pre># usermod -aG piter http
</pre>
<p>или
</p>
<pre># gpasswd -a http piter
</pre>
<p>После этого назначьте права на <i>чтение</i> и <i>исполнение</i> для каталогов <code>~/</code>,  <code>~/public_html</code> и, рекурсивно, на остальные подкаталоги для <code>~/public_html</code> для членов группы (в нашем примере для членов группы <b>piter</b>). Опираясь на нижеприведенный шаблон, осуществите эти мероприятия:
</p>
<pre>$ chmod g+xr-w /home/<i>yourusername</i>
$ chmod -R g+xr-w /home/<i>yourusername</i>/public_html
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Таким образом, только пользователь <b>http</b> и все потенциальные пользователи группы <b>piter</b> будут иметь разделяемый доступ к вашему домашнему каталогу.</div>
<p><a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">Перезапустите</a> службу <code>httpd.service</code>, чтобы изменения вступили в силу. Смотрите также <a href="../en/Umask.html#Set_the_mask_value" title="Umask">Umask#Set the mask value</a>.
</p>
<h3>
<span id="TLS.2FSSL"></span><span class="mw-headline" id="TLS/SSL">TLS/SSL</span>
</h3>
<p>Для использования TLS/SSL необходимо установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssl">openssl</a></span>.
</p>
<p>Создайте закрытый ключ и запрос на получение сертификата (CSR). Также вы можете <a href="https://en.wikipedia.org/wiki/ru:%D0%A1%D0%B0%D0%BC%D0%BE%D0%B7%D0%B0%D0%B2%D0%B5%D1%80%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82" class="extiw" title="wikipedia:ru:Самозаверенный сертификат">самозаверить</a> CSR (который создаст сертификат):
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Вы можете настроить длину ключа в битах (<code>rsa_keygen_bits:2048</code>). Также вы можете убрать опцию <code>-sha256</code> для использования SHA-1 вместо SHA-2 или изменить время его действия в днях (<code>-days 365</code>).</div>
<pre># cd /etc/httpd/conf
# openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -out server.key
# chmod 600 server.key
# openssl req -new -sha256 -key server.key -out server.csr
# openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt
</pre>
<p>Теперь раскомментируйте следующие строки в <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>LoadModule ssl_module modules/mod_ssl.so
LoadModule socache_shmcb_module modules/mod_socache_shmcb.so
Include conf/extra/httpd-ssl.conf
</pre>
<p><a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">Перезапустите</a> службу <code>httpd.service</code>, чтобы изменения вступили в силу.
</p>
<h3>
<span id=".D0.92.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5_.D1.85.D0.BE.D1.81.D1.82.D1.8B"></span><span class="mw-headline" id="Виртуальные_хосты">Виртуальные хосты</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Вам нужно будет добавить отдельную секцию <code>&lt;VirtualHost dommainame:443&gt;</code> для поддержки SSL на виртуальном хосте. Пример файла можно посмотреть ниже: <a href="#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%B8%D0%BC_%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE%D0%BC_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D1%85%D0%BE%D1%81%D1%82%D0%BE%D0%B2">#Управление большим количеством виртуальных хостов</a>.</div>
<p>Если вы хотите, чтобы Apache обслуживал не один, а несколько хостов, раскомментируйте следующую строку в файле <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>Include conf/extra/httpd-vhosts.conf
</pre>
<p>Укажите свои виртуальные хосты в <code>/etc/httpd/conf/extra/httpd-vhosts.conf</code>. Файл уже содержит пример полностью рабочих настроек, что поможет вам быстро выполнить настройки под ваши нужды.
</p>
<p>Для проверки виртуальных хостов на локальной машине добавьте их виртуальные имена в ваш файл <code>/etc/hosts</code>:
</p>
<pre>127.0.0.1 domainname1.dom 
127.0.0.1 domainname2.dom
</pre>
<p><a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">Перезапустите</a> <code>httpd.service</code>, чтобы изменения вступили в силу.
</p>
<h4>
<span id=".D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B1.D0.BE.D0.BB.D1.8C.D1.88.D0.B8.D0.BC_.D0.BA.D0.BE.D0.BB.D0.B8.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.BE.D0.BC_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D1.85.D0.BE.D1.81.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Управление_большим_количеством_виртуальных_хостов">Управление большим количеством виртуальных хостов</span>
</h4>
<p>Если Apache используется для обслуживания очень большого количества виртуальных хостов, вам может быть полезна возможность их легко включать и отключать. Для этого рекомендуется создавать собственный файл настроек на каждый хост и хранить все эти файлы в одном каталоге, например <code>/etc/httpd/conf/vhosts</code>.
</p>
<p>Сначала создайте каталог:
</p>
<pre># mkdir /etc/httpd/conf/vhosts
</pre>
<p>Теперь создайте в нем отдельные конфигурационные файлы:
</p>
<pre># nano /etc/httpd/conf/vhosts/domainname1.dom
# nano /etc/httpd/conf/vhosts/domainname2.dom
...
</pre>
<p>И включите эти файлы в основной файл настроек <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>#Enabled Vhosts:
Include conf/vhosts/domainname1.dom
Include conf/vhosts/domainname2.dom
...
</pre>
<p>Теперь можно быстро включать/отключать требуемые виртуальные хосты, просто закомментировав или раскомментировав соответствующие директивы <code>Include</code> в основном файле настроек.
</p>
<p>Очень простой файл виртуального хоста будет выглядеть следующим образом:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/vhosts/domainname1.dom</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;VirtualHost domainname1.dom:80&gt;
    ServerAdmin webmaster@domainname1.dom
    DocumentRoot "/home/user/http/domainname1.dom"
    ServerName domainname1.dom
    ServerAlias domainname1.dom
    ErrorLog "/var/log/httpd/domainname1.dom-error_log"
    CustomLog "/var/log/httpd/domainname1.dom-access_log" common

    &lt;Directory "/home/user/http/domainname1.dom"&gt;
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;

&lt;VirtualHost domainname1.dom:443&gt;
    ServerAdmin webmaster@domainname1.dom
    DocumentRoot "/home/user/http/domainname1.dom"
    ServerName domainname1.dom:443
    ServerAlias domainname1.dom:443
    ErrorLog "/var/log/httpd/domainname1.dom-error_log"
    CustomLog "/var/log/httpd/domainname1.dom-access_log" common

    &lt;Directory "/home/user/http/domainname1.dom"&gt;
        Require all granted
    &lt;/Directory&gt;

    SSLEngine on
    SSLCertificateFile "/etc/httpd/conf/server.crt"
    SSLCertificateKeyFile "/etc/httpd/conf/server.key"
&lt;/VirtualHost&gt;</pre>
<h2>
<span id=".D0.A0.D0.B0.D1.81.D1.88.D0.B8.D1.80.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Расширения">Расширения</span>
</h2>
<h3><span class="mw-headline" id="PHP">PHP</span></h3>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> <a href="../en/PHP.html" title="PHP">PHP</a> с пакетами <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php">php</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apache">php-apache</a></span>, доступными в <a href="../ru/Official_repositories.html" title="Official repositories (Русский)">официальных репозиториях</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <code>libphp7.so</code> входящий в <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apache">php-apache</a></span>, не работает с <code>mod_mpm_event</code> (<a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/39218">FS#39218</a>). Вместо него следует использовать <code>mod_mpm_prefork</code>. В противном случае, вы получите следующее сообщение об ошибке:
<pre>Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.  You need to recompile PHP.
AH00013: Pre-configuration failed
httpd.service: control process exited, code=exited status=1</pre>
<p>Для использования <code>mod_mpm_prefork</code>, откройте <code>/etc/httpd/conf/httpd.conf</code> и поменяйте строку
</p>
<pre>LoadModule mpm_event_module modules/mod_mpm_event.so</pre>
<p>на
</p>
<pre>LoadModule mpm_prefork_module modules/mod_mpm_prefork.so</pre>
Также вы можете просто использовать <code>mod_proxy_fcgi</code> (смотрите <a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_php7_c_php-fpm_%D0%B8_mod_proxy_fcgi">#Использование php7 c php-fpm и mod_proxy_fcgi</a><sup>[<a href="../en/Help:Procedures.html#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup>).</div>
<p>Чтобы включить модуль PHP, добавьте следующие строки в <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<ul><li>Поместите эту строку в любом месте после строки <code>LoadModule dir_module modules/mod_dir.so</code>:</li></ul>
<pre> LoadModule php7_module modules/libphp7.so
</pre>
<ul><li>Разместите эту строку в конце списка <code>Include</code>:</li></ul>
<pre> Include conf/extra/php7_module.conf
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если вы не обнаружите библиотеку <code>libphp7.so</code> в каталоге (<code>/etc/httpd/modules</code>), то вероятнее всего, что вы не установили <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apache">php-apache</a></span>.</div>
<p>Если ваш корневой каталог <code>DocumentRoot</code> не <code>/srv/http</code>, добавьте его в список <code>open_basedir</code> в <code>/etc/php/php.ini</code> (необязательно):
</p>
<pre> open_basedir=/srv/http/:/home/:/tmp/:/usr/share/pear/:<i>/путь/до/корневого/каталога</i>
</pre>
<p><a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">Перезапустите</a> службу <code>httpd.service</code>, чтобы изменения вступили в силу.
</p>
<p>Чтобы убедиться в том, что PHP настроен корректно, создайте файл <code>test.php</code> в каталоге <code>DocumentRoot</code> (то есть в <code>/srv/http/</code> или <code>~/public_html</code>) и поместите в него следующий код:
</p>
<pre>&lt;?php phpinfo(); ?&gt;
</pre>
<p>По адресу http://localhost/test.php или http://localhost/''~пользователь''/test.php вы должны увидеть информационную страницу PHP.
</p>
<p>Если PHP-код не исполняется, а на странице браузера вы увидите содержимое <code>test.php</code>, проверьте добавили ли вы <code>Includes</code> в строку <code>Options</code> для вашего корневого каталога в <code>/etc/httpd/conf/httpd.conf</code>. Кроме того, убедитесь, что <code>TypesConfig conf/mime.types</code> раскомментирован в секции &lt;IfModule mime_module&gt;. Также можно попробовать добавить нижеследующую строку в секцию <code>&lt;IfModule mime_module&gt;</code> файла <code>httpd.conf</code>:
</p>
<pre>AddHandler application/x-httpd-php .php
</pre>
<p>Дополнительную информацию вы можете получить на странице <a href="../en/PHP.html" title="PHP">PHP</a>.
</p>
<h4>
<span id=".D0.94.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5_.D0.BF.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D1.8B"></span><span class="mw-headline" id="Дополнительные_параметры">Дополнительные параметры</span>
</h4>
<p>Рекомендуется правильно настроить вашу временную зону (<a rel="nofollow" class="external text" href="http://www.php.net/manual/en/timezones.php">список временных зон</a>) в <code>/etc/php/php.ini</code> по примеру:
</p>
<pre>date.timezone = Europe/Moscow</pre>
<p>По желанию включите режим показа ошибок при отладке PHP-кода, для этого измените значение опции <code>display_errors</code> на <code>On</code> в файле <code>/etc/php/php.ini</code>:
</p>
<pre>display_errors=On
</pre>
<p>Ежели вы хотите использовать модуль <code>libGD</code>, установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-gd">php-gd</a></span> и раскомментируйте <code>extension=gd.so</code> в <code>/etc/php/php.ini</code>:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-gd">php-gd</a></span> требует <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpng">libpng</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libjpeg-turbo">libjpeg-turbo</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=freetype2">freetype2</a></span>.</div>
<pre>extension=gd.so
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Проверьте, какие расширения PHP вы раскомментируете. Подключайте только те расширения, которые необходимы и достаточны для работы.</div>
<p>Для использования модуля <code>mcrypt</code> установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-mcrypt">php-mcrypt</a></span><sup>[<a href="../en/ArchWiki:Requests.html#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> и раскомментируйте <code>extension=mcrypt.so</code>  в <code>/etc/php/php.ini</code>:
</p>
<pre>extension=mcrypt.so
</pre>
<p>Не забудьте добавить индексные файлы <code>/etc/httpd/conf/extra/php7_module.conf</code>, если это необходимо:
</p>
<pre>DirectoryIndex index.php index.phtml index.html
</pre>
<p>Для дополнительной настройки, пожалуйста прочтите <a href="../en/PHP.html" title="PHP">PHP</a>.
</p>
<h4>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_php5_c_php-fpm_.D0.B8_mod_proxy_fcgi"></span><span class="mw-headline" id="Использование_php5_c_php-fpm_и_mod_proxy_fcgi">Использование php5 c php-fpm и mod_proxy_fcgi</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> В отличие от широко распространенной установки с ProxyPass, конфигурация прокси с SetHandler использует директивы DirectoryIndex. Это обеспечивает лучшую совместимость с программным обеспечением, разработанным для libphp5, mod_fastcgi и mod_fcgid.
Если вы хотите попробовать ProxyPass, используйте такую строку: <pre>ProxyPassMatch ^/(.*\.php(/.*)?)$ unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/srv/http/$1</pre>
</div>
<ul><li>
<a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-fpm">php-fpm</a></span>
</li></ul>
<ul><li>Задайте <code>listen</code> в <code>/etc/php/php-fpm.conf</code> следующим образом:</li></ul>
<pre>;listen = 127.0.0.1:9000
listen = /run/php-fpm/php-fpm.sock
listen.owner = http
listen.group = http
</pre>
<ul><li>Добавьте следующие строки в <code>/etc/httpd/conf/httpd.conf</code>:</li></ul>
<pre>&lt;FilesMatch \.php$&gt;
    SetHandler "proxy:unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/"
&lt;/FilesMatch&gt;
&lt;IfModule dir_module&gt;
    DirectoryIndex index.php index.html
&lt;/IfModule&gt;
</pre>
<ul><li>Если у вас добавлен модуль php, уберите его, так как он больше не нужен:</li></ul>
<pre>#LoadModule php5_module modules/libphp5.so
</pre>
<ul><li>
<a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">Перезапустите</a> демон apache php-fpm:</li></ul>
<pre># systemctl restart httpd.service php-fpm.service
</pre>
<h4>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_php5_c_apache2-mpm-worker_.D0.B8_mod_fcgid"></span><span class="mw-headline" id="Использование_php5_c_apache2-mpm-worker_и_mod_fcgid">Использование php5 c apache2-mpm-worker и mod_fcgid</span>
</h4>
<ul><li>Раскомментируйте следующую строку в <code>/etc/conf.d/apache</code>:</li></ul>
<pre>HTTPD=/usr/sbin/httpd.worker
</pre>
<ul><li>Раскомментируйте следующую строку в <code>/etc/httpd/conf/httpd.conf</code>:</li></ul>
<pre>Include conf/extra/httpd-mpm.conf
</pre>
<ul><li>
<a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакеты <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mod_fcgid">mod_fcgid</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-cgi">php-cgi</a></span>, доступные в <a href="../ru/Official_repositories.html" title="Official repositories (Русский)">официальных репозиториях</a>.</li></ul>
<ul><li>Создайте файл <code>/etc/httpd/conf/extra/php5_fcgid.conf</code> со следующим содержимым:</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/extra/php5_fcgid.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Required modules: fcgid_module

&lt;IfModule fcgid_module&gt;
	AddHandler php-fcgid .php
	AddType application/x-httpd-php .php
	Action php-fcgid /fcgid-bin/php-fcgid-wrapper
	ScriptAlias /fcgid-bin/ /srv/http/fcgid-bin/
	SocketPath /var/run/httpd/fcgidsock
	SharememPath /var/run/httpd/fcgid_shm
        # If you don't allow bigger requests many applications may fail (such as WordPress login)
        FcgidMaxRequestLen 536870912
        PHP_Fix_Pathinfo_Enable 1
        # Path to php.ini – defaults to /etc/phpX/cgi
        DefaultInitEnv PHPRC=/etc/php/
        # Number of PHP childs that will be launched. Leave undefined to let PHP decide.
        #DefaultInitEnv PHP_FCGI_CHILDREN 3
        # Maximum requests before a process is stopped and a new one is launched
        #DefaultInitEnv PHP_FCGI_MAX_REQUESTS 5000
        &lt;Location /fcgid-bin/&gt;
		SetHandler fcgid-script
		Options +ExecCGI
	&lt;/Location&gt;
&lt;/IfModule&gt;
</pre>
<ul><li>Создайте каталог и символическую ссылку в нем на <i>php-cgi</i>:</li></ul>
<pre># mkdir /srv/http/fcgid-bin
# ln -s /usr/bin/php-cgi /srv/http/fcgid-bin/php-fcgid-wrapper
</pre>
<ul><li>Отредактируйте <code>/etc/httpd/conf/httpd.conf</code>:</li></ul>
<pre>#LoadModule php5_module modules/libphp5.so
LoadModule fcgid_module modules/mod_fcgid.so
Include conf/extra/php5_fcgid.conf
</pre>
<p>и <a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">перезапустите</a> службу <code>httpd.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Так же как и в Apache 2.4 вы можете использовать <a rel="nofollow" class="external text" href="http://httpd.apache.org/docs/2.4/mod/mod_proxy_fcgi.html">mod_proxy_fcgi</a> вместе с PHP-FPM. Пример конфигурации вы можете найти на странице <a rel="nofollow" class="external autonumber" href="http://wiki.apache.org/httpd/PHP-FPM">[1]</a>.</div>
<h4>
<span id="MySQL.2FMariaDB"></span><span class="mw-headline" id="MySQL/MariaDB">MySQL/MariaDB</span>
</h4>
<p>Следуйте инструкциям на странице <a href="../en/PHP.html#MySQL/MariaDB" title="PHP">PHP#MySQL/MariaDB</a>.
</p>
<p>После выполнения настройки, <a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Перезапустите">перезапустите</a> службу <code>mysqld</code>, чтобы изменения вступили в силу.
</p>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D0.B6.D1.83.D1.80.D0.BD.D0.B0.D0.BB.D0.B0_.D0.B8_.D1.82.D0.B5.D0.BA.D1.83.D1.89.D0.B5.D0.B3.D0.BE_.D1.81.D0.BE.D1.81.D1.82.D0.BE.D1.8F.D0.BD.D0.B8.D1.8F_Apache"></span><span class="mw-headline" id="Просмотр_журнала_и_текущего_состояния_Apache">Просмотр журнала и текущего состояния Apache</span>
</h3>
<p>Текущее состояние службы <code>httpd</code> вы можете вывести командой <code>systemctl status httpd</code>.
</p>
<p>Лог-файлы Apache вы найдете в каталоге <code>/var/log/httpd</code>.
</p>
<h3>
<span id="PID_file_.2Frun.2Fhttpd.2Fhttpd.pid_not_readable_.28yet.3F.29_after_start"></span><span class="mw-headline" id="PID_file_/run/httpd/httpd.pid_not_readable_(yet?)_after_start">PID file /run/httpd/httpd.pid not readable (yet?) after start</span>
</h3>
<p>Если вы получаете такую ошибку, закомментируйте строку:
</p>
<pre>LoadModule unique_id_module modules/mod_unique_id.so
</pre>
<p>в файле настроек Apache.
</p>
<h3>
<span id=".D0.9E.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81_Apache_2.2_.D0.B4.D0.BE_2.4"></span><span class="mw-headline" id="Обновление_с_Apache_2.2_до_2.4">Обновление с Apache 2.2 до 2.4</span>
</h3>
<p>Если вы используете <code>php-apache</code>, посмотрите инструкции к <a href="#PHP">Apache с PHP</a> выше.
</p>
<p>Управление доступом было изменено. Приведите все директивы <code>Order</code>, <code>Allow</code>, <code>Deny</code> и <code>Satisfy</code> к новому синтаксису с <code>Require</code>. <a rel="nofollow" class="external text" href="http://httpd.apache.org/docs/2.4/mod/mod_access_compat.html">mod_access_compat</a> позволит использовать устаревший формат на время этапа перехода.
</p>
<p>Подробную информацию вы найдете на странице <a rel="nofollow" class="external text" href="http://httpd.apache.org/docs/2.4/upgrading.html">Upgrading to 2.4 from 2.2</a>.
</p>
<h3>
<span id="Apache_is_running_a_threaded_MPM.2C_but_your_PHP_Module_is_not_compiled_to_be_threadsafe"></span><span class="mw-headline" id="Apache_is_running_a_threaded_MPM,_but_your_PHP_Module_is_not_compiled_to_be_threadsafe">Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe</span>
</h3>
<p>Если не удалось запустить <code>php5_module</code> при старте <code>httpd.service</code> и вы получаете следующее сообщение об ошибке:
</p>
<pre>Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.  You need to recompile PHP.
</pre>
<p>Это значит, что Apache работает c поточным MPM, но используется не потокобезопасная версия PHP. В этом случае, следует заменить <code>mpm_event_module</code> на <code>mpm_prefork_module</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/httpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># LoadModule mpm_event_module modules/mod_mpm_event.so
LoadModule mpm_prefork_module modules/mod_mpm_prefork.so
</pre>
<p>и перезапустить <code>httpd.service</code>.
</p>
<ul>
<li><a rel="nofollow" class="external text" href="http://www.apache.org/">Официальный сайт веб-сервера Apache</a></li>
<li><a rel="nofollow" class="external text" href="http://www.akadia.com/services/ssh_test_certificate.html">Руководство по созданию самозаверенных сертификатов</a></li>
<li><a rel="nofollow" class="external text" href="http://wiki.apache.org/httpd/CommonMisconfigurations">Поиск и устранение неисправностей при настройке Apache</a></li>
<li><a rel="nofollow" class="external text" href="https://mariadb.org/">Официальный сайт MariaDB</a></li>
<li><a rel="nofollow" class="external text" href="http://www.php.net/">Официальный сайт PHP</a></li>
</ul>

</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:Web_server.html" title="Category:Web server (Русский)">Web server (Русский)</a></li>
<li><a href="../ru/Category:Apache.html" title="Category:Apache (Русский)">Apache (Русский)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../ru/Category:Pages_or_sections_flagged_with_Template:Translateme.html" title="Category:Pages or sections flagged with Template:Translateme (Русский)">Pages or sections flagged with Template:Translateme (Русский)</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Apache_HTTP_Server_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=644962">https://wiki.archlinux.org/index.php?title=Apache_HTTP_Server_(Русский)&amp;oldid=644962</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 13 December 2020, at 10:09.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>

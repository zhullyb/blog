<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Advanced Linux Sound Architecture/Troubleshooting - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Advanced_Linux_Sound_Architecture_Troubleshooting rootpage-Advanced_Linux_Sound_Architecture skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Advanced Linux Sound Architecture/Troubleshooting</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="../../en/Advanced_Linux_Sound_Architecture.html" title="Advanced Linux Sound Architecture">Advanced Linux Sound Architecture</a></span></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Volume"><span class="tocnumber">1</span> <span class="toctext">Volume</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#No_output"><span class="tocnumber">1.1</span> <span class="toctext">No output</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Output_is_muted_after_reboot"><span class="tocnumber">1.2</span> <span class="toctext">Output is muted after reboot</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Volume_is_too_low"><span class="tocnumber">1.3</span> <span class="toctext">Volume is too low</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Low_Sound_Volume"><span class="tocnumber">1.4</span> <span class="toctext">Low Sound Volume</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Random_lack_of_sound_on_startup"><span class="tocnumber">1.5</span> <span class="toctext">Random lack of sound on startup</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Microphone"><span class="tocnumber">2</span> <span class="toctext">Microphone</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#No_microphone_input"><span class="tocnumber">2.1</span> <span class="toctext">No microphone input</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Setting_the_default_microphone/capture_device"><span class="tocnumber">2.2</span> <span class="toctext">Setting the default microphone/capture device</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Internal_microphone_not_working"><span class="tocnumber">2.3</span> <span class="toctext">Internal microphone not working</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Crackling_microphone"><span class="tocnumber">2.4</span> <span class="toctext">Crackling microphone</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Audio_Quality"><span class="tocnumber">3</span> <span class="toctext">Audio Quality</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Crackling_sound_through_mini-jack_(headphones_connector)"><span class="tocnumber">3.1</span> <span class="toctext">Crackling sound through mini-jack (headphones connector)</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Popping_sound_after_resuming_from_suspension"><span class="tocnumber">3.2</span> <span class="toctext">Popping sound after resuming from suspension</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Sound_skipping_during_playback"><span class="tocnumber">3.3</span> <span class="toctext">Sound skipping during playback</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Poor_sound_quality_or_clipping"><span class="tocnumber">3.4</span> <span class="toctext">Poor sound quality or clipping</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Pops_when_starting_and_stopping_playback"><span class="tocnumber">3.5</span> <span class="toctext">Pops when starting and stopping playback</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Sound_skipping_while_using_dynamic_CPU_frequency_scaling"><span class="tocnumber">3.6</span> <span class="toctext">Sound skipping while using dynamic CPU frequency scaling</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Hardware_and_Cards"><span class="tocnumber">4</span> <span class="toctext">Hardware and Cards</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Verifying_output_parameters"><span class="tocnumber">4.1</span> <span class="toctext">Verifying output parameters</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Error_'Unknown_hardware'_appears_after_kernel_update"><span class="tocnumber">4.2</span> <span class="toctext">Error 'Unknown hardware' appears after kernel update</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Fix_wrong_audio_pin_mapping"><span class="tocnumber">4.3</span> <span class="toctext">Fix wrong audio pin mapping</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#S/PDIF_output_does_not_work"><span class="tocnumber">4.4</span> <span class="toctext">S/PDIF output does not work</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Conflicting_PC_speaker"><span class="tocnumber">4.5</span> <span class="toctext">Conflicting PC speaker</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#HP_TX2500"><span class="tocnumber">4.6</span> <span class="toctext">HP TX2500</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#No_sound_when_S/PDIF_video_card_is_installed"><span class="tocnumber">4.7</span> <span class="toctext">No sound when S/PDIF video card is installed</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Wrong_sound_card_model_type"><span class="tocnumber">4.8</span> <span class="toctext">Wrong sound card model type</span></a></li>
<li class="toclevel-2 tocsection-28">
<a href="#Intel_onboard_sound"><span class="tocnumber">4.9</span> <span class="toctext">Intel onboard sound</span></a>
<ul>
<li class="toclevel-3 tocsection-29"><a href="#No_sound_with_onboard_Intel_sound_card"><span class="tocnumber">4.9.1</span> <span class="toctext">No sound with onboard Intel sound card</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#No_headphone_sound_with_onboard_intel_sound_card"><span class="tocnumber">4.9.2</span> <span class="toctext">No headphone sound with onboard intel sound card</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31">
<a href="#HDMI"><span class="tocnumber">4.10</span> <span class="toctext">HDMI</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#HDMI_Output_does_not_work"><span class="tocnumber">4.10.1</span> <span class="toctext">HDMI Output does not work</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#PCM_through_HDMI_does_not_work_(Intel_Gfx)"><span class="tocnumber">4.10.2</span> <span class="toctext">PCM through HDMI does not work (Intel Gfx)</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="#HDMI_5.1_sound_goes_to_wrong_speakers"><span class="tocnumber">4.10.3</span> <span class="toctext">HDMI 5.1 sound goes to wrong speakers</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-35">
<a href="#Applications"><span class="tocnumber">5</span> <span class="toctext">Applications</span></a>
<ul>
<li class="toclevel-2 tocsection-36"><a href="#SDL:_No_sound_with_SDL_applications"><span class="tocnumber">5.1</span> <span class="toctext">SDL: No sound with SDL applications</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#OpenAL:_No_sound_in_applications_that_use_OpenAL"><span class="tocnumber">5.2</span> <span class="toctext">OpenAL: No sound in applications that use OpenAL</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#VirtualBox:_Virtual_machine_has_no_sound"><span class="tocnumber">5.3</span> <span class="toctext">VirtualBox: Virtual machine has no sound</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Others:_Generic_application_problems"><span class="tocnumber">5.4</span> <span class="toctext">Others: Generic application problems</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-40">
<a href="#Other_Issues"><span class="tocnumber">6</span> <span class="toctext">Other Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-41"><a href="#Simultaneous_playback_problems"><span class="tocnumber">6.1</span> <span class="toctext">Simultaneous playback problems</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Removing_old_ALSA_state_file_(asound.state)"><span class="tocnumber">6.2</span> <span class="toctext">Removing old ALSA state file (asound.state)</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Problems_with_availability_to_only_one_user_at_a_time"><span class="tocnumber">6.3</span> <span class="toctext">Problems with availability to only one user at a time</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Crackling/popping_on_Dell_laptops"><span class="tocnumber">6.4</span> <span class="toctext">Crackling/popping on Dell laptops</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Volume">Volume</span></h2>
<h3><span class="mw-headline" id="No_output">No output</span></h3>
<p>If <code>speaker-test</code> produces sound but some other program does not, determine whether <a href="../../en/PulseAudio.html" title="PulseAudio">PulseAudio</a> is being used:
</p>
<pre># fuser -v /dev/snd/*
</pre>
<p>If it is, try using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/apulse/">apulse</a></span><sup><small>AUR</small></sup>, as described in <a href="../../en/Advanced_Linux_Sound_Architecture.html#PulseAudio_compatibility" title="Advanced Linux Sound Architecture">Advanced Linux Sound Architecture#PulseAudio compatibility</a>.  Alternatively, killing the PulseAudio process may cause sound to start working in the desired process.
</p>
<h3><span class="mw-headline" id="Output_is_muted_after_reboot">Output is muted after reboot</span></h3>
<p>Run the following command:
</p>
<pre># alsactl restore
</pre>
<p>If the problem persists, verify that the <code>Auto-Mute</code> option in <i>alsamixer</i> is set to <code>Disabled</code>.
</p>
<h3><span class="mw-headline" id="Volume_is_too_low">Volume is too low</span></h3>
<p>Run <i>alsamixer</i> and try to increase the value of the sliders, unmuting channels if necessary. Note that if you have many sliders, you may have to scroll to the right to see any missing sliders.
</p>
<p>If all the sliders are maxed out, and the volume is still too low, you can try running the following <a rel="nofollow" class="external text" href="http://www.alsa-project.org/hda-analyzer.py">script</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-28 ⓘ]</sup> to reset your codec settings:
</p>
<pre>$ wget <a rel="nofollow" class="external free" href="http://www.alsa-project.org/hda-analyzer.py">http://www.alsa-project.org/hda-analyzer.py</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-28 ⓘ]</sup>
$ su -c 'python2 hda-analyzer.py'
</pre>
<p>The script assumes that <code>/usr/bin/python</code> refers to Python 2, which is incorrect on Arch by default. To avoid this issue run the following command:
</p>
<pre>$ sed -i 's/python %s/python2 %s/' hda-analyzer.py
</pre>
<p>Close the analyzer, and when prompted as to whether you want to reset the codecs, say "yes".
</p>
<p>If the volume is still too low, run <i>alsamixer</i> again: resetting the codecs may have caused new sliders to become enabled and some of them may be set to a low value.
</p>
<h3><span class="mw-headline" id="Low_Sound_Volume">Low Sound Volume</span></h3>
<p>If you are facing low sound even after maxing out your speakers/headphones, you can give the softvol plugin a try. Add the following to <code>/etc/asound.conf</code>.
</p>
<pre>pcm.!default {
    type plug
    slave.pcm "softvol"
}

pcm.softvol {
    type softvol
    slave {
        pcm "dmix"
    }
    control {
        name "Pre-Amp"
        card 0
    }
    min_dB -5.0
    max_dB 20.0
    resolution 6
}</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You will probably have to restart the computer, as restarting the alsa daemon did not load the new configuration for me. Also, if the configuration does not work even after restarting, try changing <code>plug</code> with <code>hw</code> in the above configuration.</div>
<p>After the changes are loaded successfully, you will see a <code>Pre-Amp</code> section in alsamixer. You can adjust the levels there.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Setting a high value for <code>Pre-Amp</code> can cause sound distortion, so adjust it according to the level that suits you.</li>
<li>Some audio codecs may need to have settings adjusted in the HDA Analyzer (see <a href="#Volume_is_too_low">#Volume is too low</a>) in order to achieve proper volume without distortion. Checking the HP option under widget control in the Playback Switch (Node[0x14] PIN in the ALC892 codec, for instance) can sometimes improve audio quality and volume significantly.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Random_lack_of_sound_on_startup">Random lack of sound on startup</span></h3>
<p>You can quickly test sound by running <code>speaker-test</code>. If there is no sound, the error message might look something like
</p>
<pre> ALSA lib pcm_dmix.c:1022:(snd_pcm_dmix_open) unable to open slave
 Playback open error: -16
 Device or resource busy
</pre>
<p>If you have no sound on startup, this may be because your system has multiple sound cards, and their order may sometimes change on startup.  If this is the case, try <a href="../../en/Advanced_Linux_Sound_Architecture.html#Set_the_default_sound_card" class="mw-redirect" title="ALSA">setting the default sound card</a>.
</p>
<p>If you use mpd and the configuration tips above do not work for you, try <a rel="nofollow" class="external text" href="http://mpd.wikia.com/wiki/Configuration#ALSA_MPD_software_volume_control">reading this</a> instead.
</p>
<h2><span class="mw-headline" id="Microphone">Microphone</span></h2>
<h3><span class="mw-headline" id="No_microphone_input">No microphone input</span></h3>
<p>In alsamixer, make sure that all the volume levels are up under recording, and that CAPTURE is toggled active on the microphone (e.g. Mic, Internal Mic) and/or on Capture (in alsamixer, select these items and press space). Try making positive Mic Boost and raising Capture and Digital levels higher; this may make static or distortion, but then you can adjust them back down once you are hearing <i>something</i> when you record
</p>
<p>As the pulseaudio wrapper is shown as "default" in alsamixer, you may have to press F6 to select your actual soundcard first. You may also need to enable and increase the volume of Line-in in the Playback section.
</p>
<p>To test the microphone, run these commands (see arecord's man page for further information):
</p>
<pre>$ arecord --duration=5 --format=dat test-mic.wav
$ aplay test-mic.wav
</pre>
<p>Alternatively, you can run this command:
</p>
<pre>$ arecord -vv --format=dat /dev/null
</pre>
<p>alongside alsamixer to easily identify channel which you should select and unmute.
</p>
<p>To test a particular device, use the <code>--device</code> parameter followed by the hardware PCM name in the form <code>hw:<i>C</i>,<i>D</i></code> for card <i>C</i> device <i>D</i>, or <code>plughw:<i>C</i>,<i>D</i></code> for plugged hardware. For instance:
</p>
<pre>$ arecord -vvv --format=dat --device=plughw:0,0 /dev/null
</pre>
<p>If all fails, you may want to eliminate hardware failure by testing the microphone with a different device.
</p>
<p>For at least some computers, muting a microphone (MM) simply means its input does not go immediately to the speakers. It still receives input.
</p>
<p>Many Dell laptops need "-dmic" to be appended to the model name in <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-hda-intel model=dell-m6-dmic
</pre>
<p>Some programs use try to use OSS as the main input software. If you have enabled the <code>snd_pcm_oss</code>, <code>snd_mixer_oss</code> or <code>snd_seq_oss</code> <a href="../../en/Kernel_module.html" class="mw-redirect" title="Kernel modules">kernel modules</a> previously (they are not loaded by default), try unloading them.
</p>
<p>See also:
</p>
<ul>
<li><a rel="nofollow" class="external free" href="http://www.alsa-project.org/main/index.php/SoundcardTesting">http://www.alsa-project.org/main/index.php/SoundcardTesting</a></li>
<li><a rel="nofollow" class="external free" href="http://alsa.opensrc.org/Record_from_mic">http://alsa.opensrc.org/Record_from_mic</a></li>
</ul>
<h3>
<span id="Setting_the_default_microphone.2Fcapture_device"></span><span class="mw-headline" id="Setting_the_default_microphone/capture_device">Setting the default microphone/capture device</span>
</h3>
<p>Some applications (Pidgin, Adobe Flash) do not provide an option to change the capture device. It becomes a problem if your microphone is on a separate device (e.g. USB webcam or microphone) than your internal sound card. To change only the default capture device, leaving the default playback device as is, you can modify your <code>~/.asoundrc</code> file to include the following:
</p>
<pre>pcm.usb
{
    type hw
    card U0x46d0x81d
}

pcm.!default
{
    type asym
    playback.pcm
    {
        type plug
        slave.pcm "dmix"
    }
    capture.pcm
    {
        type plug
        slave.pcm "usb"
    }
}
</pre>
<p>Replace "U0x46d0x81d" with your capture device's card name in ALSA. You can use <code>arecord -L</code> to list all the capture devices detected by ALSA.
</p>
<h3><span class="mw-headline" id="Internal_microphone_not_working">Internal microphone not working</span></h3>
<p>First make sure the volume is enabled under the <code>Capture</code> view in <i>alsamixer</i>. In some case, the "Internal Microphone" is not displayed in the capture list available when pressing F4. If so, specifying the card number given by <code>aplay -l</code> to start <i>alsamixer</i> (for example <code>alsamixer -c 0</code> ) can make it appear. 
</p>
<p><br>
Then add the following to <code>/etc/modprobe.d/snd-hda-intel.conf</code>:
</p>
<pre>options snd-hda-intel enable_msi=1
</pre>
<p>Then reload the module:
</p>
<pre># rmmod snd-hda-intel &amp;&amp; modprobe snd-hda-intel
</pre>
<p>Now there should be an additional input under the previously mentioned <code>Capture</code> view.
</p>
<h3><span class="mw-headline" id="Crackling_microphone">Crackling microphone</span></h3>
<p>If you are getting a crackling or popping from your microphone that cannot be resolved with ALSA settings or cleaning your microphone jack, try adding the following line to <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-hda-intel model=MODEL position_fix=3
</pre>
<p>This option will fix crackling on pure ALSA, but will cause issues to pulseaudio. To let Pulse use these settings effectively, edit <code>/etc/pulse/default.pa</code> and find this line:
</p>
<pre>load-module module-udev-detect
</pre>
<p>And change it to this:
</p>
<pre>load-module module-udev-detect tsched=0
</pre>
<p>See the <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/sound/hd-audio/notes.html#dma-position-problem">DMA-Position Problem in the kernel docs</a>.
</p>
<h2><span class="mw-headline" id="Audio_Quality">Audio Quality</span></h2>
<h3>
<span id="Crackling_sound_through_mini-jack_.28headphones_connector.29"></span><span class="mw-headline" id="Crackling_sound_through_mini-jack_(headphones_connector)">Crackling sound through mini-jack (headphones connector)</span>
</h3>
<p>Whether you followed <a href="../../en/Advanced_Linux_Sound_Architecture.html#Simultaneous_output" title="Advanced Linux Sound Architecture">simultaneous output tip</a> or managed to get it done on your own, you might get crackling sound through headphones or external speakers. This can be fixed by muting <b>or</b> setting volume to 0% on item <b>Mic</b>. Use <code>alsamixer</code> or <code>amixer</code>:
</p>
<pre>$ amixer sset "Mic" 0%
$ amixer sset "Mic" mute
</pre>
<h3><span class="mw-headline" id="Popping_sound_after_resuming_from_suspension">Popping sound after resuming from suspension</span></h3>
<p>You might hear a popping sound after resuming the computer from suspension. This can be fixed by editing <code>/etc/pm/sleep.d/90alsa</code> and removing the line that says <code>aplay -d 1 /dev/zero</code>
</p>
<h3><span class="mw-headline" id="Sound_skipping_during_playback">Sound skipping during playback</span></h3>
<p>Run <i>alsamixer</i>, and if channels exist for nonexistent output devices then disable them (e.g. <i>alsamixer</i> showing a center speaker but you not having one).
</p>
<h3><span class="mw-headline" id="Poor_sound_quality_or_clipping">Poor sound quality or clipping</span></h3>
<p>If you experience poor sound quality, try setting the PCM volume (in alsamixer) to a level such that gain is 0.
</p>
<p>If snd-usb-audio driver has been loaded, you could try to enable <code>softvol</code> in <code>/etc/asound.conf</code> file. Example configuration for the first audio device:
</p>
<pre>pcm.!default {
    type plug
    slave.pcm "softvol"
}
pcm.dmixer {
    type dmix
    ipc_key 1024
    slave {
        pcm "hw:0"
        period_size 4096
        buffer_size 131072
        rate 50000
    }
    bindings {
        0 0
        1 1
    }
}
pcm.dsnooper {
    type dsnoop
    ipc_key 1024
    slave {
        pcm "hw:0"
        channels 2
        period_size 4096
        buffer_size 131072
        rate 50000
    }
    bindings {
        0 0
        1 1
        }
}
pcm.softvol {
  type softvol
  slave { pcm "dmixer" }
  control {
    name "Master"
    card 0
  }
}
ctl.!default {
  type hw
  card 0
}
ctl.softvol {
  type hw
  card 0
}
ctl.dmixer {
  type hw
  card 0
}</pre>
<h3><span class="mw-headline" id="Pops_when_starting_and_stopping_playback">Pops when starting and stopping playback</span></h3>
<p>Some modules (e.g. <code>snd_ac97_codec</code> and <code>snd_hda_intel</code>) can power off your sound card when it is not used. This can make an audible noise (like a crack/pop/scratch) when turning on/off your sound card. Sometimes even when moving the volume slider or opening and closing windows (KDE4). If you find this annoying, try <code>modinfo <i>your_module</i></code> and look for a module option that adjusts or disables this feature.
</p>
<p>For example, to disable the power saving mode for the <code>snd_hda_intel</code> module, add to <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd_hda_intel power_save=0
</pre>
<p>You may also need to disable power saving for the audio card controller:
</p>
<pre>options snd_hda_intel power_save=0 power_save_controller=N
</pre>
<p>Alternatively you can set parameters for <a href="../../en/Kernel_module.html" class="mw-redirect" title="Kernel modules">kernel modules</a> with <code>modprobe snd_hda_intel power_save=0</code> etc.
</p>
<p>You may also have to unmute the 'Line' ALSA channel for this to work. Any value will do (other than '0' or something too high). For example, on an onboard VIA VT1708S (using the <code>snd_hda_intel</code> module) these cracks occurred even when <code>power_save</code> was set to 0. Unmuting the 'Line' channel and setting a value of '1' solved the problem.
</p>
<p>Source: <a rel="nofollow" class="external free" href="https://www.kernel.org/doc/Documentation/sound/alsa/powersave.txt">https://www.kernel.org/doc/Documentation/sound/alsa/powersave.txt</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-28 ⓘ]</sup>
</p>
<h3><span class="mw-headline" id="Sound_skipping_while_using_dynamic_CPU_frequency_scaling">Sound skipping while using dynamic CPU frequency scaling</span></h3>
<p>Some combinations of ALSA drivers and chipsets may cause audio from all sources to skip when used in combination with a dynamic frequency scaling governor such as <code>ondemand</code> or <code>conservative</code>. Currently, the solution is to switch back to the <code>performance</code> governor.
</p>
<p>Refer to the <a href="../../en/CPU_frequency_scaling.html" title="CPU frequency scaling">CPU frequency scaling</a> for more information.
</p>
<h2><span class="mw-headline" id="Hardware_and_Cards">Hardware and Cards</span></h2>
<h3><span class="mw-headline" id="Verifying_output_parameters">Verifying output parameters</span></h3>
<p>Check the contents of <code>/proc/asound/cardX/pcmYp/subZ/hw_params</code>, where <code>X</code>, <code>Y</code>, and <code>Z</code> are system dependent.
In order to find this file, execute the following command while outputting anything via ALSA:
</p>
<pre>$ find /proc/asound/ -name hw_params | xargs -I FILE grep -v -l "closed" FILE | grep '/proc/asound/card./pcm.p/sub./hw_params'
</pre>
<p>If nothing is playing there should be no results.
</p>
<p>Here is an example output for audio with a <a href="https://en.wikipedia.org/wiki/Audio_bit_depth" class="extiw" title="wikipedia:Audio bit depth">bit depth</a> of 24 bits and a <a href="https://en.wikipedia.org/wiki/Sampling_frequency" class="extiw" title="wikipedia:Sampling frequency">sampling frequency</a> of 44.1 kilohertz:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">cat /proc/asound/card1/pcm0p/sub0/hw_params</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">access: RW_INTERLEAVED
format: S24_3LE
subformat: STD
channels: 2
rate: 44100 (44100/1)
period_size: 5513
buffer_size: 22050
</pre>
<p>More info is available in the <a rel="nofollow" class="external text" href="http://alsa.opensrc.org/Proc_asound_documentation">ALSA documentation</a>.
</p>
<h3>
<span id="Error_.27Unknown_hardware.27_appears_after_kernel_update"></span><span class="mw-headline" id="Error_'Unknown_hardware'_appears_after_kernel_update">Error 'Unknown hardware' appears after kernel update</span>
</h3>
<p>The following messages may be displayed during ALSA's initialization:
</p>
<pre>Unknown hardware "foo" "bar" ...
Hardware is initialized using a guess method
/usr/bin/alsactl: set_control:nnnn:failed to obtain info for control #mm (No such file or directory)
</pre>
<p>or:
</p>
<pre>Found hardware: "HDA-Intel" "VIA VT1705" "HDA:11064397,18490397,00100000" "0x1849" "0x0397"
Hardware is initialized using a generic method
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #1 (No such file or directory)
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #2 (No such file or directory)
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #25 (No such file or directory)
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #26 (No such file or directory)
</pre>
<p>Simply store ALSA mixer settings again:
</p>
<pre># alsactl -f /var/lib/alsa/asound.state store
</pre>
<p>It may be necessary configure ALSA again with alsamixer
</p>
<h3><span class="mw-headline" id="Fix_wrong_audio_pin_mapping">Fix wrong audio pin mapping</span></h3>
<p>If the mappings to your audio pins(plugs) do not correspond but ALSA works fine, you could try HDA Analyzer -- a pyGTK2 GUI for HD-audio control can be found <a rel="nofollow" class="external text" href="http://www.alsa-project.org/main/index.php/HDA_Analyzer">at the ALSA wiki</a>.
Try tweaking the Widget Control section of the PIN nodes, to make microphones IN and headphone jacks OUT. Referring to the Config Defaults heading is a good idea.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The script is incompatible with Python 3, which is the default Python implementation on Arch Linux. In order to use the script, replace all occurrences of <code>python</code> in the <code>run.py</code> file with <code>python2</code> to point the script to the Python 2 version. Then make the script <a href="../../en/File_permissions_and_attributes.html#Changing_permissions" class="mw-redirect" title="Chmod">executable</a> and run it.</div>
<h3>
<span id="S.2FPDIF_output_does_not_work"></span><span class="mw-headline" id="S/PDIF_output_does_not_work">S/PDIF output does not work</span>
</h3>
<p>If the optical/coaxial digital output of your motherboard/sound card is not working or stopped working, and have already enabled and unmuted it in alsamixer, try running the following:
</p>
<pre>$ iecset audio on
</pre>
<p>You can also put this command in an enabled <a href="../../en/Systemd.html" title="Systemd">systemd</a> service as it sometimes it may stop working after a reboot.
</p>
<h3><span class="mw-headline" id="Conflicting_PC_speaker">Conflicting PC speaker</span></h3>
<p>If you are sure nothing is muted, that your drivers are installed correctly, and that your volume is right, but you still do not hear anything, then try adding the following line to <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-NAME-OF-MODULE ac97_quirk=0
</pre>
<p>The above fix has been observed to work with <code>via82xx</code>
</p>
<pre>options snd-NAME-OF-MODULE ac97_quirk=1
</pre>
<p>The above fix has been reported to work with <code>snd-intel8x0</code>
</p>
<h3><span class="mw-headline" id="HP_TX2500">HP TX2500</span></h3>
<p>Add these 2 lines into <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-cmipci mpu_port=0x330 fm_port=0x388
options snd-hda-intel index=0 model=toshiba position_fix=1
options snd-hda-intel model=hp (works for tx2000cto)
</pre>
<h3>
<span id="No_sound_when_S.2FPDIF_video_card_is_installed"></span><span class="mw-headline" id="No_sound_when_S/PDIF_video_card_is_installed">No sound when S/PDIF video card is installed</span>
</h3>
<p>Discover available modules and their order:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ cat /proc/asound/modules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> 0 snd_hda_intel
 1 snd_ca0106
</pre>
<p>Disable the undesired video card audio codec in <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/modprobe.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">install snd_hda_intel /bin/false
</pre>
<p>If both devices use the same module then we can use the <code>enable</code> parameter from snd_hda_intel module; it is an array of booleans that can enable/disable the desired sound card.
</p>
<pre>options snd_hda_intel enable=1,0
</pre>
<h3><span class="mw-headline" id="Wrong_sound_card_model_type">Wrong sound card model type</span></h3>
<p>Although ALSA detects your soundcard through the BIOS, at times ALSA may not be able to recognize your <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/sound/hd-audio/models.html">model type</a>.  The soundcard chip can be found in <code>alsamixer</code> (e.g. ALC662) and the model can be set in <code>/etc/modprobe.d/modprobe.conf</code> or <code>/etc/modprobe.d/sound.conf</code>.  For example:
</p>
<pre>options snd-hda-intel model=MODEL
</pre>
<p>There are other model settings too.  For most cases ALSA defaults will do.  If you want to look at more specific settings for your soundcard take a look at the <a rel="nofollow" class="external text" href="http://bugtrack.alsa-project.org/main/index.php/Matrix:Main">ALSA Soundcard List</a> find your model, then Details, then look at the "Setting up modprobe..." section.  Enter these values in <code>/etc/modprobe.d/modprobe.conf</code>.  For example, for an Intel AC97 audio:
</p>
<pre># ALSA portion
alias char-major-116 snd
alias snd-card-0 snd-intel8x0
# module options should go here

# OSS/Free portion
alias char-major-14 soundcore
alias sound-slot-0 snd-card-0

# card #1
alias sound-service-0-0 snd-mixer-oss
alias sound-service-0-1 snd-seq-oss
alias sound-service-0-3 snd-pcm-oss
alias sound-service-0-8 snd-seq-oss
alias sound-service-0-12 snd-pcm-oss
</pre>
<h3><span class="mw-headline" id="Intel_onboard_sound">Intel onboard sound</span></h3>
<h4><span class="mw-headline" id="No_sound_with_onboard_Intel_sound_card">No sound with onboard Intel sound card</span></h4>
<p>There may be a problem with two conflicting modules loaded, namely <code>snd-intel8x0</code> and <code>snd-intel8x0m</code>. In this case, blacklist <code>snd-intel8x0m</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/modprobe.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">blacklist snd-intel8x0m</pre>
<p><i>Muting</i> the "External Amplifier" in <code>alsamixer</code> or <code>amixer</code> may also help. See <a rel="nofollow" class="external text" href="http://alsa.opensrc.org/Intel8x0#Dell_Inspiron_8600_.28and_probably_others.29">the ALSA wiki</a>.
</p>
<p>Unmuting the "Mix" setting in the mixer might help, also.
</p>
<h4><span class="mw-headline" id="No_headphone_sound_with_onboard_intel_sound_card">No headphone sound with onboard intel sound card</span></h4>
<p>With <b>Intel Corporation 82801 I (ICH9 Family) HD Audio Controller</b> on laptop, you may need to add this line to modprobe or sound.conf:
</p>
<pre>options snd-hda-intel model=<i>model</i>
</pre>
<p>Where <i>model</i> is any one of the following:
</p>
<ul>
<li>dell-m6</li>
<li>dell-vostro</li>
<li>generic</li>
<li>laptop</li>
<li>laptop-hpsense</li>
<li>olpc-xo-1_5</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It may be necessary to put this "options" line below (after) any "alias" lines about your card.</div>
<p>You can see all the available models in the kernel documentation. For example <a rel="nofollow" class="external free" href="https://www.kernel.org/doc/html/latest/sound/hd-audio/models.html">https://www.kernel.org/doc/html/latest/sound/hd-audio/models.html</a>, but check that it is the correct version of that document for your kernel version.
</p>
<p>A list of available models is also available <a rel="nofollow" class="external text" href="http://www.mjmwired.net/kernel/Documentation/sound/alsa/HD-Audio-Models.txt">here</a>. To know your chip name type the following command (with * being corrected to match your files). Note that some chips could have been renamed and do not directly match the available ones in the file.
</p>
<pre>$ grep Codec /proc/asound/card*/codec*
</pre>
<p>Note that there is a high chance none of the input devices (all internal and external mics) will work if you choose to do this, so it is either your headphones or your mic. Please report to ALSA if you are affected by this bug.
</p>
<p>And also, if you have problems getting beeps to work (pcspkr):
</p>
<pre>options snd-hda-intel model=$model enable=1 index=0
</pre>
<h3><span class="mw-headline" id="HDMI">HDMI</span></h3>
<h4><span class="mw-headline" id="HDMI_Output_does_not_work">HDMI Output does not work</span></h4>
<p>The procedure described below can be used to test HDMI audio. Before proceeding, make sure you have enabled and unmuted the output with <code>alsamixer</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you are using an AMD card a necessary kernel module is disabled by default. See <a href="../../en/ATI.html#HDMI_audio" title="ATI">ATI#HDMI audio</a>.</div>
<p>Connect your PC to the Display via HDMI cable and enable the display with <a href="../../en/Xrandr.html" title="Xrandr">xrandr</a>.
</p>
<p>Use <code>aplay -l</code> to discover the card and device number. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ aplay -l</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">**** List of PLAYBACK Hardware Devices ****
card 0: SB [HDA ATI SB], device 0: ALC892 Analog [ALC892 Analog]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: SB [HDA ATI SB], device 1: ALC892 Digital [ALC892 Digital]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
<b>card 1</b>: Generic [HD-Audio Generic], <b>device 3</b>: HDMI 0 [HDMI 0]
  Subdevices: 1/1
  Subdevice #0: subdevice #0</pre>
<p>Send sound to the device. Following the example in the previous step, you would send sound to <code><b>card 1</b></code>, <code><b>device 3</b></code>:
</p>
<pre>$ aplay -D plughw:1,3 /usr/share/sounds/alsa/Front_Center.wav
</pre>
<p>If aplay does not output any errors, but still no sound is heard, "reboot" the receiver, monitor or tv set. Since the HDMI interface executes a handshake on connection, it might have noticed before that there was no audio stream embedded, and disabled audio decoding. If you are using a standalone window manager, you may need to have sound playing while plugging in the HDMI cable.
</p>
<p>mplay and other application could be configured to use special HDMI device as audio output. But flashplugin could only use default device. The following method is used to override default device. But you need to change it back when your TV is disconnected from HDMI port.
</p>
<p>If the test is successful, create or edit your <code>~/.asoundrc</code> file to set HDMI as the default audio device.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pcm.!default {
    type hw
    card 1
    device 3
}
</pre>
<p>Or if the above configuration does not work try:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">defaults.pcm.card 1
defaults.pcm.device 3
defaults.ctl.card 1
</pre>
<p>Or if you alternatively succeed with
</p>
<pre>$ speaker-test -Dplug:hdmi
</pre>
<p>for your HDMI or DisplayPort port the following configuration will work (successfully tested on Lenovo ThinkPad T430s):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pcm.!default {
    type plug
    slave.pcm "hdmi"
}
</pre>
<h4>
<span id="PCM_through_HDMI_does_not_work_.28Intel_Gfx.29"></span><span class="mw-headline" id="PCM_through_HDMI_does_not_work_(Intel_Gfx)">PCM through HDMI does not work (Intel Gfx)</span>
</h4>
<p>As of Linux 3.1 multi-channel PCM output through HDMI with a Intel card (Intel Eaglelake, IbexPeak/Ironlake,SandyBridge/CougarPoint and IvyBridge/PantherPoint) is not yet supported. Support for it has been recently added and expected to be available in Linux 3.2. To make it work in Linux 3.1 you need to apply the following patches:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=patch;h=76adaa34db407f174dd06370cb60f6029c33b465">drm: support routines for HDMI/DP ELD</a></li>
<li><a rel="nofollow" class="external text" href="https://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=patch;h=e0dac65ed45e72fe34cc7ccc76de0ba220bd38bb">drm/i915: pass ELD to HDMI/DP audio driver</a></li>
</ul>
<h4><span class="mw-headline" id="HDMI_5.1_sound_goes_to_wrong_speakers">HDMI 5.1 sound goes to wrong speakers</span></h4>
<p>Sound can be redirected to the intended speakers using ALSA's <code>remap</code> function. To do so, add the following to <code>/etc/asound.conf</code>:
</p>
<pre>pcm.!hdmi-remap {
    type asym
    playback.pcm {
        type plug
        slave.pcm "remap-surround51"
    }
}

pcm.!remap-surround51 {
    type route
    slave.pcm "hw:0,3"
    ttable {
        0.0= 1
        1.1= 1
        2.4= 1
        3.5= 1
        4.2= 1
        5.3= 1
    }
}</pre>
<h2><span class="mw-headline" id="Applications">Applications</span></h2>
<h3><span class="mw-headline" id="SDL:_No_sound_with_SDL_applications">SDL: No sound with SDL applications</span></h3>
<p>If you get no sound using SDL based applications, try setting the <a href="../../en/Environment_variables.html" class="mw-redirect" title="Environment variable">environment variable</a> <code>SDL_AUDIODRIVER</code> to <code>alsa</code>.
</p>
<h3><span class="mw-headline" id="OpenAL:_No_sound_in_applications_that_use_OpenAL">OpenAL: No sound in applications that use OpenAL</span></h3>
<p>Openal defaults to pulseaudio, to change the order, add the following configuration to <code>/etc/openal/alsoft.conf</code>:
</p>
<pre>drivers=alsa,pulse</pre>
<h3><span class="mw-headline" id="VirtualBox:_Virtual_machine_has_no_sound">VirtualBox: Virtual machine has no sound</span></h3>
<p>If you experience problems with VirtualBox, the following command might be helpful:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ alsactl init</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Found hardware: "ICH" "SigmaTel STAC9700,83,84" "AC97a:83847600" "0x8086" "0x0000"
Hardware is initialized using a generic method</pre>
<p>You might need to activate the ALSA output in your audio software as well. You might also try selecting different sound devices in your virtual machine settings to find one that works.
</p>
<h3><span class="mw-headline" id="Others:_Generic_application_problems">Others: Generic application problems</span></h3>
<p>For other applications who insist on their own audio setup, e.g., XMMS or MPlayer, you would need to set their specific options.
</p>
<p>For <a href="../../en/MPlayer.html" title="MPlayer">MPlayer</a> or <a href="../../en/Mpv.html" title="Mpv">mpv</a>, add the following line to the respective configuration file:
</p>
<pre>ao=alsa
</pre>
<p>Eg. for XMMS2, go into their options and make sure the sound driver is set to ALSA, not oss.
</p>
<p>To do this in XMMS:
</p>
<ul><li>Open XMMS
<ul>
<li>Options &gt; Preferences.</li>
<li>Choose the ALSA output plugin.</li>
</ul>
</li></ul>
<p>For applications which do not provide a ALSA output, you can use aoss from the alsa-oss package. To use aoss, when you run the program, prefix it with <code>aoss</code>, e.g.:
</p>
<pre>aoss realplay
</pre>
<p>pcm.!default{ ... }  doesnt work for me anymore. but this does:
</p>
<pre>pcm.default pcm.dmixer
</pre>
<h2><span class="mw-headline" id="Other_Issues">Other Issues</span></h2>
<h3><span class="mw-headline" id="Simultaneous_playback_problems">Simultaneous playback problems</span></h3>
<p>If you are having problems with simultaneous playback, and if <a href="../../en/PulseAudio.html" title="PulseAudio">PulseAudio</a> is installed, its default configuration is set to "hijack" the soundcard. Some users of ALSA may not want to use <a href="../../en/PulseAudio.html" title="PulseAudio">PulseAudio</a> and are quite content with their current ALSA settings. One fix is to edit <code>/etc/asound.conf</code> and comment out the following lines:
</p>
<pre># Use PulseAudio by default
pcm.!default {
    type pulse
    fallback "sysdefault"
    hint {
        show on
        description "Default ALSA Output (currently PulseAudio Sound Server)"
    }
}</pre>
<p>Commenting the following out also may help:
</p>
<pre>ctl.!default {
    type pulse
    fallback "sysdefault"
}</pre>
<p>This may be a much simpler solution than completely uninstalling <a href="../../en/PulseAudio.html" title="PulseAudio">PulseAudio</a>.
</p>
<p>Effectively, here is an example of a working <code>/etc/asound.conf</code>:
</p>
<pre>pcm.dmixer {
    type dmix
    ipc_key 1024
    ipc_key_add_uid 0
    ipc_perm 0660
}
pcm.dsp {
    type plug
    slave.pcm "dmix"
}</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This <code>/etc/asound.conf</code> file was intended for and used successfully with a global <a href="../../en/Music_Player_Daemon.html" class="mw-redirect" title="MPD">MPD</a> configuration. See <a href="#Problems_with_availability_to_only_one_user_at_a_time">#Problems with availability to only one user at a time</a>.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Alternatively, if you do <b>not</b> have PulseAudio installed, and just want to get <code>dmix</code> to work with vanilla ALSA, see the <a rel="nofollow" class="external text" href="http://www.alsa-project.org/main/index.php/Asoundrc#dmix">upstream documentation</a>. In particular, you probably want to replace <code>dsp</code> in the above config with <code>!default</code>. Also, if you notice this causes certain applications to skip while playing (i.e. sound "glitchy"), and complain about underrun occurring, you may want to tweak the <code>slave.buffer_size</code> inside <code>pcm.dmixer</code>.</div>
<h3>
<span id="Removing_old_ALSA_state_file_.28asound.state.29"></span><span class="mw-headline" id="Removing_old_ALSA_state_file_(asound.state)">Removing old ALSA state file (asound.state)</span>
</h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=alsa-utils">alsa-utils</a></span> package provides <code>alsa-store.service</code> which automatically stores the current ALSA state to <code>/var/lib/alsa/asound.state</code> upon system shutdown.  This can be problematic for users who are trying to reset their current ALSA state as the <code>asound.state</code> file will be recreated with the current state upon every shutdown (e.g., attempting to remove user-defined channels from the mixer).  The <code>alsa-store.service</code> service may be temporarily disabled by creating the following empty file:
</p>
<pre># mkdir -p /etc/alsa
# touch /etc/alsa/state-daemon.conf
</pre>
<p>The presence of <code>state-daemon.conf</code> prevents <code>alsa-store.service</code> from saving <code>asound.state</code> during shutdown. After disabling this service, the <code>asound.state</code> file may be removed as such:
</p>
<pre># rm /var/lib/alsa/asound.state
</pre>
<p>After rebooting, the previous ALSA state should be lost and the current state should be reset to defaults.  Re-enable <code>alsa-store.service</code> by deleting the condition file we created:
</p>
<pre># rm /etc/alsa/state-daemon.conf
</pre>
<p>On the next shutdown, the <code>asound.state</code> file should be recreated with ALSA defaults.  The file may also be generated immediately using:
</p>
<pre># alsactl store
</pre>
<p>If you want to clean ALSA state without rebooting, you can use <code>rmmod</code> to remove the sound driver module, then manually delete the unwanted entries in <code>asound.state</code>, and then use <code>modprobe</code> to reinstall the sound driver module.
</p>
<h3><span class="mw-headline" id="Problems_with_availability_to_only_one_user_at_a_time">Problems with availability to only one user at a time</span></h3>
<p>You might find that only one user can use the dmixer at a time.  This is probably ok for most, but for those who run <a href="../../en/Music_Player_Daemon.html" class="mw-redirect" title="Mpd">mpd</a> as a separate user this poses a problem.  When mpd is playing a normal user cannot play sounds though the dmixer.  While it is quite possible to just run mpd under a user's login account, another solution has been found.  Adding the line <code>ipc_key_add_uid 0</code> to the <code>pcm.dmixer</code> block disables this locking.  The following is a snippet from <code>asound.conf</code>, the rest is the same as above.
</p>
<pre>...
pcm.dmixer {
    type dmix
    ipc_key 1024
    ipc_key_add_uid 0
    ipc_perm 0660
slave {
 ...</pre>
<h3>
<span id="Crackling.2Fpopping_on_Dell_laptops"></span><span class="mw-headline" id="Crackling/popping_on_Dell_laptops">Crackling/popping on Dell laptops</span>
</h3>
<p>Check if you have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/i8kutils/">i8kutils</a></span><sup><small>AUR</small></sup> installed and if anything (e.g. <code>i8kmon.service</code>) is reading or writing to the interface exposed by the module, as i8kutils BIOS system calls block the kernel for a moment on some systems. See warning in <a href="../../en/Fan_speed_control.html#Dell_laptops" title="Fan speed control">Fan speed control#Dell laptops</a> for more details.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:Sound.html" title="Category:Sound">Sound</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Advanced_Linux_Sound_Architecture/Troubleshooting&amp;oldid=635157">https://wiki.archlinux.org/index.php?title=Advanced_Linux_Sound_Architecture/Troubleshooting&amp;oldid=635157</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 13 September 2020, at 13:41.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>

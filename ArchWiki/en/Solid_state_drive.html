<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Solid state drive - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Solid_state_drive rootpage-Solid_state_drive skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Solid state drive</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Solid_state_drive/NVMe.html" title="Solid state drive/NVMe">Solid state drive/NVMe</a></li>
<li><a href="../en/Solid_state_drive/Memory_cell_clearing.html" title="Solid state drive/Memory cell clearing">Solid state drive/Memory cell clearing</a></li>
<li><a href="../en/Benchmarking.html" class="mw-redirect" title="Benchmarking/Data storage devices">Benchmarking/Data storage devices</a></li>
<li><a href="../en/Improving_performance.html#Storage_devices" title="Improving performance">Improving performance#Storage devices</a></li>
<li><a href="../en/Flashcache.html" title="Flashcache">Flashcache</a></li>
</ul>
</div>
<p>This article covers special topics for operating <a href="https://en.wikipedia.org/wiki/Solid-state_drive" class="extiw" title="wikipedia:Solid-state drive">solid state drives</a> (SSDs) and other flash-memory based storage devices. If you want to partition an SSD for a specific purpose, it may be useful to consider the <a href="https://en.wikipedia.org/wiki/List_of_file_systems#File_systems_optimized_for_flash_memory.2C_solid_state_media" class="extiw" title="wikipedia:List of file systems">List of file systems optimized for flash memory</a>. For general usage, you should simply choose your preferred <a href="../en/File_systems.html" class="mw-redirect" title="Filesystem">filesystem</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Usage"><span class="tocnumber">1</span> <span class="toctext">Usage</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#TRIM"><span class="tocnumber">1.1</span> <span class="toctext">TRIM</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Periodic_TRIM"><span class="tocnumber">1.1.1</span> <span class="toctext">Periodic TRIM</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Continuous_TRIM"><span class="tocnumber">1.1.2</span> <span class="toctext">Continuous TRIM</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Trim_an_entire_device"><span class="tocnumber">1.1.3</span> <span class="toctext">Trim an entire device</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#LVM"><span class="tocnumber">1.1.4</span> <span class="toctext">LVM</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#dm-crypt"><span class="tocnumber">1.1.5</span> <span class="toctext">dm-crypt</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8">
<a href="#Maximizing_performance"><span class="tocnumber">1.2</span> <span class="toctext">Maximizing performance</span></a>
<ul>
<li class="toclevel-3 tocsection-9">
<a href="#Native_sector_size"><span class="tocnumber">1.2.1</span> <span class="toctext">Native sector size</span></a>
<ul>
<li class="toclevel-4 tocsection-10"><a href="#NVMe"><span class="tocnumber">1.2.1.1</span> <span class="toctext">NVMe</span></a></li>
<li class="toclevel-4 tocsection-11"><a href="#SATA"><span class="tocnumber">1.2.1.2</span> <span class="toctext">SATA</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-12">
<a href="#Security"><span class="tocnumber">1.3</span> <span class="toctext">Security</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Hdparm_shows_%22frozen%22_state"><span class="tocnumber">1.3.1</span> <span class="toctext">Hdparm shows "frozen" state</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#SSD_memory_cell_clearing"><span class="tocnumber">1.3.2</span> <span class="toctext">SSD memory cell clearing</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Hardware_encryption"><span class="tocnumber">1.3.3</span> <span class="toctext">Hardware encryption</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-16">
<a href="#Troubleshooting"><span class="tocnumber">2</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#Resolving_NCQ_errors"><span class="tocnumber">2.1</span> <span class="toctext">Resolving NCQ errors</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Resolving_SATA_power_management_related_errors"><span class="tocnumber">2.2</span> <span class="toctext">Resolving SATA power management related errors</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#External_SSD_with_TRIM_support"><span class="tocnumber">2.3</span> <span class="toctext">External SSD with TRIM support</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20">
<a href="#Firmware"><span class="tocnumber">3</span> <span class="toctext">Firmware</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#ADATA"><span class="tocnumber">3.1</span> <span class="toctext">ADATA</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Crucial"><span class="tocnumber">3.2</span> <span class="toctext">Crucial</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Intel"><span class="tocnumber">3.3</span> <span class="toctext">Intel</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Kingston"><span class="tocnumber">3.4</span> <span class="toctext">Kingston</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Mushkin"><span class="tocnumber">3.5</span> <span class="toctext">Mushkin</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#OCZ"><span class="tocnumber">3.6</span> <span class="toctext">OCZ</span></a></li>
<li class="toclevel-2 tocsection-27">
<a href="#Samsung"><span class="tocnumber">3.7</span> <span class="toctext">Samsung</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#Upgrade_under_Linux"><span class="tocnumber">3.7.1</span> <span class="toctext">Upgrade under Linux</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#SanDisk"><span class="tocnumber">3.8</span> <span class="toctext">SanDisk</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<h3><span class="mw-headline" id="TRIM">TRIM</span></h3>
<p>Most SSDs support the <a href="https://en.wikipedia.org/wiki/ATA_TRIM" class="extiw" title="wikipedia:ATA TRIM">ATA_TRIM command</a> for sustained long-term performance and wear-leveling. A <a rel="nofollow" class="external text" href="https://www.techspot.com/review/737-ocz-vector-150-ssd/page9.html">TechSpot article</a> shows performance benchmark examples of before and after filling an SSD with data.
</p>
<p>As of Linux kernel version 3.8 onwards, support for TRIM was continually added for the different <a href="../en/File_systems.html" class="mw-redirect" title="Filesystems">filesystems</a>. See the following table for an indicative overview:
</p>
<table class="wikitable sortable">
<tbody>
<tr>
<th>File system</th>
<th>Continuous TRIM <br> (<code>discard</code> option)</th>
<th>Periodic TRIM <br> (<i>fstrim</i>)</th>
<th>References<br> and notes
</th>
</tr>
<tr>
<td><a href="../en/Btrfs.html" title="Btrfs">Btrfs</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/Ext3.html" title="Ext3">Ext3</a></td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">?</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/Ext4.html" title="Ext4">Ext4</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
<a rel="nofollow" class="external autonumber" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/filesystems/ext4.txt?id=5012284700775a4e6e3fbe7eac4c543c4874b559#n342">[1]</a>
</td>
</tr>
<tr>
<td><a href="../en/F2FS.html" title="F2FS">F2FS</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/JFS.html" title="JFS">JFS</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
<a rel="nofollow" class="external autonumber" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=MTE5ODY">[2]</a>
</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/NILFS" class="extiw" title="wikipedia:NILFS">NILFS2</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/NTFS-3G.html" title="NTFS-3G">NTFS-3G</a></td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>since version 2015.3.14, <a rel="nofollow" class="external autonumber" href="http://permalink.gmane.org/gmane.comp.file-systems.ntfs-3g.devel/1101">[3]</a>
</td>
</tr>
<tr>
<td><a href="../en/FAT.html" class="mw-redirect" title="VFAT">VFAT</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
<i>fstrim</i> is supported since kernel 4.19
</td>
</tr>
<tr>
<td><a href="../en/XFS.html" title="XFS">XFS</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
<a rel="nofollow" class="external autonumber" href="http://xfs.org/index.php/FITRIM/discard">[4]</a>
</td>
</tr>
</tbody>
</table>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Users need to be certain that their SSD supports TRIM before attempting to use it. Data loss can occur otherwise!</div>
<p>To verify TRIM support, run:
</p>
<pre>$ lsblk --discard
</pre>
<p>And check the values of DISC-GRAN (discard granularity) and DISC-MAX (discard max bytes) columns. Non-zero values indicate TRIM support.
</p>
<p>Alternatively, <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=hdparm">hdparm</a></span> package and run:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># hdparm -I /dev/sda | grep TRIM</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">        *    Data Set Management TRIM supported (limit 1 block)
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> There are different types of TRIM support defined by the specification. Hence, the output may differ depending what the drive supports. See <a href="https://en.wikipedia.org/wiki/TRIM#ATA" class="extiw" title="wikipedia:TRIM">Wikipedia:TRIM#ATA</a> for more information.</div>
<h4><span class="mw-headline" id="Periodic_TRIM">Periodic TRIM</span></h4>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=util-linux">util-linux</a></span> package provides <code>fstrim.service</code> and <code>fstrim.timer</code> <a href="../en/Systemd.html" title="Systemd">systemd</a> unit files. <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Enabling">Enabling</a> the timer will activate the service weekly. The service executes <span class="plainlinks archwiki-template-man" title="$ man 8 fstrim"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/fstrim.8">fstrim(8)</a></span> on all mounted filesystems on devices that support the <i>discard</i> operation.
</p>
<p>The timer relies on the timestamp of <code>/var/lib/systemd/timers/stamp-fstrim.timer</code> (which it will create upon first invocation) to know whether a week has elapsed since it last ran. Therefore there is no need to worry about too frequent invocations, in an <i>anacron</i>-like fashion.
</p>
<p>To query the units activity and status, see <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journalctl">journalctl</a>. To change the periodicity of the timer or the command run, <a href="../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">edit</a> the provided unit files.
</p>
<h4><span class="mw-headline" id="Continuous_TRIM">Continuous TRIM</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> There is no need to enable continuous TRIM if you run <code>fstrim</code> periodically. If you want to use TRIM, use either periodic TRIM or continuous TRIM.</div>
<p>Instead of issuing TRIM commands once in a while (by default once a week if using <code>fstrim.timer</code>), it is also possible to issue TRIM commands each time files are deleted instead. The latter is known as the continuous TRIM.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Before <a href="https://en.wikipedia.org/wiki/Serial_ATA#SATA_revision_3.1" class="extiw" title="wikipedia:Serial ATA">SATA 3.1</a> all TRIM commands were non-queued, so continuous trimming would produce frequent system freezes. In this case, applying <a href="#Periodic_TRIM">#Periodic TRIM</a> less often is better alternative. Similar issue holds also for a number of devices, see <code>ata_device_blacklist</code> in <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/ata/libata-core.c">Linux source code</a>, for which queued TRIM command execution was blacklisted due to serious data corruption. In such case, depending on the device, the system may be forced to send non-queued TRIM commands the SSD instead of queued TRIM. See <a href="https://en.wikipedia.org/wiki/Trim_(computing)#Disadvantages" class="extiw" title="wikipedia:Trim (computing)">Wikipedia:Trim_(computing)#Disadvantages</a> for details.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Continuous TRIM is not the most preferred way to issue TRIM commands among the Linux community. For example, Ubuntu enables periodic TRIM by default <a rel="nofollow" class="external autonumber" href="https://askubuntu.com/questions/1034169/is-trim-enabled-on-my-ubuntu-18-04-installation">[5]</a>, Debian does not recommend using continuous TRIM <a rel="nofollow" class="external autonumber" href="https://wiki.debian.org/SSDOptimization#Mounting_SSD_filesystems">[6]</a> and Red Hat recommends using periodic TRIM over using continuous TRIM if feasible. <a rel="nofollow" class="external autonumber" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Storage_Administration_Guide/ch02s04.html">[7]</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-04-03 ⓘ]</sup>
</div>
<p>Using the <code>discard</code> option for a mount in <code>/etc/fstab</code> enables continuous TRIM in device operations:
</p>
<pre>/dev/sda1  /           ext4  defaults,<b>discard</b>   0  1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Specifying the discard mount option in <code>/etc/fstab</code> does not work with an XFS <code>/</code> partition. According to <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=143254">this thread</a>, it has to be set using the <code>rootflags=discard</code> <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>.</div>
<p>On the ext4 filesystem, the <code>discard</code> flag can also be set as a <a href="../en/Access_Control_Lists.html#Enable_ACL" title="Access Control Lists">default mount option</a> using <i>tune2fs</i>:
</p>
<pre># tune2fs -o discard /dev/sd<b>XY</b>
</pre>
<p>Using the default mount options instead of an entry in <code>/etc/fstab</code> is particularly useful for external drives, because such partition will be mounted with the default options also on other machines. This way, there is no need to edit <code>/etc/fstab</code> on every machine.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The default mount options are not listed in <code>/proc/mounts</code>.</div>
<h4><span class="mw-headline" id="Trim_an_entire_device">Trim an entire device</span></h4>
<p>If you want to trim your entire SSD at once, e.g. for a new install, or you want to sell your SSD, you can use the blkdiscard command, which will instantly discard all blocks on a device. 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> all data on the device will be lost!</div>
<pre># blkdiscard /dev/sd<i>X</i>
</pre>
<h4><span class="mw-headline" id="LVM">LVM</span></h4>
<p>TRIM requests that get passed from the file system to the logical volume are automatically passed to the physical volume(s). No additional configuration is necessary.
</p>
<p>No <a href="../en/LVM.html" title="LVM">LVM</a> operations (<i>lvremove</i>, <i>lvreduce</i> and all others) issue TRIM requests to physical volume(s) by default. This is done to allow restoring previous volume group configuration with <span class="plainlinks archwiki-template-man" title="$ man 8 vgcfgrestore"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/vgcfgrestore.8">vgcfgrestore(8)</a></span>. The setting <code>issue_discards</code> in <code>/etc/lvm/lvm.conf</code> controls whether discards are sent to a logical volume's underlying physical volumes when the logical volume is no longer using the physical volumes' space.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Carefully read the comment in <code>/etc/lvm/lvm.conf</code> before changing the <code>issue_discards</code> setting. It does not in any way affect TRIM requests that get passed from the file system to the disk (e.g. file deletions inside a file system) nor does it affect space management within a thin pool.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Enabling <code>issue_discards</code> will prevent volume group metadata restoration with <i>vgcfgrestore</i>. There will be no recovery options in case of a mistakenly issued LVM command.</div>
<h4><span class="mw-headline" id="dm-crypt">dm-crypt</span></h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The discard option allows discard requests to be passed through the encrypted block device. This may or may not <a rel="nofollow" class="external autonumber" href="https://www.spinics.net/lists/raid/msg40916.html">[8]</a> <a rel="nofollow" class="external autonumber" href="https://wiki.debian.org/SSDOptimization#Mounting_SSD_filesystems">[9]</a> improve performance on SSD storage but has security implications. See <a href="../en/Dm-crypt/Specialties.html#Discard/TRIM_support_for_solid_state_drives_(SSD)" title="Dm-crypt/Specialties">dm-crypt/Specialties#Discard/TRIM support for solid state drives (SSD)</a> for more information.</div>
<p>For non-root filesystems, configure <code>/etc/crypttab</code> to include <code>discard</code> in the list of options for encrypted block devices located on an SSD (see <a href="../en/Dm-crypt/System_configuration.html#crypttab" title="Dm-crypt/System configuration">dm-crypt/System configuration#crypttab</a>).
</p>
<p>For the root filesystem, follow the instructions from <a href="../en/Dm-crypt/Specialties.html#Discard/TRIM_support_for_solid_state_drives_(SSD)" title="Dm-crypt/Specialties">dm-crypt/Specialties#Discard/TRIM support for solid state drives (SSD)</a> to add the right kernel parameter to the bootloader configuration.
</p>
<h3><span class="mw-headline" id="Maximizing_performance">Maximizing performance</span></h3>
<p>Follow the tips in <a href="../en/Improving_performance.html#Storage_devices" title="Improving performance">Improving performance#Storage devices</a> to maximize the performance of your drives.
</p>
<h4><span class="mw-headline" id="Native_sector_size">Native sector size</span></h4>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../en/Advanced_Format.html" title="Advanced Format">Advanced Format</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> Or at least link to the page. There is also <a href="../en/Solid_state_drive/NVMe.html#Sector_size" title="Solid state drive/NVMe">Solid state drive/NVMe#Sector size</a>. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Solid_state_drive">Talk:Solid state drive#</a>)</div>
</div>
<p>Most SSDs report their sector size as 512 bytes, even though they use larger sectors - typically 4 kB, 8 kB, or sometimes larger.  Because they report as 512 byte devices, filesystems cannot automatically optimise for the native sector size and this must be manually specified when creating a filesystem to avoid suboptimal performance.
</p>
<p>As an alternative to manually overriding the autodetected sector size, some SSDs can have their sector size changed during formatting, so that they report a number closer to their true sector size.
</p>
<h5><span class="mw-headline" id="NVMe">NVMe</span></h5>
<p>To see whether a given NVMe device supports this, use the <i>Identify Namespace</i> command.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># nvme id-ns /dev/nvme0n1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">nlbaf   : 0
[...]
lbaf  0 : ms:0   lbads:9  rp:0 (in use)
</pre>
<p><code>nlbaf</code> is the number of LBA formats minus 1, so here there is only one format supported.  The list of formats is at the end of the output.  Here <code>lbaf 0</code> means LBA format #0.  It has an <code>lbads</code> (LBA data size) of 9, which means sectors are 2<sup>9</sup> or 512 bytes.  If the device is capable of 4 kB sectors, there will be another entry here with an <code>lbads</code> of 12.  The <code>rp</code> (Relative Performance) value indicates which format will provide the best performance, with 0 being the best.  <code>ms</code> is (probably) the number of extra metadata bytes per sector, and this is not well supported under Linux so best to select a format with a value of 0 here.
</p>
<p>To change the sector size, use <code>nvme format</code> and specify the preferred value with the <code>--lbaf</code> parameter.
</p>
<h5><span class="mw-headline" id="SATA">SATA</span></h5>
<p>For SATA devices, manufacturer specific programs must be used.  Not all SATA devices support having the sector size changed.
</p>
<ul><li>Intel: Use the <a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/29337/Intel-Memory-and-Storage-Tool-CLI-Command-Line-Interface-?product=83425">Intel Memory and Storage (MAS) Tool</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/intel-mas-cli-tool/">intel-mas-cli-tool</a></span><sup><small>AUR</small></sup>) with the <code>-set PhysicalSectorSize=4096</code> option.</li></ul>
<h3><span class="mw-headline" id="Security">Security</span></h3>
<h4>
<span id="Hdparm_shows_.22frozen.22_state"></span><span class="mw-headline" id='Hdparm_shows_"frozen"_state'>Hdparm shows "frozen" state</span>
</h4>
<p>Some motherboard BIOS' issue a "security freeze" command to attached storage devices on initialization. Likewise some SSD (and HDD) BIOS' are set to "security freeze" in the factory already. Both result in the device's password security settings to be set to <b>frozen</b>, as shown in below output: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># hdparm -I /dev/sda</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Security: 
 	Master password revision code = 65534
 		supported
 	not	enabled
 	<b>not	locked</b>
 		<b>frozen</b>
 	not	expired: security count
 		supported: enhanced erase
 	4min for SECURITY ERASE UNIT. 2min for ENHANCED SECURITY ERASE UNIT.</pre>
<p>Operations like formatting the device or installing operating systems are not affected by the "security freeze". 
</p>
<p>The above output shows the device is <b>not locked</b> by a HDD-password on boot and the <b>frozen</b> state safeguards the device against malwares which may try to lock it by setting a password to it at runtime. 
</p>
<p>If you intend to set a password to a "frozen" device yourself, a motherboard BIOS with support for it is required. A lot of notebooks have support, because it is required for <a href="../en/Self-encrypting_drives.html" title="Self-encrypting drives">hardware encryption</a>, but support may not be trivial for a desktop/server board. For the Intel DH67CL/BL motherboard, for example, the motherboard has to be set to "maintenance mode" by a physical jumper to access the settings (see <a rel="nofollow" class="external autonumber" href="https://sstahlman.blogspot.in/2014/07/hardware-fde-with-intel-ssd-330-on.html?showComment=1411193181867#c4579383928221016762">[10]</a>, <a rel="nofollow" class="external autonumber" href="https://communities.intel.com/message/251978#251978">[11]</a>). 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Do not try to change the above <b>lock</b> security settings with <code>hdparm</code> unless you know exactly what you are doing.</div>
<p>If you intend to erase the SSD, see <a href="../en/Securely_wipe_disk.html#hdparm" title="Securely wipe disk">Securely wipe disk#hdparm</a> and <a href="#SSD_memory_cell_clearing">#SSD memory cell clearing</a> below.
</p>
<h4><span class="mw-headline" id="SSD_memory_cell_clearing">SSD memory cell clearing</span></h4>
<p>On occasion, users may wish to completely reset an SSD's cells to the same virgin state they were at the time the device was installed thus restoring it to its <a rel="nofollow" class="external text" href="https://www.anandtech.com/show/2738/8">factory default write performance</a>. Write performance is known to degrade over time even on SSDs with native TRIM support. TRIM only safeguards against file deletes, not replacements such as an incremental save.
</p>
<p>The reset is easily accomplished in a three step procedure denoted on the <a href="../en/Solid_state_drive/Memory_cell_clearing.html" class="mw-redirect" title="SSD memory cell clearing">SSD memory cell clearing</a> wiki article. If the reason for the reset is to wipe data, you may not want to rely on the SSD bios to perform it securely. See <a href="../en/Securely_wipe_disk.html#Flash_memory" title="Securely wipe disk">Securely wipe disk#Flash memory</a> for further information and examples to perform a wipe.
</p>
<h4><span class="mw-headline" id="Hardware_encryption">Hardware encryption</span></h4>
<p>As noted in <a href="#Hdparm_shows_%22frozen%22_state">#Hdparm shows "frozen" state</a> setting a password for a storage device (SSD/HDD) in the BIOS may also initialize the hardware encryption of devices supporting it. If the device also conforms to the OPAL standard, this may also be achieved without a respective BIOS feature to set the passphrase, see <a href="../en/Self-encrypting_drives.html" title="Self-encrypting drives">Self-encrypting drives</a>.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>It is possible that the issue you are encountering is a firmware bug which is not Linux specific, so before trying to troubleshoot an issue affecting the SSD device, you should first check if updates are available for:
</p>
<ul>
<li>The <a href="#Firmware">SSD's firmware</a>
</li>
<li>The <a href="../en/Flashing_BIOS_from_Linux.html" title="Flashing BIOS from Linux">motherboard's BIOS/UEFI firmware</a>
</li>
</ul>
<p>Even if it is a firmware bug it might be possible to avoid it, so if there are no updates to the firmware or you hesitant on updating firmware then the following might help.
</p>
<h3><span class="mw-headline" id="Resolving_NCQ_errors">Resolving NCQ errors</span></h3>
<p>Some SSDs and SATA chipsets do not work properly with Linux Native Command Queueing (NCQ). The tell-tale dmesg errors look like this:
</p>
<pre>[ 9.115544] ata9: exception Emask 0x0 SAct 0xf SErr 0x0 action 0x10 frozen
[ 9.115550] ata9.00: failed command: READ FPDMA QUEUED
[ 9.115556] ata9.00: cmd 60/04:00:d4:82:85/00:00:1f:00:00/40 tag 0 ncq 2048 in
[ 9.115557] res 40/00:18:d3:82:85/00:00:1f:00:00/40 Emask 0x4 (timeout)
</pre>
<p>To disable NCQ on boot, add <code>libata.force=noncq</code> to the kernel command line in the <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Bootloader">bootloader</a> configuration. To disable NCQ only for disk 0 on port 9 use: <code>libata.force=9.00:noncq</code>
</p>
<p>Alternatively, you may disable NCQ for a specific drive without rebooting via sysfs:
</p>
<pre># echo 1 &gt; /sys/block/sdX/device/queue_depth
</pre>
<p>If this (and also updating the firmware) does not resolve the problem or causes other issues, then <a href="../en/Bug_reporting_guidelines.html" class="mw-redirect" title="Reporting bug guidelines">file a bug report</a>.
</p>
<h3><span class="mw-headline" id="Resolving_SATA_power_management_related_errors">Resolving SATA power management related errors</span></h3>
<p>Some SSDs (e.g. Transcend MTS400) are failing when SATA Active Link Power Management, <a href="https://en.wikipedia.org/wiki/Aggressive_Link_Power_Management" class="extiw" title="wikipedia:Aggressive Link Power Management">ALPM</a>, is enabled.
ALPM is disabled by default and enabled by a power saving daemon (e.g. <a href="../en/TLP.html" title="TLP">TLP</a>, <a href="../en/Laptop_Mode_Tools.html" title="Laptop Mode Tools">Laptop Mode Tools</a>).
</p>
<p>If you are starting to encounter SATA related errors when using such a daemon, you should try to disable ALPM by setting its state to <code>max_performance</code> for both battery and AC powered profiles.
</p>
<h3><span class="mw-headline" id="External_SSD_with_TRIM_support">External SSD with TRIM support</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Several <a href="../en/Help:Style.html" title="Help:Style">style</a> and formatting problems, especially too many explicit commands - see <a href="../en/Help:Style.html#File_editing_requests" title="Help:Style">Help:Style#File editing requests</a>. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Solid_state_drive">Talk:Solid state drive#</a>)</div>
</div>
<p>Several USB-to-SATA bridge chips (like VL715, VL716 etc.) and also USB-to-PCIe bridge chips (like the <a rel="nofollow" class="external text" href="http://www.jmicron.com/PDF/brief/jms583.pdf">JMicron JMS583</a> used in external NVMe enclosures like <a rel="nofollow" class="external text" href="https://www.raidsonic.de/en/standards/searchresults.php?we_objectID=5666">IB-1817M-C31</a>) support TRIM-like commands that can be sent through the <a href="https://en.wikipedia.org/wiki/USB_Attached_SCSI" class="extiw" title="wikipedia:USB Attached SCSI">USB Attached SCSI</a> driver (named "uas" under Linux).
</p>
<p>But the kernel may not automatically detect this capability, and therefore might not use it.
Assuming your block device in question is /dev/sdX, you can find out whether that is the case by using the command
</p>
<pre> sg_readcap -l /dev/sdX
</pre>
<p>If in its output you find a line stating "Logical block provisioning: lbpme=0" then you know that the kernel assumes the device does not support "<a rel="nofollow" class="external text" href="https://www.seagate.com/files/staticfiles/support/docs/manual/Interface%20manuals/100293068k.pdf#G4.1427908">Logical Block Provisioning Management</a>" because the (LBPME) bit is not set.
</p>
<p>If this is the case, then you should next find out whether the <a rel="nofollow" class="external text" href="https://www.seagate.com/files/staticfiles/support/docs/manual/Interface%20manuals/100293068k.pdf#G4.3076244">"Vital Product Data" (VPD) page on "Logical Block Provisioning"</a> of your device tells of supported mechanisms for unmapping data. You can do this using the command:
</p>
<pre> sg_vpd -a /dev/sdX
</pre>
<p>Look for lines in the output that look like this:
</p>
<pre> Unmap command supported (LBPU): 1
 Write same (16) with unmap bit supported (LBPWS): 0
 Write same (10) with unmap bit supported (LBPWS10): 0
</pre>
<p>This example would tell you the device supports the "UNMAP" command.
</p>
<p>Have a look at the output of
</p>
<pre> cat /sys/block/sdX/device/scsi_disk/*/provisioning_mode
</pre>
<p>If the kernel did not detect the capability of your device to unmap data, then this will likely return "full".
Apart from "full", the kernel SCSI storage driver currently knows the following values for provisioning_mode:
</p>
<pre> unmap
 writesame_16
 writesame_10
 writesame_zero
 disabled
</pre>
<p>For the example above, you could now write "unmap" to "provisioning_mode" to ask the kernel to use that:
</p>
<pre> echo "unmap" &gt;/sys/block/sdX/device/scsi_disk/*/provisioning_mode
</pre>
<p>This should immediately enable you to use tools like "blkdiscard" on /dev/sdX or "fstrim" on filesystems mounted on /dev/sdX.
</p>
<p>If you want to enable a "provisioning_mode" automatically when an external device of a certain vendor/product is attached, this can be automated via the "<a href="../en/Udev.html" title="Udev">udev</a>" mechanism. First find the USB Vendor and Product IDs:
</p>
<pre> cat /sys/block/sdX/../../../../../../idVendor
 cat /sys/block/sdX/../../../../../../idProduct
</pre>
<p>Then create or append to a <a href="../en/Udev.html" title="Udev">udev</a> rule file (example here using idVendor 152d and idProduct 0583):
</p>
<pre> echo 'ACTION=="add|change", ATTRS{idVendor}=="152d", ATTRS{idProduct}=="0583", SUBSYSTEM=="scsi_disk", ATTR{provisioning_mode}="unmap"' &gt;&gt;/etc/udev/rules.d/10-uas-discard.rules
</pre>
<p>(You can also use the <code>lsusb</code> command to look for the relevant idVendor / idProduct.)
</p>
<h2><span class="mw-headline" id="Firmware">Firmware</span></h2>
<h3><span class="mw-headline" id="ADATA">ADATA</span></h3>
<p>ADATA has a utility available for Linux (i686) on their <a rel="nofollow" class="external text" href="http://www.adata.com.tw/index.php?action=ss_main&amp;page=ss_content_driver&amp;lan=en">support page</a>. The link to latest firmware will appear after selecting the model.  The latest Linux update utility is packed with firmware and needs to be run as root. One may need to set correct permissions for binary file first.
</p>
<h3><span class="mw-headline" id="Crucial">Crucial</span></h3>
<p>Crucial provides an option for updating the firmware with an ISO image. These images can be found after selecting the product on their <a rel="nofollow" class="external text" href="http://www.crucial.com/usa/en/support-ssd">SSD support page</a> and downloading the "Manual Boot File."  
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> ISO images provided by Crucial do not seem to be hybrid. If you will use just the <code>dd</code> command to copy the image to some device, the <a href="../en/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR">MBR</a> will not be present, making such device unbootable.</div>
<p>Owners of an M4 Crucial model, may check if a firmware upgrade is needed with <code>smartctl</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ smartctl --all /dev/sd<b>X</b></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">==&gt; WARNING: This drive may hang after 5184 hours of power-on time:
<a rel="nofollow" class="external free" href="http://www.tomshardware.com/news/Crucial-m4-Firmware-BSOD,14544.html">http://www.tomshardware.com/news/Crucial-m4-Firmware-BSOD,14544.html</a>
See the following web pages for firmware updates:
<a rel="nofollow" class="external free" href="http://www.crucial.com/support/firmware.aspx">http://www.crucial.com/support/firmware.aspx</a><sup title="Last check status: domain name not resolved">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-04-03 ⓘ]</sup>
<a rel="nofollow" class="external free" href="http://www.micron.com/products/solid-state-storage/client-ssd#software">http://www.micron.com/products/solid-state-storage/client-ssd#software</a>
</pre>
<p>Users seeing this warning are advised to backup all sensible data and <b>consider upgrading immediately</b>. Check <a rel="nofollow" class="external text" href="http://www.rojtberg.net/1008/updating-crucial-mx100-firmware-with-ubuntu/">this instructions</a> to update Crucial MX100 firmware by using the ISO image and Grub.
</p>
<h3><span class="mw-headline" id="Intel">Intel</span></h3>
<p>Intel has a Linux live system based <a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/18363">Firmware Update Tool</a> for operating systems that are not compatible with its Windows <a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/18455">Intel® Solid-State Drive Toolbox</a> software.
</p>
<p>There is also a newer Linux command-line utility that can reflash firmware called the <a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/29337/Intel-Memory-and-Storage-Tool-CLI-Command-Line-Interface-?product=83425">Intel Memory and Storage (MAS) Tool</a> available in the AUR as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/intel-mas-cli-tool/">intel-mas-cli-tool</a></span><sup><small>AUR</small></sup>.  There is a <a rel="nofollow" class="external text" href="https://downloadmirror.intel.com/29337/eng/Intel_Memory_And_Storage_Tool_User%20Guide-Public-342245-001US.pdf">PDF user guide</a> available.
</p>
<p>An example for checking the firmware status is:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># intelmas show -intelssd 0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">DevicePath : /dev/nvme0n1
DeviceStatus : Healthy
Firmware : 002C
FirmwareUpdateAvailable : The selected Intel SSD contains current firmware as of this tool release.
</pre>
<p><code>-intelssd 0</code> can be omitted if there is only one Intel SSD in the system, or <code>1</code> passed for the second SSD, and so on.
</p>
<p>If an update is available, it is performed by running <code>intelmas load -intelssd 0</code>.  The PDF user guide suggests that this procedure needs to be performed twice in Linux, with a power cycle in between.  The latest firmware for all devices is distributed as part of the MAS Tool itself, so does not need to be downloaded separately.
</p>
<h3><span class="mw-headline" id="Kingston">Kingston</span></h3>
<p>KFU tool is available on the AUR for the Sandforce based drives, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/kingston_fw_updater/">kingston_fw_updater</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Mushkin">Mushkin</span></h3>
<p>The lesser known Mushkin brand solid state drives also use Sandforce controllers, and have a Linux utility (nearly identical to Kingston's) to update the firmware.
</p>
<h3><span class="mw-headline" id="OCZ">OCZ</span></h3>
<p>OCZ has a <a rel="nofollow" class="external text" href="https://www.ocz.com/us/download/clout">Command Line Online Update Tool (CLOUT)</a> available for Linux. The AUR provides <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ocz-ssd-utility/">ocz-ssd-utility</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ocztoolbox/">ocztoolbox</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/oczclout/">oczclout</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Samsung">Samsung</span></h3>
<p>Samsung notes that update methods other than using their Magician Software are "not supported", but it is possible. The Magician Software can be used to make a USB drive bootable with the firmware update. Samsung provides pre-made <a rel="nofollow" class="external text" href="https://www.samsung.com/semiconductor/minisite/ssd/download/tools.html">bootable ISO images</a> that can be used to update the firmware. Another option is to use Samsung's <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/samsung_magician-consumer-ssd/">samsung_magician-consumer-ssd</a></span><sup><small>AUR</small></sup>, which is available in the AUR. Magician only supports Samsung-branded SSDs; those manufactured by Samsung for OEMs (e.g., Lenovo) are not supported.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Samsung does not make it obvious at all that they actually provide these. They seem to have 4 different firmware update pages, and each references different ways of doing things.</div>
<p>Users preferring to run the firmware update from a live USB created under Linux (without using Samsung's "Magician" software under Microsoft Windows) can refer to <a rel="nofollow" class="external text" href="https://web.archive.org/web/20160322230114/fomori.org/blog/?p=933">this post</a> for reference.
</p>
<h4><span class="mw-headline" id="Upgrade_under_Linux">Upgrade under Linux</span></h4>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Assumes use of <a href="../en/Udisks.html" title="Udisks">udisks</a>; loop mounts can be done directly via <a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">mount</a> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Solid_state_drive">Talk:Solid state drive#</a>)</div>
</div>
<p>Alternatively, the firmware can be upgraded natively, without making a bootable USB stick, as shown below. First visit the <a rel="nofollow" class="external text" href="https://www.samsung.com/semiconductor/minisite/ssd/download/tools.html">Samsung downloads page</a> and download the latest firmware for Windows, which is available as a disk image. In the following, <code>Samsung_SSD_840_EVO_EXT0DB6Q.iso</code> is used as an example file name, adjust it accordingly.
</p>
<p>Setup the disk image:
</p>
<pre>$ udisksctl loop-setup -r -f Samsung_SSD_840_EVO_EXT0DB6Q.iso
</pre>
<p>This will make the ISO available as a loop device, and display the device path. Assuming it was <code>/dev/loop0</code>:
</p>
<pre>$ udisksctl mount -b /dev/loop0
</pre>
<p>Get the contents of the disk:
</p>
<pre>$ mkdir Samsung_SSD_840_EVO_EXT0DB6Q
$ cp -r /run/media/$USER/CDROM/isolinux/ Samsung_SSD_840_EVO_EXT0DB6Q
</pre>
<p>Unmount the iso:
</p>
<pre>$ udisksctl unmount -b /dev/loop0
$ cd Samsung_SSD_840_EVO_EXT0DB6Q/isolinux
</pre>
<p>There is a FreeDOS image here that contains the firmware. Mount the image as before:
</p>
<pre>$ udisksctl loop-setup -r -f btdsk.img
$ udisksctl mount -b /dev/loop1
$ cp -r /run/media/$USER/C04D-1342/ Samsung_SSD_840_EVO_EXT0DB6Q
$ cd Samsung_SSD_840_EVO_EXT0DB6Q/C04D-1342/samsung
</pre>
<p>Get the disk number from magician:
</p>
<pre># magician -L
</pre>
<p>Assuming it was 0:
</p>
<pre># magician --disk 0 -F -p DSRD
</pre>
<p>Verify that the latest firmware has been installed:
</p>
<pre># magician -L
</pre>
<p>Finally reboot.
</p>
<h3><span class="mw-headline" id="SanDisk">SanDisk</span></h3>
<p>SanDisk makes ISO firmware images to allow SSD firmware update on operating systems that are unsupported by their SanDisk SSD Toolkit.
</p>
<p>One must choose the firmware for the correct <i>SSD model</i>, <b>and</b> the correct <i>capacity</i> that it has (e.g. 60GB, <b>or</b> 256GB). After burning the ISO firmware image, simply restart the PC to boot with the newly created CD/DVD boot disk (may work from a USB stick).
</p>
<p>The iso images just contain a linux kernel and an initrd. Extract them to <code>/boot</code> partition and boot them with <a href="../en/GRUB.html" title="GRUB">GRUB</a> or <a href="../en/Syslinux.html" title="Syslinux">Syslinux</a> to update the firmware.
</p>
<p>See also:
</p>
<p>SanDisk Extreme SSD <a rel="nofollow" class="external text" href="https://kb.sandisk.com/app/answers/detail/a_id/10127">Firmware Release notes</a> and <a rel="nofollow" class="external text" href="https://kb.sandisk.com/app/answers/detail/a_id/10476">Manual Firmware update version R211</a> 
</p>
<p>SanDisk Ultra SSD <a rel="nofollow" class="external text" href="https://kb.sandisk.com/app/answers/detail/a_id/10192">Firmware release notes</a> and <a rel="nofollow" class="external text" href="https://kb.sandisk.com/app/answers/detail/a_id/10477">Manual Firmware update version 365A13F0</a>
</p>
<p>SanDisk Ultra+ SSD <a rel="nofollow" class="external text" href="https://kb.sandisk.com/app/answers/detail/a_id/12763">Firmware release notes</a> and <a rel="nofollow" class="external text" href="https://kb.sandisk.com/app/answers/detail/a_id/12762">Manual Firmware update version X2316RL</a> - use <code>smartctl -a /dev/sdX</code> to determine if a "H2" or "HP" model is used.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.reddit.com/r/archlinux/comments/rkwjm/what_should_i_keep_in_mind_when_installing_on_ssd/">Discussion on Reddit about installing Arch on an SSD</a></li>
<li><a rel="nofollow" class="external text" href="http://permalink.gmane.org/gmane.comp.file-systems.btrfs/19446">Re: Varying Leafsize and Nodesize in Btrfs</a></li>
<li><a rel="nofollow" class="external text" href="http://thread.gmane.org/gmane.comp.file-systems.btrfs/19650/focus=19667">Re: SSD alignment and Btrfs sector size</a></li>
<li><a rel="nofollow" class="external text" href="https://forums.anandtech.com/threads/erase-block-alignment-misinformation.2266113/">Erase Block (Alignment) Misinformation?</a></li>
<li><a rel="nofollow" class="external text" href="https://superuser.com/questions/492084/is-alignment-to-erase-block-size-needed-for-modern-ssds">Is alignment to erase block size needed for modern SSD's?</a></li>
<li><a rel="nofollow" class="external text" href="http://thread.gmane.org/gmane.comp.file-systems.btrfs/15646">Btrfs support for efficient SSD operation (data blocks alignment)</a></li>
<li><a rel="nofollow" class="external text" href="https://serverfault.com/questions/356534/ssd-erase-block-size-lvm-pv-on-raw-device-alignment">SSD, Erase Block Size &amp; LVM: PV on raw device, Alignment</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Storage.html" title="Category:Storage">Storage</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Solid_state_drive&amp;oldid=649230">https://wiki.archlinux.org/index.php?title=Solid_state_drive&amp;oldid=649230</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 19 January 2021, at 00:18.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>

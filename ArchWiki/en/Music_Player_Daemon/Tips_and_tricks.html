<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Music Player Daemon/Tips and tricks - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Music_Player_Daemon_Tips_and_tricks rootpage-Music_Player_Daemon skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Music Player Daemon/Tips and tricks</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="../../en/Music_Player_Daemon.html" title="Music Player Daemon">Music Player Daemon</a></span></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p>Go back to <a href="../../en/Music_Player_Daemon.html" title="Music Player Daemon">Music Player Daemon</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Organizing_library"><span class="tocnumber">1</span> <span class="toctext">Organizing library</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Last.fm/Libre.fm_scrobbling"><span class="tocnumber">2</span> <span class="toctext">Last.fm/Libre.fm scrobbling</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#mpdas"><span class="tocnumber">2.1</span> <span class="toctext">mpdas</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#mpdscribble"><span class="tocnumber">2.2</span> <span class="toctext">mpdscribble</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Sonata"><span class="tocnumber">2.3</span> <span class="toctext">Sonata</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#YAMS"><span class="tocnumber">2.4</span> <span class="toctext">YAMS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Disable_resume_playback_on_startup"><span class="tocnumber">3</span> <span class="toctext">Disable resume playback on startup</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Example_configuration:_Output_with_44.1_KHz_at_e._g._16_bit_depth,_multiple_programs_at_once"><span class="tocnumber">4</span> <span class="toctext">Example configuration: Output with 44.1 KHz at e. g. 16 bit depth, multiple programs at once</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Control_MPD_with_lirc"><span class="tocnumber">5</span> <span class="toctext">Control MPD with lirc</span></a></li>
<li class="toclevel-1 tocsection-10">
<a href="#PulseAudio"><span class="tocnumber">6</span> <span class="toctext">PulseAudio</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Local_(as_your_own_user)"><span class="tocnumber">6.1</span> <span class="toctext">Local (as your own user)</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Local_(with_separate_mpd_user)"><span class="tocnumber">6.2</span> <span class="toctext">Local (with separate mpd user)</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Remote"><span class="tocnumber">6.3</span> <span class="toctext">Remote</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Cue_Files"><span class="tocnumber">7</span> <span class="toctext">Cue Files</span></a></li>
<li class="toclevel-1 tocsection-15">
<a href="#HTTP_streaming"><span class="tocnumber">8</span> <span class="toctext">HTTP streaming</span></a>
<ul>
<li class="toclevel-2 tocsection-16">
<a href="#Configuration"><span class="tocnumber">8.1</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Format"><span class="tocnumber">8.1.1</span> <span class="toctext">Format</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#Use"><span class="tocnumber">8.2</span> <span class="toctext">Use</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Music_streaming_with_the_satellite_setup"><span class="tocnumber">9</span> <span class="toctext">Music streaming with the satellite setup</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Topology"><span class="tocnumber">9.1</span> <span class="toctext">Topology</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Configuration_2"><span class="tocnumber">9.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22">
<a href="#MPRIS_support"><span class="tocnumber">10</span> <span class="toctext">MPRIS support</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#mpDris2"><span class="tocnumber">10.1</span> <span class="toctext">mpDris2</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#mpd-mpris"><span class="tocnumber">10.2</span> <span class="toctext">mpd-mpris</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25">
<a href="#Notifications"><span class="tocnumber">11</span> <span class="toctext">Notifications</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#musnify-mpd"><span class="tocnumber">11.1</span> <span class="toctext">musnify-mpd</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#mpd-notification"><span class="tocnumber">11.2</span> <span class="toctext">mpd-notification</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28"><a href="#Adding_a_separate_volume_control_(ALSA)"><span class="tocnumber">12</span> <span class="toctext">Adding a separate volume control (ALSA)</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Control_the_remote_mpd_server"><span class="tocnumber">13</span> <span class="toctext">Control the remote mpd server</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Organizing_library">Organizing library</span></h2>
<p>MPD does not manage your library. Check out <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=beets">beets</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=picard">picard</a></span> in the <a href="../../en/Official_repositories.html" title="Official repositories">official repositories</a>.
</p>
<h2>
<span id="Last.fm.2FLibre.fm_scrobbling"></span><span class="mw-headline" id="Last.fm/Libre.fm_scrobbling">Last.fm/Libre.fm scrobbling</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> mpd release 0.18 removed Last.fm <a rel="nofollow" class="external text" href="http://git.musicpd.org/cgit/master/mpd.git/tree/NEWS">support</a>. However, some clients offer scrobbling independent of mpd.</div>
<p>To scrobble your songs to <a rel="nofollow" class="external text" href="http://www.last.fm">Last.fm</a> or <a rel="nofollow" class="external text" href="http://libre.fm">Libre.fm</a> when using MPD, there are several possibilities.
</p>
<h3><span class="mw-headline" id="mpdas">mpdas</span></h3>
<p><a rel="nofollow" class="external text" href="http://50hz.ws/mpdas/">mpdas</a> is an AudioScrobbler client for MPD written in C++. It uses <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=curl">curl</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libmpd">libmpd</a></span>. mpdas supports the latest AudioScrobbler protocol (2.0) and will also cache unscrobbled plays in <code>~/.mpdascache</code> if there is no network connectivity.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mpdas/">mpdas</a></span><sup><small>AUR</small></sup> is available in the <a href="../../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>.
</p>
<p>Configuration of mpdas is very simple, see the official <a rel="nofollow" class="external text" href="https://github.com/hrkfdn/mpdas/blob/master/README.md">README</a>. A very basic example of <code>/etc/mpdasrc</code> is also available as <code>/etc/mpdasrc</code>.
</p>
<p>To autostart <i>mpdas</i> along with <i>mpd</i>, add an entry for it into the file in which you start <i>mpd</i> (e.g. <a href="../../en/Xinit.html#xinitrc" class="mw-redirect" title="Xinitrc">xinitrc</a>):
</p>
<pre>[[ -z $(pgrep -xU $UID mpdas) ]] &amp;&amp; mpdas &amp;</pre>
<p>When <i>mpd</i> is started with a <a href="../../en/Music_Player_Daemon.html#Autostart_with_systemd" title="Music Player Daemon">systemd user service</a>, it is better to start <i>mpdas</i> the same way:
</p>
<pre>$ systemctl --user start mpdas.service
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you get a failed <code>mpdas.service</code> after system startup, consider using <a href="../../en/Music_Player_Daemon.html#Socket_activation" title="Music Player Daemon">socket activation</a> with <code>mpd.socket</code> instead.</div>
<h3><span class="mw-headline" id="mpdscribble">mpdscribble</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mpdscribble/">mpdscribble</a></span><sup><small>AUR</small></sup> is a daemon available in the <a href="../../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>. This is arguably the best alternative, because it is the semi-official MPD scrobbler and uses the new "idle" feature in MPD for more accurate scrobbling. Also, you do not need root access to configure it, because it does not need any changes to <code>/etc</code> at all. Visit <a rel="nofollow" class="external text" href="https://www.musicpd.org/clients/mpdscribble/">the official website</a> for more information.
</p>
<p>A sample config is included: <code>/usr/share/mpdscribble/mpdscribble.conf.example</code>, copy it to <code>~/.mpdscribble/mpdscribble.conf</code> and edit to suit.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Trailing comments are not supported by its parser. Write them in their own lines.</div>
<p>Your password can also be in the form of an md5hash.
</p>
<pre>echo -n "<i>password</i>" | md5sum | cut -f 1 -d " "
</pre>
<p>To autostart <i>mpdscribble</i> you can use the <code>mpdscribble.service</code> under systemd user instance. See <a href="../../en/Systemd/User.html" title="Systemd/User">systemd/User</a> for details.
</p>
<p>Alternatively you can autostart <i>mpdscribble</i> along with <i>mpd</i>, add an entry for it into the file in which you start <i>mpd</i> (e.g. <code>~/.xinitrc</code>):
</p>
<pre>[[ -z $(pgrep -xU $UID mpdscribble) ]] &amp;&amp; mpdscribble &amp;
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you get a <code>[last.fm] handshake failed, username or password incorrect (BADAUTH)</code> error, make sure your username and password are correct, and that your password is not <a rel="nofollow" class="external text" href="http://bugs.musicpd.org/view.php?id=3836">32 characters long</a>.</div>
<h3><span class="mw-headline" id="Sonata">Sonata</span></h3>
<p>Sonata has built-in support for scrobbling, although that requires the program to run the whole time. Additionally, Sonata does not cache the songs if they cannot be forwarded to Last.fm at the time of playing, meaning they will not be added to the statistics.
</p>
<h3><span class="mw-headline" id="YAMS">YAMS</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/Berulacks/yams/">YAMS</a> is a Last.FM scrobbling daemon for MPD written in Python. 
</p>
<p>As it's written for v2.0 of Last.FM's <a rel="nofollow" class="external text" href="https://www.last.fm/api/scrobbling">scrobbling API</a>, YAMS does not store your username or password locally, but opts to use a cookie instead. Similar to other scrobblers, YAMS can save failed scrobbles and upload them at a later date. It also offers a decent amount of configuration options for when/how a scrobble should be made (including ignoring duplicate scrobbles when a track is played multiple times in a row).
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/python-yams/">python-yams</a></span><sup><small>AUR</small></sup> is available in the <a href="../../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>.
</p>
<p>In order to authenticate, the user <i>must</i> run the <code>yams</code> command in an interactive terminal, at least once, and follow the printed instructions. 
</p>
<p>Afterwards, YAMS can be started with its binary:
</p>
<p><code>yams</code> runs as a daemon by default (<code>yams -N</code> will run it in the foreground).
</p>
<p><code>yams -k</code> will kill the current running instance.
</p>
<p><code>yams -a</code> will attach to the current running instance's log file, allowing you to watch the daemon's output.
</p>
<p><code>yams -h</code> will print all command line options.
</p>
<p>YAMS also comes with a systemd service file that can be started with <code>systemctl --user start yams</code> after authentication is complete.
</p>
<h2><span class="mw-headline" id="Disable_resume_playback_on_startup">Disable resume playback on startup</span></h2>
<p>This feature is present in <i>mpd</i> after version 0.16.2. When this feature is enabled, <i>mpd</i> will always start in the "paused" state, even if a song was playing when mpd was stopped. Add the line below to your <code>mpd.conf</code> to enable this feature.
</p>
<pre>restore_paused "yes"
</pre>
<h2>
<span id="Example_configuration:_Output_with_44.1_KHz_at_e._g._16_bit_depth.2C_multiple_programs_at_once"></span><span class="mw-headline" id="Example_configuration:_Output_with_44.1_KHz_at_e._g._16_bit_depth,_multiple_programs_at_once">Example configuration: Output with 44.1 KHz at e. g. 16 bit depth, multiple programs at once</span>
</h2>
<p><i>Why these formats?</i> Because they are the standard format for CD audio, because ALSA on its own allows more than one program "to sound" only with dmix — which uses an inferior resampling algorithm by default — and because dmix by default resamples anything lower to 48 KHz (or whatever higher format is playing at the time). Also, some get clicking sounds if at least <code>mpd.conf</code> is not changed this way.
</p>
<p><i>What is the downside?</i> These settings cause <i>everything</i> (if necessary) to be resampled to this format, such as material from DVD or TV which usually is at 48 KHz. But there is no known way to have ALSA dynamically change the format, and particularly if you listen to far more CDs than anything else the occasional 48 → 44.1 is not too great a loss.
</p>
<p>The following assumes that there are not already other settings which conflict resp. overwrite it. This applies especially to the current user's potential <code>~/.asoundrc</code> — which MPD as its own user ignores, therefore the following should go to <code>/etc/asound.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asound.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">defaults.pcm.dmix.rate 44100 # Force 44.1 KHz
defaults.pcm.dmix.format S16_LE # Force 16 bits
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">audio_output {
        type                    "alsa" # Use the ALSA output plugin.
	name			"your_custom_name" # Must be present and does not have to match the actual card name , e.g. what you have in /etc/asound.conf
        options                 "dev=dmixer"
        device                  "plug:dmix" # Both lines cause MPD to output to dmix
	format	        	"44100:16:2" # the actual format
	auto_resample		"no" # This bypasses ALSA's own algorithms, which generally are inferior. See below how to choose a different one.
}</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> MPD gives the mp3 format a special treatment at decoding: it is always put out as 24 bit. (The conversion as forced by the <i>format</i> line only comes after that.)</div>
<p>If one wants to leave the bit depth decision to ALSA resp. MPD, comment out resp. omit the <i>dmix.format</i> line and change the one for mpd with <i>format</i> to "44100:*:2".
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <i>Crossfading</i> between files decoded at two different bit depths (say, one mp3 and one 16 bit flac) does not work unless conversion is active.</div>
<h2><span class="mw-headline" id="Control_MPD_with_lirc">Control MPD with lirc</span></h2>
<p>There are already some clients designed for communications between lircd and MPD, however, as far as the practical use, they are not very useful since their functions are limited.
</p>
<p>It is recommended to use mpc with irexec. mpc is a command line player which only sends the command to MPD and exits immediately, which is perfect for irexec, the command runner included in lirc. What irexec does is that it runs a specified command once received a remote control button.
</p>
<p>First of all, please setup your remotes as referred to the <a href="../../en/LIRC.html" title="LIRC">LIRC</a> article.
</p>
<p>Edit your favored lirc startup configuration file, default location is <code>~/.lircrc</code>.
</p>
<p>Fill the file with the following pattern:
</p>
<pre>begin
     prog = irexec
     button = &lt;button_name&gt;
     config = &lt;command_to_run&gt;
     repeat = &lt;0 or 1&gt;
end
</pre>
<p>An example:
</p>
<pre>## irexec
begin
     prog = irexec
     button = play_pause
     config = mpc toggle
     repeat = 0
end

begin
     prog = irexec
     button = stop
     config = mpc stop
     repeat = 0
end
begin
     prog = irexec
     button = previous
     config = mpc prev
     repeat = 0
end
begin
     prog = irexec
     button = next
     config = mpc next
     repeat = 0
end
begin
     prog = irexec
     button = volup
     config = mpc volume +2
     repeat = 1
end
begin
     prog = irexec
     button = voldown
     config = mpc volume -2
     repeat = 1
end
begin
     prog = irexec
     button = pbc
     config = mpc random
     repeat = 0
end
begin
     prog = irexec
     button = pdvd
     config = mpc update
     repeat = 0
end
begin
     prog = irexec
     button = right
     config = mpc seek +00:00:05
     repeat = 0
end
begin
     prog = irexec
     button = left
     config = mpc seek -00:00:05
     repeat = 0
end
begin
     prog = irexec
     button = up
     config = mpc seek +1%
     repeat = 0
end
begin
     prog = irexec
     button = down
     config = mpc seek -1%
     repeat = 0
end
</pre>
<p>There are more functions for mpc, run <span class="plainlinks archwiki-template-man" title="$ man 1 mpc"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mpc.1">mpc(1)</a></span> for more info.
</p>
<h2><span class="mw-headline" id="PulseAudio">PulseAudio</span></h2>
<h3>
<span id="Local_.28as_your_own_user.29"></span><span class="mw-headline" id="Local_(as_your_own_user)">Local (as your own user)</span>
</h3>
<p>No special options are required; just add a pulse output as described in the comments of mpd's config file.
</p>
<h3>
<span id="Local_.28with_separate_mpd_user.29"></span><span class="mw-headline" id="Local_(with_separate_mpd_user)">Local (with separate mpd user)</span>
</h3>
<p>When run as its own user as per the wiki instructions, mpd will be unable to send sound to another user's pulseaudio server. Rather than setting up pulseaudio as a system-wide daemon, a practice strongly discouraged by upstream, you can instead configure mpd to use pulseaudio's TCP module to send sound to localhost:
</p>
<p>First, edit the PulseAudio configuration - either the user configuration in <code>$XDG_CONFIG_HOME/pulse/default.pa</code> (typically <code>~/.config/pulse/default.pa</code>) if it exists, otherwise the system-wide configuration file in <code>/etc/pulse/default.pa</code> and uncomment the TCP module and set 127.0.0.1 as an allowed IP address like this:
</p>
<pre>### Network access (may be configured with paprefs, so leave this commented
### here if you plan to use paprefs)
#load-module module-esound-protocol-tcp
load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1
#load-module module-zeroconf-publish
</pre>
<p>Additional IP ranges in cidr notation may be added using <code>;</code> as the separator. Once this is complete, restart pulseaudio:
</p>
<pre>$ pulseaudio --kill
$ pulseaudio --start -or- start-pulseaudio-x11/kde
</pre>
<p>Next, edit <code>/etc/mpd.conf</code> and add a new pulse output pointing to 127.0.0.1 as a "remote" server:
</p>
<pre>audio_output {
       type		"pulse"
       name		"Local Music Player Daemon"
       server		"127.0.0.1"
}
</pre>
<p>Once this is added, restart mpd.
</p>
<p>You should now have a working local mpd, usable by all users whose pulseaudio servers allow sound from 127.0.0.1.
</p>
<h3><span class="mw-headline" id="Remote">Remote</span></h3>
<p>As with any PulseAudio-enabled program, mpd can send sound over the network. The complete PulseAudio system is not required on the server running mpd; <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpulse">libpulse</a></span> is the only requirement to act as a source and is already a dependency of mpd.
</p>
<p>In order to send audio from mpd to another computer follow the directions above, editing <code>/etc/mpd.conf</code> on the server running mpd using the IP address of the target computer and <code>/etc/pulse/default.pa</code> or <code>$XDG_CONFIG_HOME/default.pa</code> (typically <code>~/.config/pulse/default.pa</code>) on the target computer using the IP address of the server.
</p>
<p>Once this is done, the server's mpd source should show up on the target computer while playing or paused as a normal source able to be rerouted and controlled as usual; there will be no visible source on the target while mpd is stopped.
</p>
<h2><span class="mw-headline" id="Cue_Files">Cue Files</span></h2>
<p>No additional steps are needed for cue support in mpd since 0.17. MPD has its own integrated parser which works with both external and embedded cuesheets.
For example, the command <code>mpc load albumx/x.cue</code> loads the file <code><i>music_directory</i>/albumx/x.cue</code> as playlist; or in the case of an CUESHEET tag, <code>mpc load albumx/x.flac</code>.
</p>
<p>Client support of CUE files is a bit limited. Two available programs that do support CUE files are <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cantata">cantata</a></span> and <a href="../../en/Ncmpcpp.html" title="Ncmpcpp">ncmpcpp</a>.
</p>
<h2><span class="mw-headline" id="HTTP_streaming">HTTP streaming</span></h2>
<p>Since version 0.15 there is a built-in HTTP streaming daemon/server that comes with MPD. This allows MPD to broadcast its music to HTTP clients.
</p>
<p>This is not meant to be used as a streaming solution (e.g. replacement of Spotify, Deezer, etc.). First, it only allows one stream to be played, and multiple users cannot listen to multiple musics at the same time. Second, MPD buffers audio a lot so that it plays reliably even when the client drops the connection for a while, therefore it introduces a non-negligeable latency when changing songs. To use MPD as a streaming solution, see <a href="#Music_streaming_with_the_satellite_setup">#Music streaming with the satellite setup</a>.
</p>
<h3><span class="mw-headline" id="Configuration">Configuration</span></h3>
<p>To activate this server simply set it as output device in mpd.conf:
</p>
<pre>audio_output {
	type		"httpd"
	name		"My HTTP Stream"
	encoder		"vorbis"		# optional
	port		"8000"
#	quality		"5.0"			# do not define if bitrate is defined
	bitrate		"128"			# do not define if quality is defined
	format		"44100:16:1"
	always_on       "yes"			# prevent MPD from disconnecting all listeners when playback is stopped.
	tags            "yes"			# httpd supports sending tags to listening streams.
}
</pre>
<h4><span class="mw-headline" id="Format">Format</span></h4>
<p>MPD supports several encoding formats. See what your MPD supports with:
</p>
<pre>$ mpd --version
</pre>
<h3><span class="mw-headline" id="Use">Use</span></h3>
<p>Then to listen to this stream simply open the URL of your mpd server (along with the specified port) in your favorite music player. Note: You may have to specify the file format of the stream using an appropriate file extension in the URL. For example, using Winamp 5.5, You would use <a rel="nofollow" class="external free" href="http://192.168.1.2:8000/mpd.ogg">http://192.168.1.2:8000/mpd.ogg</a> rather than <a rel="nofollow" class="external free" href="http://192.168.1.2:8000/">http://192.168.1.2:8000/</a>.
</p>
<p>To use mpd to connect to the stream from another computer:
</p>
<pre>mpc add <a rel="nofollow" class="external free" href="http://192.168.1.2:8000">http://192.168.1.2:8000</a>
</pre>
<h2><span class="mw-headline" id="Music_streaming_with_the_satellite_setup">Music streaming with the satellite setup</span></h2>
<p>While <a href="#HTTP_streaming">#HTTP streaming</a> allows the user to broadcast its music over HTTP, the satellite setup allows multiple users to listen to different songs at the same time, on separate machines.
</p>
<h3><span class="mw-headline" id="Topology">Topology</span></h3>
<p>The satellite setup involves two or more machines: a <i>server</i> and multiple <i>clients</i>. The <i>server</i> is typically the machine that has the music files. It runs an MPD instance that will browse these files and build a database. The <i>clients</i> are the machines that will actually play the music (e.g. your phone or your laptop). They will also run MPD instances, though these ones will fetch the database from the <i>server</i> MPD and play the music. You might notice that MPD on the <i>server</i> is not necessary, however it greatly increases the speed to list all songs, as the <i>clients</i> MPD will not have to browse all the files remotely.
</p>
<p>Besides, you will need a way for the <i>server</i> to make the music files available to the <i>clients</i>. MPD supports multiple <a rel="nofollow" class="external text" href="https://www.musicpd.org/doc/html/plugins.html#storage-plugins">storage plugins</a> to fetch the music with. For example, if you choose the curl plugin, you will need a <a href="../../en/WebDAV.html" title="WebDAV">WebDAV</a> server on the <i>server</i>.
</p>
<p>Finally, you will need a secure communication tunnel between the <i>server</i> and each <i>client</i>. This is because the protocol used to control MPD is not encrypted and does not provide authentication. A <a href="../../en/Category:Virtual_Private_Network.html" class="mw-redirect" title="VPN">VPN</a> or a SSH tunnel will be useful here.
</p>
<h3><span class="mw-headline" id="Configuration_2">Configuration</span></h3>
<p>On the <i>server</i>, write the configuration file for the MPD instance that will build the database:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pid_file            "/run/mpd/mpd.pid"
playlist_directory  "/var/lib/mpd/playlists"
music_directory     "/path/to/your/music/"

database {
    plugin           "simple"
    path             "/var/lib/mpd/mpd.db"
    cache_directory  "/var/lib/mpd/cache"
}

audio_output {
    type  "null"
    name  "<i>This server does not need to play music, but it can</i>"
}
</pre>
<p>Then, setup either the <a href="../../en/WebDAV.html" title="WebDAV">WebDAV</a> server, the <a href="../../en/NFS.html" title="NFS">NFS</a> server or the <a href="../../en/Samba.html" title="Samba">Samba</a> share.
</p>
<p>On each <i>client</i>, write the configuration file for the MPD instance that will play the music:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pid_file            "/run/mpd/mpd.pid"
playlist_directory  "/var/lib/mpd/playlists"

# WebDAV setup
music_directory     "https://<i>optional_user:optional_password@example.com/path/to/your/music/</i>"

# NFS setup
music_directory     "nfs://<i>example.com/path/to/your/music/</i>"

# Samba setup
music_directory     "smb://<i>example.com/path/to/your/music/</i>"

# Note the proxy here
database {
    plugin  "proxy"
    host    "<i>example.com</i>"
    port    "6600"
}

audio_output {
    type  "alsa"
    name  "<i>Some output name</i>"
}
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> On Android the configuration file needs to be at the root of the user storage, alongside the <code>Android</code> folder. Also, files MPD writes to need to lie in the application folder, generally in <code>/data</code>. For example:
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/storage/emulated/0/mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">music_directory  "http://<i>example.com/Music</i>"
log_file         "/data/user/0/org.musicpd/cache/log"
state_file       "/data/user/0/org.musicpd/cache/state"

audio_output {
    type  "sles"
    name  "<i>Android only supports OpenSL ES</i>"
}
</pre>
</div>
<h2><span class="mw-headline" id="MPRIS_support">MPRIS support</span></h2>
<p>See also <a href="../../en/MPRIS.html" title="MPRIS">MPRIS</a>.
</p>
<h3><span class="mw-headline" id="mpDris2">mpDris2</span></h3>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mpDris2/">mpDris2</a></span><sup><small>AUR</small></sup> package. It runs in the user session and monitors the mpd server.
</p>
<p>Copy the default configuration file from <code>/usr/share/doc/mpdris2/mpDris2.conf</code> to <code>~/.config/mpDris2/mpDris2.conf</code>. Edit it as needed.
</p>
<p>mpDris2 has a <code>.desktop</code> file, but it will not show up by default. You can set this to autostart at login. If your desktop environment cannot do this, you can set it manually by making a symlink in <code>~/.config/autostart/</code>
</p>
<pre>$ ln -s /usr/share/applications/mpdris2.desktop ~/.config/autostart/
</pre>
<p>It should now be autorun at login.
</p>
<h3><span class="mw-headline" id="mpd-mpris">mpd-mpris</span></h3>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mpd-mpris/">mpd-mpris</a></span><sup><small>AUR</small></sup> package.
</p>
<p>After installation, you can start or enable the <code>mpd-mpris.service</code> user service through <a href="../../en/Systemd.html" title="Systemd">systemd</a>.
</p>
<p>By default mpd-mpris connects to <code>localhost:6600</code> (which is the default host/port of <a href="../../en/Music_Player_Daemon.html" class="mw-redirect" title="Mpd">mpd</a>). To change this settings copy <code>/usr/lib/systemd/user/mpd-mpris.service</code> to <code>~/.config/systemd/user/</code> then edit run parameters as needed.
</p>
<h2><span class="mw-headline" id="Notifications">Notifications</span></h2>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mpDris2/">mpDris2</a></span><sup><small>AUR</small></sup> package optionally supports displaying graphical notifications.
If you do not want <a rel="nofollow" class="external text" href="https://specifications.freedesktop.org/mpris-spec/latest/">mpris</a> support and are looking for a more <i>lightweight</i> or <i>specific</i> option, here are some alternatives:
</p>
<h3><span class="mw-headline" id="musnify-mpd">musnify-mpd</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/felipemarinho97/musnify-mpd">musnify-mpd</a> is a simple <a href="../../en/Python.html" title="Python">python</a> script that provides notification support for <a href="../../en/Music_Player_Daemon.html" title="Music Player Daemon">Music Player Daemon</a> using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libnotify">libnotify</a></span>.
It can also display the album covers loaded from <i>last fm</i> or load it from the user-local music library.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/musnify-mpd/">musnify-mpd</a></span><sup><small>AUR</small></sup> is available from the <a href="../../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>.
</p>
<p>After installation you may want to configure your mpd <b>host</b> and <b>port</b>. To do this copy the ".example" file into <code>~/.config/musnify-mpd</code>
</p>
<pre>$ mkdir ~/.config/musnify-mpd 
$ cp /usr/share/doc/musnify-mpd/musnify-mpdconfig.example ~/.config/musnify-mpd/musnify-mpd.config
</pre>
<p>Example configuration:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/musnify-mpd/musnify-mpd.config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[mpd]
host = localhost
port = 6600

# This is where musnify-mpd will look for when searching the local album covers.
musiclibrary = ~/Music
#

[apiKey]
# If you want to fetch the album covers from LastFm,
# enable this option and provide a apiKey.
# You can get your apiKey here: <a rel="nofollow" class="external free" href="https://www.last.fm/api/account/create">https://www.last.fm/api/account/create</a>
#
# lastfm = YOUR_LASTFM_API_KEY</pre>
<p>To enable artworks from last.fm, you will need to edit <code>~/.config/musnify-mpd</code> and provide a apiKey. You can create your apiKey <a rel="nofollow" class="external text" href="https://www.last.fm/api/account/create">here</a>
</p>
<h3><span class="mw-headline" id="mpd-notification">mpd-notification</span></h3>
<p>Notify about tracks played by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mpd">mpd</a></span>. This runs in the background and produces notifications whenever mpd produces an event (e.g. new track is played, playback paused or stopped). This also supports local or <code>.mp3</code> album artworks.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mpd-notification/">mpd-notification</a></span><sup><small>AUR</small></sup> is available from <a href="../../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>.
</p>
<p>After installation, just run <code>mpd-notification</code> to run it once. A <a href="../../en/Systemd.html" title="Systemd">systemd</a> user service can be enabled with 
</p>
<pre>$ systemctl --user enable mpd-notification
</pre>
<h2>
<span id="Adding_a_separate_volume_control_.28ALSA.29"></span><span class="mw-headline" id="Adding_a_separate_volume_control_(ALSA)">Adding a separate volume control (ALSA)</span>
</h2>
<p>While MPD does not allow you to adjust its own volume by default (<code>mpc volume</code> affects global volume), you can easily make a MPD-specific volume slider using the <i>softvol</i> <a href="../../en/Advanced_Linux_Sound_Architecture.html" class="mw-redirect" title="ALSA">ALSA</a> module.  Just add this to <code>asound.conf</code>:
</p>
<pre>pcm.mpd {
    type softvol
    slave.pcm "default"
    control.name "MPD Playback Volume"
    control.card 0
}
</pre>
<p>And link it to MPD:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">audio_output {
    type "alsa"
    name "ALSA"
    device "mpd"
    mixer_control "MPD"
}
</pre>
<p>Afterwards you should be able to adjust song volume both through <code>mpc</code> and <code>amixer</code>.  (You may need to reboot for the control to work properly.)
</p>
<h2><span class="mw-headline" id="Control_the_remote_mpd_server">Control the remote mpd server</span></h2>
<p>To control the remote mpd server, if you have an ssh server on the same machine, you can login and use <a href="../../en/Ncmpcpp.html" title="Ncmpcpp">ncmpcpp</a> to control it.
</p>
<p>Or, if your mpd server is listening on an accessible interface/port (<code>$ ss -p -l -t</code> on the mpd machine will show mpd listening on 0.0.0.0, for example) then you can set the MPD_HOST variable which directs a local client like mpc to the remote server.
</p>
<pre>$ export MPD_HOST=ip.of.server
$ export MPD_PORT=6600      # optional
$ mpc play
</pre>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:Music.html" title="Category:Music">Music</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Music_Player_Daemon/Tips_and_tricks&amp;oldid=645621">https://wiki.archlinux.org/index.php?title=Music_Player_Daemon/Tips_and_tricks&amp;oldid=645621</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 December 2020, at 16:01.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>

<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Archiso (Nederlands) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Archiso_Nederlands rootpage-Archiso_Nederlands skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Archiso (Nederlands)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#WORK_in_progress"><span class="tocnumber">1</span> <span class="toctext">WORK in progress</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Wat_is_het?"><span class="tocnumber">2</span> <span class="toctext">Wat is het?</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#De_meest_kale_Arch_Linux_live_media_bouwen."><span class="tocnumber">3</span> <span class="toctext">De meest kale Arch Linux live media bouwen.</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algemene_(handmatig)"><span class="tocnumber">4</span> <span class="toctext">Algemene (handmatig)</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Make_a_booteable_%22pendrive%22_that_have_more_things_than_%22Arch_Linux%22"><span class="tocnumber">5</span> <span class="toctext">Make a booteable "pendrive" that have more things than "Arch Linux"</span></a></li>
<li class="toclevel-1 tocsection-6">
<a href="#Configure_our_live_medium"><span class="tocnumber">6</span> <span class="toctext">Configure our live medium</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#mkinitcpio.conf"><span class="tocnumber">6.1</span> <span class="toctext">mkinitcpio.conf</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#packages.list"><span class="tocnumber">6.2</span> <span class="toctext">packages.list</span></a></li>
<li class="toclevel-2 tocsection-9">
<a href="#aitab"><span class="tocnumber">6.3</span> <span class="toctext">aitab</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Boot_Loader"><span class="tocnumber">6.3.1</span> <span class="toctext">Boot Loader</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Adding_a_fstab"><span class="tocnumber">6.3.2</span> <span class="toctext">Adding a fstab</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Finishing_the_root-image"><span class="tocnumber">6.3.3</span> <span class="toctext">Finishing the root-image</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="WORK_in_progress">WORK in progress</span></h2>
<h2>
<span id="Wat_is_het.3F"></span><span class="mw-headline" id="Wat_is_het?">Wat is het?</span>
</h2>
<p><b>Archiso</b> is een aantal bash scripts dat in staat is om een volledig functionerend op <b>Arch Linux</b> gebaseerde live CD/DCD en USB <b>images</b> te maken. Het is een erg basale tool en kan dus worden gebruikt voor herstell CDs, installatie CDs of live CD/DVD/USB voor een specifieke doelgroep. En wie weet wat nog meer. Simpelweg gezegd, het gaat hier over Arch op een mooie zilveren onderzetter.
Hart en ziel van Archiso is <b>mkarchiso</b>. Alle opties zijn gedocumenteerd in de help output, dus direct gebruik van dit bestand zal hier niet worden besproken. Echter, deze wiki artikel zal dienen als een gids om uw eigen live media uit te rollen in een zeer korte tijd!
</p>
<p>Door recente aanpassingen zal <b>Archiso</b> nu automatisch ISO images creeeren die ook dienen als USB images! Seperate CD/USB doelen zijn daardoor niet meer nodig.
</p>
<h2><span class="mw-headline" id="De_meest_kale_Arch_Linux_live_media_bouwen.">De meest kale Arch Linux live media bouwen.</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Werken in een schone chroot is niet nodig maar wel aangeraden</div>
<ul><li>Installeer devtools indien nodig, mkarchroot heeft dit nodig.</li></ul>
<pre>[host] # pacman -S devtools --needed
</pre>
<ul><li>Creëer een basis chroot om in te werken.</li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> prefix met linux32 als je een 32 bits omgeving wilt bouwen onder 64 bits</div>
<pre>[host] # mkarchroot /tmp/chroot base
</pre>
<ul><li>Installeer archiso onder chroot <b>(AUR methode)</b>
</li></ul>
<p>Halen van: <a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages.php?ID=25996">archiso-git AUR package</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-08-05 ⓘ]</sup>
</p>
<pre>[host] # pacman -U archiso-git-YYYYMMDD-R-any.pkg.tar.xz -r /tmp/chroot
</pre>
<ul><li>Installeer archiso <b>(GIT methode)</b>
</li></ul>
<pre>[host] # pacman -S git make --needed
[host] # git clone <a rel="nofollow" class="external free" href="git://projects.archlinux.org/archiso.git">git://projects.archlinux.org/archiso.git</a>
[host] # make -C archiso/archiso DESTDIR=/tmp/chroot install
</pre>
<ul><li>Chroot betreden.</li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> prefix met linux32 indien nodig</div>
<pre>[host] # mkarchroot -r bash /tmp/chroot
</pre>
<ul><li>Creëer een loopback device.</li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> mkarchroot maakt deze niet. Gebruik een ander cijfer indien niet aanwezig</div>
<pre>[chroot] # mknod /dev/loop0 b 7 0
</pre>
<ul><li>Een mirror instellen</li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Verander MIRROR naar believen</div>
<pre>[chroot] # echo 'Server = MIRROR/archlinux/$repo/os/$arch' &gt;&gt; /etc/pacman.d/mirrorlist
</pre>
<ul><li>Installeer aditionale packages nodig voor archiso <b>(aleen als de GIT methode is gebruikt)</b>
</li></ul>
<pre>[chroot] # pacman -S devtools squashfs-tools syslinux cdrkit
</pre>
<ul><li>Bouw een basis ISO.</li></ul>
<pre>[chroot] # cp -r /usr/share/archiso/configs/baseline /tmp
[chroot] # cd /tmp/baseline
[chroot] # ./build.sh
</pre>
<ul><li>Chroot verlaten.</li></ul>
<pre>[chroot] # exit
</pre>
<p><br>
</p>
<h2>
<span id="Algemene_.28handmatig.29"></span><span class="mw-headline" id="Algemene_(handmatig)">Algemene (handmatig)</span>
</h2>
<ul><li>Een basis bestandssysteem instellen</li></ul>
<pre>mkarchiso -p "base" create work/root-image
</pre>
<ul><li>Syslinux installeren</li></ul>
<pre>mkarchiso -p "syslinux" create work/root-image
</pre>
<ul><li>Andere pakketten installeren (optioneel)</li></ul>
<pre>mkarchiso -p "pkg1 pkg2 pkg3 ... pkgN" create work/root-image.
</pre>
<ul><li>Nu kunt u alles wat u wilt aanpassen aan de root-image.</li></ul>
<pre>mkarchroot -n -r bash work/root-image
</pre>
<ul><li>Initramfs image instellen.</li></ul>
<ul><li><ul><li>Create a config for mkinitcpio <b>mkinitcpio.conf</b>
</li></ul></li></ul>
<pre>HOOKS="base udev archiso sata filesystems"
COMPRESSION="xz"
</pre>
<ul><li><ul><li>Initramfs image genereren.</li></ul></li></ul>
<pre>mkinitcpio -c ./mkinitcpio.conf -b work/root-image -k 2.6.39-ARCH -g work/iso/arch/boot/i686/archiso.img
</pre>
<ul><li>Verplaats kernel naar boot/</li></ul>
<pre>mv work/root-image/boot/vmlinuz26 work/iso/arch/boot/i686
</pre>
<ul><li>Syslinux instellen</li></ul>
<ul><li><ul><li>Een werkmap ervoor aanmaken.</li></ul></li></ul>
<pre> mkdir -p work/iso/arch/boot/syslinux
</pre>
<ul><li><ul><li>Maak een <b>work/iso/arch/boot/syslinux/syslinux.cfg</b> bestand aan.</li></ul></li></ul>
<pre>DEFAULT menu.c32
PROMPT 0
MENU TITLE Arch Linux
TIMEOUT 300

LABEL arch
MENU LABEL Arch Linux
LINUX /arch/boot/i686/vmlinuz26
INITRD /arch/boot/i686/archiso.img
APPEND archisolabel=MY_ARCH

ONTIMEOUT arch
</pre>
<ul><li><ul><li>Kopieëer menu.c32 die nodig is voor de vorige configuratie.</li></ul></li></ul>
<pre>cp work/root-image/usr/lib/syslinux/menu.c32 work/iso/arch/boot/syslinux/
</pre>
<ul><li>isolinux installeren (optioneel, alleen nodig voor een bootable iso)</li></ul>
<pre>mkdir work/iso/isolinux
cp work/root-image/usr/lib/syslinux/isolinux.bin work/iso/isolinux/
</pre>
<ul><li><ul><li>Maak een <b>work/iso/isolinux/isolinux.cfg</b> aan.</li></ul></li></ul>
<pre>DEFAULT loadconfig

LABEL loadconfig
  CONFIG /arch/boot/syslinux/syslinux.cfg
  APPEND /arch/boot/syslinux/
</pre>
<ul><li>Maak een <b>work/arch/aitab</b> bestand aan.</li></ul>
<pre># &lt;img&gt;         &lt;mnt&gt;                 &lt;arch&gt;   &lt;sfs_comp&gt;  &lt;fs_type&gt;  &lt;fs_size&gt;
root-image      /                     i686     xz          ext4       50%
</pre>
<ul><li>Bouw alle bestandssysteem images die gespecificeerd zijn in aitab (.fs .fs.sfs .sfs)</li></ul>
<pre>mkarchiso prepare work
</pre>
<ul><li>Genereer een ISO 9660 met"El Torito" boot image (optioneel)</li></ul>
<pre>mkarchiso -L "MY_ARCH" iso work "my-arch.iso"
</pre>
<h2>
<span id="Make_a_booteable_.22pendrive.22_that_have_more_things_than_.22Arch_Linux.22"></span><span class="mw-headline" id='Make_a_booteable_"pendrive"_that_have_more_things_than_"Arch_Linux"'>Make a booteable "pendrive" that have more things than "Arch Linux"</span>
</h2>
<p>Copy "work/iso/arch" directory to some partition (must be booteable) that you have on the desired medium.
</p>
<pre>cp -r work/iso/arch /mnt/pen1
</pre>
<p>If partition is "vfat" run syslinux and set LABEL.
</p>
<pre>syslinux -i -d /mnt/pen1/arch/boot/syslinux /dev/pen1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Due bug in mmove (from mtools), ldlinux.sys install fails, you can workaround with:</div>
<pre>mv /mnt/pen1/arch/boot/syslinux /mnt/pen1/syslinux
syslinux -i -d /mnt/syslinux /dev/pen1
mv /mnt/pen1/ldlinux.sys /mnt/pen1/syslinux
</pre>
<pre>dosfslabel /dev/pen1 MY_ARCH
</pre>
<p>If partition is ext2/3/4 or btrfs run extlinux and set LABEL.
</p>
<pre>extlinux -i /mnt/pen1/arch/boot/syslinux
e2label /dev/pen1 MY_ARCH
</pre>
<p>Finally install the master boot sector code.
</p>
<pre>cat /usr/lib/syslinux/mbr.bin &gt; /dev/pen
</pre>
<h2><span class="mw-headline" id="Configure_our_live_medium">Configure our live medium</span></h2>
<h3><span class="mw-headline" id="mkinitcpio.conf">mkinitcpio.conf</span></h3>
<p>An <i>initcpio</i> is necessary for creating a system that is able to "wake-up" from a CD/DVD/USB.
</p>
<p>Therefore, you should create a mkinitcpio.conf that holds a list of our hooks:
</p>
<pre>$ vim mkinitcpio.conf
</pre>
<p>A typical set of hooks for archiso looks something like this:
</p>
<pre>HOOKS="base udev memdisk archiso archiso_pxe_nbd archiso_loop_mnt block usb fw pcmcia filesystems usbinput"
</pre>
<p>This list will get you a system that can be booted off a CD/DVD or a USB device. It's worth mentioning that hardware auto-detection and things of that nature do not belong here. Only what's necessary to get the system on its feet, and out of the <i>initcpio</i> really belong here, fancier stuff can be done on the booted system anyway.
</p>
<h3><span class="mw-headline" id="packages.list">packages.list</span></h3>
<p>You'll also want to create a list of packages you want installed on your live CD system. A file full of package names, one-per-line, is the format for this. This is <i><b>great</b></i> for special interest live CDs, just specify packages you want and bake the image.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> You can also create a <b><a href="../en/Pacman/Tips_and_tricks.html#Custom_local_repository" class="mw-redirect" title="Custom local repository">custom local repository</a></b> for the purpose of preparing custom packages or packages from <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>/<a href="../en/Arch_Build_System.html" class="mw-redirect" title="ABS">ABS</a>. Just add your local repository at the first position (for top priority) of your build machine's <b>pacman.conf</b> and you are good to go!</div>
<h3><span class="mw-headline" id="aitab">aitab</span></h3>
<p>The aitab file holds information about the filesystems images that must be created by mkarchiso and mounted at initramfs stage from the archiso hook.
It consists of some fields which define the behaviour of images.
</p>
<pre># &lt;img&gt;         &lt;mnt&gt;                 &lt;arch&gt;   &lt;sfs_comp&gt;  &lt;fs_type&gt;  &lt;fs_size&gt;
</pre>
<dl>
<dt>&lt;img&gt;</dt>
<dd>Image name without extension (.fs .fs.sfs .sfs).</dd>
<dt>&lt;mnt&gt;</dt>
<dd>Mount point.</dd>
<dt>&lt;arch&gt;</dt>
<dd>Architecture { i686 | x86_64 | any }.</dd>
<dt>&lt;sfs_comp&gt;</dt>
<dd>SquashFS compression type { gzip | lzo | xz }. A special value of "none" denotes no usage of SquashFS.</dd>
<dt>&lt;fs_type&gt;</dt>
<dd>Set the filesystem type of the image { ext4 | ext3 | ext2 | xfs }. A special value of "none" denotes no usage of a filesystem. In that case all files are pushed directly to SquashFS filesystem.</dd>
<dt>&lt;fs_size&gt;</dt>
<dd>An absolute value of file system image size in MiB (example: 100, 1000, 4096, etc) A relative value of file system free space [in percent] {1%..99%} (example 50%, 10%, 7%). This is an estimation, and calculated in a simple way. Space used + 10% (estimated for metadata overhead) + desired %</dd>
</dl>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some combinations are invalid. Example both sfs_comp and fs_type are set to none</div>
<h4><span class="mw-headline" id="Boot_Loader">Boot Loader</span></h4>
<pre>DEFAULT menu.c32
PROMPT 0
MENU TITLE Arch Linux
TIMEOUT 300

LABEL arch
MENU LABEL Arch Linux
LINUX /%INSTALL_DIR%/boot/%ARCH%/vmlinuz26
INITRD /%INSTALL_DIR%/boot/%ARCH%/archiso.img
APPEND archisobasedir=%INSTALL_DIR% archisolabel=%ARCHISO_LABEL%

ONTIMEOUT arch
</pre>
<p>Due to the modular nature of isolinux, you are able to use lots of addons since all *.c32 files are copied and available to you. Take a look at the <a rel="nofollow" class="external text" href="http://syslinux.zytor.com/wiki/index.php/SYSLINUX">official syslinux site</a> and the <a rel="nofollow" class="external text" href="https://projects.archlinux.org/archiso.git/tree/configs/syslinux-iso/boot-files">archiso git repo</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-08-05 ⓘ]</sup>. Using said addons, it is possible to make visually attractive and complex menus. See <a rel="nofollow" class="external text" href="http://syslinux.zytor.com/wiki/index.php/Comboot/menu.c32">here</a>.
</p>
<h4><span class="mw-headline" id="Adding_a_fstab">Adding a fstab</span></h4>
<p>It is required to add a <b>fstab</b> file in /etc:
</p>
<pre># &lt;file system&gt;         &lt;dir&gt;  &lt;type&gt;  &lt;options&gt;  &lt;dump&gt;  &lt;pass&gt;
/dev/mapper/root-image  /      auto    defaults   0       0
</pre>
<h4><span class="mw-headline" id="Finishing_the_root-image">Finishing the root-image</span></h4>
<p>Some tips that will not be covered in this article because there are other articles on this wiki that already do:
</p>
<ul>
<li>Adding an user.</li>
<li>Configure an <i>inittab</i> to start into X at boot time</li>
<li>Configure the <i>hosts</i> file</li>
<li>Configure <i>rc.conf</i> (no fancy modules required here)</li>
<li>Configure <i>sudoers</i>
</li>
<li>Configure <i>rc.local</i>
</li>
<li>Put more stuff into etc/skel</li>
<li>Put additional artworks onto the medium</li>
<li>Put arbitrary binary stuff into opt/</li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://projects.archlinux.org/?p=archiso.git;a=summary">Archiso project page</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-08-05 ⓘ]</sup>
</li>
<li><a href="../en/Preboot_Execution_Environment.html" class="mw-redirect" title="Archiso as pxe server">Archiso as pxe server</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Nederlands.html" title="Category:Nederlands">Nederlands</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Archiso_(Nederlands)&amp;oldid=629734">https://wiki.archlinux.org/index.php?title=Archiso_(Nederlands)&amp;oldid=629734</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 5 August 2020, at 08:38.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>

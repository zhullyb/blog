<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>LVM (Česky) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-LVM_Česky rootpage-LVM_Česky skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">LVM (Česky)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%C3%9Avod"><span class="tocnumber">1</span> <span class="toctext">Úvod</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Instalace"><span class="tocnumber">2</span> <span class="toctext">Instalace</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Instalace_Arch_Linuxu_na_LVM"><span class="tocnumber">2.1</span> <span class="toctext">Instalace Arch Linuxu na LVM</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Rozd%C4%9Blen%C3%AD_disk%C5%AF"><span class="tocnumber">2.2</span> <span class="toctext">Rozdělení disků</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Vytvo%C5%99en%C3%AD_fyzick%C3%BDch_za%C5%99%C3%ADzen%C3%AD"><span class="tocnumber">2.3</span> <span class="toctext">Vytvoření fyzických zařízení</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Vytvo%C5%99en%C3%AD_skupin(y)_svazk%C5%AF"><span class="tocnumber">2.4</span> <span class="toctext">Vytvoření skupin(y) svazků</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Vytvo%C5%99en%C3%AD_logick%C3%BDch_svazk%C5%AF"><span class="tocnumber">2.5</span> <span class="toctext">Vytvoření logických svazků</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Vytvo%C5%99en%C3%AD_syst%C3%A9mu_soubor%C5%AF_a_p%C5%99ipojen%C3%AD_logick%C3%A9ho_svazku"><span class="tocnumber">2.6</span> <span class="toctext">Vytvoření systému souborů a připojení logického svazku</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#D%C5%AFle%C5%BEit%C3%A9_informace"><span class="tocnumber">2.7</span> <span class="toctext">Důležité informace</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Nastaven%C3%AD"><span class="tocnumber">3</span> <span class="toctext">Nastavení</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Roz%C5%A1%C3%AD%C5%99en%C3%AD_logick%C3%A9ho_svazku"><span class="tocnumber">3.1</span> <span class="toctext">Rozšíření logického svazku</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Zmen%C5%A1en%C3%AD_logick%C3%A9ho_svazku"><span class="tocnumber">3.2</span> <span class="toctext">Zmenšení logického svazku</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#P%C5%99id%C3%A1n%C3%AD_diskov%C3%A9ho_odd%C3%ADlu_do_skupiny_svazk%C5%AF"><span class="tocnumber">3.3</span> <span class="toctext">Přidání diskového oddílu do skupiny svazků</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Odebr%C3%A1n%C3%AD_diskov%C3%A9ho_odd%C3%ADlu_ze_skupiny_svazk%C5%AF"><span class="tocnumber">3.4</span> <span class="toctext">Odebrání diskového oddílu ze skupiny svazků</span></a></li>
<li class="toclevel-2 tocsection-15">
<a href="#Sn%C3%ADmky"><span class="tocnumber">3.5</span> <span class="toctext">Snímky</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#%C3%9Avod_2"><span class="tocnumber">3.5.1</span> <span class="toctext">Úvod</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Nastaven%C3%AD_2"><span class="tocnumber">3.5.2</span> <span class="toctext">Nastavení</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-18">
<a href="#%C5%98e%C5%A1en%C3%AD_probl%C3%A9m%C5%AF"><span class="tocnumber">4</span> <span class="toctext">Řešení problémů</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#LVM_p%C5%99%C3%ADkazy_nefunguj%C3%AD"><span class="tocnumber">4.1</span> <span class="toctext">LVM příkazy nefungují</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#V%C3%BDpis_nastaven%C3%AD_p%C5%99%C3%ADpojn%C3%BDch_bod%C5%AF_syst%C3%A9mu_soubor%C5%AF_nezobrazuje_logick%C3%A9_svazky"><span class="tocnumber">4.2</span> <span class="toctext">Výpis nastavení přípojných bodů systému souborů nezobrazuje logické svazky</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Tipy_a_triky"><span class="tocnumber">5</span> <span class="toctext">Tipy a triky</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Dal%C5%A1%C3%AD_zdroje"><span class="tocnumber">6</span> <span class="toctext">Další zdroje</span></a></li>
</ul>
</div>

<h1>
<span id=".C3.9Avod"></span><span class="mw-headline" id="Úvod">Úvod</span>
</h1>
<p>LVM je správce logických svazků pro Linux. LVM vytváří abstrakci nad fyzickým úložištěm dat v podobě virtuálních oddílů, které lze snadněji upravovat. Základní termíny při práci s LVM jsou:
</p>
<ul>
<li>
<b>Fyzické zařízení (PV)</b>: je diskový oddíl (celý pevný disk či loopback soubor), na kterém lze vytvářet skupiny svazků. Fyzické zařízení má speciální hlavičku a je dále rozděleno do fyzických bloků. Fyzické oddíly lze chápat jako obdobu fyzických bloků disku.</li>
<li>
<b>Skupina svazků (VG)</b>: je skupina fyzických zařízení použitých jako úložiště, tedy jeden disk. Skupiny svazků obsahují logické svazky. Skupinu svazků lze chápat jako obdobu pevného disku.</li>
<li>
<b>Logické svazky (LV)</b>:  jsou logické či virtuální diskové oddíly, ze kterých se skládá skupina svazků. Tyto logické svazky jsou dále tvořeny fyzickými bloky. Logické svazky lze chápat jako běžné diskové oddíly.</li>
<li>
<b>Fyzický blok (PE)</b>: je malá část disku (obvykle 4 MB), kterou lze přidělit logickému svazku. Fyzické bloky lze chápat jako části disku, které lze přidělit libovolnému diskovému oddílu.</li>
</ul>
<p>Správa logických svazků LVM je snazší, než správa běžných diskových oddílů:
</p>
<ul>
<li>
<i>Libovolný počet</i> pevných disků lze použit jako jeden velký disk (VG).</li>
<li>Diskové oddíly (LV) mohou <i>přesahovat</i> na několik pevných disků. Logický svazek může mít velikost celého diskového úložiště (tj. všech pevných disků v něm).</li>
<li>Je možné <i>libovolně</i> vytářet, rušit a měnit velikost diskových oddílů (LV) a disků (VG). Na umístění logického svazku ve skupině svazků nezáleží tak, jako je tomu s běžnými diskovými oddíly.</li>
<li>Lze měnit vělikost, vytvářet a rušit diskové oddíly (LV) a disky (VG) <i>za běhu</i> systému. Systémy souborů je pak stále nutné zvětšit či zmenšit. Některé z nich toto za běhu také umožňují.</li>
<li>Disky (VG) a diskové oddíly (LV) lze libovolně <i>pojmenovat</i>.</li>
<li>Je možné vytvořit malé diskové oddíly (LV) a ty zvětšovat <i>dynamicky</i> podle míry zaplnění daty. Zvětšení systému souborů musí být stále provedeno ručně. Některé systéstémy souborů toto umožňují za běhu.</li>
<li>...</li>
</ul>
<p>Příklad: 
</p>
<pre><b>Fyzické disky</b>
                
  Disk1 (/dev/sda):
     _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
    |Oddíl1 50 GB (Fyzické zařízení)|Oddíl2 80 GB (Fyzické zařízení)   |
    |/dev/sda1                      |/dev/sda2                         |
    |_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _| _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _|
                                  
  Disk2 (/dev/sdb):
     _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
    |Partition1 120 GB (Fyzické zařízení)            |
    |/dev/sdb1                                       |
    | _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _|
</pre>
<pre><b>LVM logické svazky</b>

  Skupina svazků 1 (/dev/MeUloziste/ = /dev/sda1 + /dev/sda2 + /dev/sdb1):
     _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
    |Logický svazek1 15 GB |Logický svazek2 35 GB     |Logický svazek3 200 GB       |
    |/dev/MeUloziste/root  |/dev/MeUloziste/home      |/dev/MeUloziste/media        |
    |_ _ _ _ _ _ _ _ _ _ _ |_ _ _ _ _ _ _ _ _ _ _ _ _ |_ _ _ _ _ _ _ _ _ _ _ _ _ _ _|
</pre>
<p>Shrnutí: LVM umožňuje použít veškerou kapacitu disků jako jeden velký disk (skupinu svazků) a tuto pak flexibilněji rozdělit mezi oddíly (logické svazky).
</p>
<h1><span class="mw-headline" id="Instalace">Instalace</span></h1>
<p>Nejprve je potřeba načíst příslušný jaderný modul:
</p>
<pre># modprobe dm-mod
</pre>
<p>Pokud už máte Arch Linux nainstalovaný a pouze chcete přidat či vyzkoušet LVM, přeskočte na
<a href="#Rozd%C4%9Blen%C3%AD_disk%C5%AF">rozdělení disků</a>.
</p>
<h4><span class="mw-headline" id="Instalace_Arch_Linuxu_na_LVM">Instalace Arch Linuxu na LVM</span></h4>
<p>Před spuštěním instalačních skritpů Arch Linuxu (/arch/setup), je potřeba rozdělit disk(y) nástrojem  <code>cfdisk</code> (či jiným Vámi oblíbeným). Protože grub legacy (tj. s verzí menší než 1.0) neumí bootovat z logického svazku LVM, nemůžete vytvořit oddíl <code>/boot</code> na LVM. Vytvořte tedy samostatný bootovací oddíl. Za dostatečnou velikost se považuje 100MB. Alternativně můžete použít zavaděč lilo nebo grub 2 (od verze 1.95).
</p>
<h4>
<span id="Rozd.C4.9Blen.C3.AD_disk.C5.AF"></span><span class="mw-headline" id="Rozdělení_disků">Rozdělení disků</span>
</h4>
<p>Dalším krokem je vytvoření diskového oddílu pro LVM. Pro tento oddíl použijte systém souborů typu <i>Linux LVM</i>, tedy id oddílu 0x8e (typ systému souborů: 8e). Na každém disku, kde chcete použít LVM, stačí vytvořit jeden diskový oddíl typu LVM. Ten bude využit pro logické svazky, volte tedy vhodnou velikost. Pokud chcete používat pouze LVM, využijte pro diskový oddíl LVM veškeré volné místo na každém disku.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Lze nastavit, aby se všechny LVM oddíly na všech discích tvářily jako jeden velký disk.</div>
<h4>
<span id="Vytvo.C5.99en.C3.AD_fyzick.C3.BDch_za.C5.99.C3.ADzen.C3.AD"></span><span class="mw-headline" id="Vytvoření_fyzických_zařízení">Vytvoření fyzických zařízení</span>
</h4>
<p>Nyní je třeba inicializovat vytvořené LVM diskové oddíly. Příkazem <code>fdisk -l</code> zjistěte, které diskové oddíly mají typ systému souborů <i>Linux LVM</i> a vytvořte z nich fyzické zařízení LVM:
</p>
<pre># pvcreate /dev/sda2
</pre>
<p>Nahraďte <code>/dev/sda2</code> všemi oddíly, ze kterých chcete vytvořit fyzické zařízení LVM. Tento příkaz vytvoří LVM hlavičku na daných diskových oddílech.
Vytvořená fyzická zařízení můžete sledovat příkazem:
</p>
<pre># pvdisplay
</pre>
<h4>
<span id="Vytvo.C5.99en.C3.AD_skupin.28y.29_svazk.C5.AF"></span><span class="mw-headline" id="Vytvoření_skupin(y)_svazků">Vytvoření skupin(y) svazků</span>
</h4>
<p>V dalším kroku vytvoříte na fyzickém zařízení skupinu svazků. Nejprve vytvořte skupinu svazků na jednom z nových fyzických zařízení. Poté můžete přidat všechna ostatní fyzická zařízení, která chcete do skupiny svazků zahrnout:
</p>
<pre># vgcreate VolGroup00 /dev/sda2
# vgextend VolGroup00 /dev/sdb1
</pre>
<p>Namísto VolGroup00 můžete použít libovolné jméno skupiny svazků, kterou chcete vytvořit. Růst skupiny svazků můžete sledovat příkazem:
</p>
<pre># vgdisplay
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Pokud chcete, můžete vytvořit více skupin svazků. Celé Vaše datové úložiště se pak však nebude tvářit jako jeden disk.</div>
<h4>
<span id="Vytvo.C5.99en.C3.AD_logick.C3.BDch_svazk.C5.AF"></span><span class="mw-headline" id="Vytvoření_logických_svazků">Vytvoření logických svazků</span>
</h4>
<p>Nyní nastal čas vytvořit ve skupině svazků logické svazky. Toho dosáhnete spuštěním následujícího příkazu, ve kterém určujete jméno nového logického svazku, jeho velikost a skupinu svazků, ve které má být vytvořen:
</p>
<pre># lvcreate -L 10G VolGroup00 -n lvolhome
</pre>
<p>Dojde k vytvoření logického svazku, ke kterému můžete přistupovat jako k <code>/dev/mapper/Volgroup00-lvolhome</code> nebo <code>/dev/VolGroup00/lvolhome</code>. Stejně jako při vytváření skupiny svazků i pro logický svazek můžete použít libovolné jméno.
</p>
<p>Při vytváření oddílu swap na logickém svazku použijte následující příkaz:
</p>
<pre># lvcreate -C y -L 10G VolGroup00 -n lvolswap
</pre>
<p>Parametr <code>-C y</code> určuje, že má být vytvořen souvislý oddíl. To znamená, že se swap oddíl nerozdrobí mezi více disků, či několik nesouvislých fyzických bloků.
</p>
<p>Pokud chcete vyplnit vytvářeným logickým svazkem zbytek místa ve skupině svazků, použijte následující příkaz:
</p>
<pre># lvcreate -l +100%FREE VolGroup00 -n lvolmedia
</pre>
<p>Logické svazky můžete sledovat příkazem:
</p>
<pre># lvdisplay
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Pro funkčnost předchozích příkazů může být pořeba načíst modul <i>device-mapper</i>.  Toho docílíte příkazem <b>modprobe dm-mod</b>.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Pro začátek můžete vytvořit relativně malé logické svazky a ty rozšiřovat až podle potřeby. Jednoduše nechte ve skupině svazků volné místo.</div>
<h4>
<span id="Vytvo.C5.99en.C3.AD_syst.C3.A9mu_soubor.C5.AF_a_p.C5.99ipojen.C3.AD_logick.C3.A9ho_svazku"></span><span class="mw-headline" id="Vytvoření_systému_souborů_a_připojení_logického_svazku">Vytvoření systému souborů a připojení logického svazku</span>
</h4>
<p>Vytvořené logické svazky najdete ve složce <code>/dev/mapper/</code> a <code>/dev/YourVolumeGroupName</code>. Pokud je nemůžete najít, použijte následující příkazy pro zavedení modulu vytváření uzlů zařízení a pro aktivaci skupin svazků:
</p>
<pre># modprobe dm-mod
# vgchange -ay
</pre>
<p>Nyní můžete na logických svazcích vytvořit systémy souborů. Poté už jen připojíte logické svazky jako běžné diskové oddíly. (Pokud právě instalujete Arch linux, tento krok přeskočte. K připojení logických svazků využijte instalátor, ve kterém vyberte vytvořené LVM oddíly.):
</p>
<pre># mkfs.ext3 /dev/mapper/VolGroup00-lvolhome
# mount /dev/mapper/VolGroup00-lvolhome /home
</pre>
<p>Pokud instalujete Arch Linux, spusťte /arch/setup, vyberte volbu <i>Prepare Hard Drive</i> a pak přímo krok 3 <i>Set Filesystem Mountpoints</i> a <i><b>přečtěte si sekci <a href="#D%C5%AFle%C5%BEit%C3%A9_informace">Důležité informace</a> před tím, než budete s instalací systému pokračovat!</b></i>
</p>
<h3>
<span id="D.C5.AFle.C5.BEit.C3.A9_informace"></span><span class="mw-headline" id="Důležité_informace">Důležité informace</span>
</h3>
<p>Při používání Arch Linuxu s LVM, či instalaci na LVM dbejte na následující (v závorkách jsou uvedena odpovídající menu instalátoru):
</p>
<ul>
<li>Při výběru přípojných bodů vybírejte pouze nově vytvořené logické svazky (použijte: <code>/dev/mapper/Volgroup00-lvolhome</code>).<br>NEVYBÍREJTE skutečné oddíly,  na kterých jsou logické svazky vytvořeny. Tedy nepoužívejte: <code>/dev/sda2</code>. (<i>Set Filesystem Mountpoints</i>)</li>
<li>Změňte volbu <i>USELVM="no"</i> na <i>USELVM="yes"</i> v souboru <code>/etc/rc.conf</code>.  (<i>Configure System</i>)</li>
<li>Přidejte <i>lvm2</i> do sekce HOOKS v souboru <code>/etc/mkinitcpio.conf</code> těsně před <i>filesystems</i>, aby kernel dokázal najít LVM oddíly při bootu. Pokud chcete využívat LVM snímky, přidejte <i>dm-snapshot</i> do proměnné MODULES. (<i>Configure System</i>)</li>
<li>Pokud jste na logický svazek umístili i systém souborů kořenového adresáře ( "/" ), znovu sestavte obraz kernelu (<i>/boot/kernel26.img</i>) s využitím upraveného souboru <code>/etc/mkinitcpio.conf</code>. Tím umožníte zavaděči nalezení oddílu root při bootu. Využijte k tomu níže uvedený příkaz: (<i>Configure System</i>)</li>
</ul>
<pre>     mkinitcpio -g /boot/kernel26.img 
</pre>
<ul><li>V konfiguračním systému zavaděče grub: <code>/boot/grub/menu.lst</code> použijte správný oddíl pro root, například: (<i>Install Bootloader</i>)</li></ul>
<pre>     ...
     (0) Arch Linux
     title  Arch Linux
     root   (hd0,0)
     kernel /vmlinuz26 <b>root=/dev/mapper/VolGroup00-lvolroot</b> resume=/dev/mapper/VolGroup00-lvolswap ro
     initrd /kernel26.img
     ...
</pre>
<ul><li>Pokud používáte LILO nastavte ho obdobně: <code>/etc/lilo.conf</code>:</li></ul>
<pre>     image=/boot/vmlinuz26
       label=arch
       append="<b>root=/dev/mapper/VolGroup00-lvolroot</b> resume=/dev/mapper/VolGroup00-lvolswap ro"
       initrd=/boot/kernel26.img
</pre>
<h1>
<span id="Nastaven.C3.AD"></span><span class="mw-headline" id="Nastavení">Nastavení</span>
</h1>
<h2>
<span id="Roz.C5.A1.C3.AD.C5.99en.C3.AD_logick.C3.A9ho_svazku"></span><span class="mw-headline" id="Rozšíření_logického_svazku">Rozšíření logického svazku</span>
</h2>
<p>Nejprve je třeba zvětšit logický svazek a pak ještě zbývá zvětšit systém souborů, aby využil nově vytvořené místo. Řekněme, že máme logický svazek o velikosti 15 GB, na kterém je systém souborů ext3. Tento chceme zvětšit na 20 GB. Musíme tedy udělat následující: 
</p>
<pre># lvextend -L 20G VolGroup00/lvolhome
# resize2fs /dev/VolGroup00/lvolhome
</pre>
<p>Lze také využít příkaz <code>lvresize</code> namísto <code>lvextend</code>:
</p>
<pre># lvresize -L +5G VolGroup00/lvolhome
</pre>
<p>Pokud chcete vyplnit veškeré zbývající volné místo ve skupině svazků, použijte následující příkaz:
</p>
<pre># lvextend -l +100%FREE VolGroup00/lvolhome
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Ne všechny souborové systémy podporují zvětšení beze ztráty dat, či zvětšení za běhu.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Pokud nezvětšíte systém souborů, bude jemu odpovídající oddíl stále stejně velký. Logický svazek pak bude mít novou velikost a bude částečně nevyužitý.</div>
<h2>
<span id="Zmen.C5.A1en.C3.AD_logick.C3.A9ho_svazku"></span><span class="mw-headline" id="Zmenšení_logického_svazku">Zmenšení logického svazku</span>
</h2>
<p>Protože nejspíše máte systém souborů tak velký jako logický svazek, na kterém je umístěn, je nejprve nutné zmenšit systém souborů. Podle toho, jaký systém souborů používáte, může být nejprve nutné systém souborů odpojit. Řekněme, že máme logický svazek o velikosti 15 GB, na kterém je systém souborů ext3. Tento svazek chceme zmenšit na 10 GB. Musíme tedy udělat následující:
</p>
<pre># resize2fs /dev/VolGroup00/lvolhome 9G
# lvreduce -L 10G VolGroup00/lvolhome
# resize2fs /dev/VolGroup00/lvolhome
</pre>
<p>Lze také využít příkaz <code>lvresize</code> namísto <code>lvreduce</code>:
</p>
<pre># lvresize -L -5G VolGroup00/lvolhome
</pre>
<p>V příkladě jsme zmenšili systém souborů více, než bylo potřeba. Učinili jsme tak proto, abychom náhodně nesmazali některé z posledních bloků systému souborů. Zbývá tedy ještě zvětšit systém souborů tak, aby vyplnil zbývající místo na logickém svazku. 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Zmenšujte systém souborů pouze o tolik, aby zbylo dost místa pro uložená data.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Ne všechny systémy souborů umožňují zmenšení beze ztráty dat, či zmenšení za běhu.</div>
<h2>
<span id="P.C5.99id.C3.A1n.C3.AD_diskov.C3.A9ho_odd.C3.ADlu_do_skupiny_svazk.C5.AF"></span><span class="mw-headline" id="Přidání_diskového_oddílu_do_skupiny_svazků">Přidání diskového oddílu do skupiny svazků</span>
</h2>
<p>Aby bylo možné přidat oddíl do skupiny svazků, musíte nejprve změnit jeho typ na <i>Linux LVM</i> (například nástrojem <code>cfdisk</code>). Poté zbývá ještě vytvořit z oddílu fyzické zařízení a rozšířit o něj skupinu svazků:
</p>
<pre># pvcreate /dev/sdb1
# vgextend VolGroup00 /dev/sdb1
</pre>
<p>Tím jste získali volné místo ve skupině svazků, které může být využito logickými svazky.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Přidané diskové oddíly se mohou nacházet na libovolných discích.</div>
<h2>
<span id="Odebr.C3.A1n.C3.AD_diskov.C3.A9ho_odd.C3.ADlu_ze_skupiny_svazk.C5.AF"></span><span class="mw-headline" id="Odebrání_diskového_oddílu_ze_skupiny_svazků">Odebrání diskového oddílu ze skupiny svazků</span>
</h2>
<p>Při odebírání diskového oddílu ze skupiny svazků je potřeba přesunout všechna data, která se na něm nachází, na jiný diskový oddíl. LVM toto umožňuje následovně:
</p>
<pre># pvmove /dev/sdb1
</pre>
<p>Pokud chete přesunout data na určité fyzické zařízení, použijte následující příkaz:
</p>
<pre># pvmove /dev/sdb1 /dev/sdf1
</pre>
<p>Poté můžete odebrat fyzické zařízení ze skupiny oddílů:
</p>
<pre># vgreduce myVg /dev/sdb1
</pre>
<p>Nebo také můžete odstranit všechna prázdná fyzická zařízení:
</p>
<pre># vgreduce --all vg0
</pre>
<p>Konečně, pokud chcete využívat diskový oddíl pro jiné učely, a zabránit tomu, aby byl chápán jako fyzické zařízení LVM, použijte následující příkaz:
</p>
<pre># pvremove /dev/sdb1
</pre>
<h2>
<span id="Sn.C3.ADmky"></span><span class="mw-headline" id="Snímky">Snímky</span>
</h2>
<h4>
<span id=".C3.9Avod_2"></span><span class="mw-headline" id="Úvod_2">Úvod</span>
</h4>
<p>LVM umožuje efektivnější vytvářní snímků systému, než klasické metody zálohování. Pro tento účel používá techniku kopírování při zápisu. Na počátku obsahuje snímek pouze pevné odkazy na inody skutečných dat. Dokud zůstávají data nezměněna, snímek tedy pouze obsahuje odkazy inodů a nikoliv samotná data. V okamžiku, kdy změníte soubor (či adresář), na který snímek odkazuje, LVM automaticky naklonuje data tak, že snímek odkazuje na starou kopii a aktivní systém souborů odkazuje na novou. Takto je možné vytvořit snímek 35 GB dat, který využije jen 2 GB prostoru navíc, pokud tedy nezměníte více jak 2 GB původních dat (či dat ve snímku).
</p>
<h4>
<span id="Nastaven.C3.AD_2"></span><span class="mw-headline" id="Nastavení_2">Nastavení</span>
</h4>
<p>Snímek logického svazku vytvoříte obdobně jako samotný logický svazek:
</p>
<pre># lvcreate --size 100M --snapshot --name snap01 /dev/mapper/vg0-pv
</pre>
<p>Takto můžete změnit méně než 100 MB dat, než se svazek snímku zaplní.
</p>
<p>Aby systém nabootoval, je potřeba mít v proměnné MODULES souboru <code>/etc/mkinitcpio.conf</code> uveden  modul <i>dm-snapshot</i>. Pokud toto provedete na již používaném systému, nezapomeňte přegenerovat obraz jádra:
</p>
<pre># mkinitcpio -g /boot/kernel26.img
</pre>
<p>TODO: Skripty automatizující snímky kořenového systému souborů před updatováním systému, což umožní pozdější návrat k předchozímu stavu. Úprava <code>menu.lst</code>, aby šlo bootovat snímky (samostatný článek?).
</p>
<p>Primárním účelem snímku je poskytnout zmraženou kopii systému souborů pro účel zálohování. Obzvláště pro dlouhoběžící zálohovací úlohy tak lze dosáhnout mnohem konzistentnějšího obrazu systému souborů, než při přímém zálohování diskového oddílu.
</p>
<h1>
<span id=".C5.98e.C5.A1en.C3.AD_probl.C3.A9m.C5.AF"></span><span class="mw-headline" id="Řešení_problémů">Řešení problémů</span>
</h1>
<h4>
<span id="LVM_p.C5.99.C3.ADkazy_nefunguj.C3.AD"></span><span class="mw-headline" id="LVM_příkazy_nefungují">LVM příkazy nefungují</span>
</h4>
<ul><li>Načtěte správný jaderný modul:</li></ul>
<pre># modprobe dm-mod
</pre>
<ul><li>Zkuste předcházet příkazy slovem <i>lvm</i> následovně:</li></ul>
<pre># lvm pvdisplay
</pre>
<h4>
<span id="V.C3.BDpis_nastaven.C3.AD_p.C5.99.C3.ADpojn.C3.BDch_bod.C5.AF_syst.C3.A9mu_soubor.C5.AF_nezobrazuje_logick.C3.A9_svazky"></span><span class="mw-headline" id="Výpis_nastavení_přípojných_bodů_systému_souborů_nezobrazuje_logické_svazky">Výpis nastavení přípojných bodů systému souborů nezobrazuje logické svazky</span>
</h4>
<p>Pokud instalujete systém někam, kde už existuje LVM skupina svazků, může se stát, že i po vykonání příkazu <code>modprobe dm-mod</code> nepůjde zobrazit seznam logických svazků.
</p>
<p>V takovém případě musíte ještě spustit příkaz:
</p>
<pre># vgchange -ay &lt;skupina svazků&gt;
</pre>
<p>Takto aktivujete skupinu svazků a zpřístupníte logické svazky.
</p>
<h1><span class="mw-headline" id="Tipy_a_triky">Tipy a triky</span></h1>
<p>TODO:
</p>
<h1>
<span id="Dal.C5.A1.C3.AD_zdroje"></span><span class="mw-headline" id="Další_zdroje">Další zdroje</span>
</h1>
<p>Další články týkající se LVM na Archwiki:
</p>
<ul>
<li><a href="../en/LVM_on_software_RAID.html" class="mw-redirect" title="Installing with Software RAID or LVM">Installing with software RAID or LVM</a></li>
<li><a href="../en/Dm-crypt.html" class="mw-redirect" title="RAID Encryption LVM">RAID encryption LVM</a></li>
</ul>
<p>Externí zdroje:
</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Logical_Volume_Manager_(Linux)" class="extiw" title="wikipedia:Logical Volume Manager (Linux)">LVM na Wikipedii (anglicky)</a></li>
<li><a rel="nofollow" class="external text" href="https://tldp.org/HOWTO/LVM-HOWTO/">LVM HOWTO na tldp.org (anglicky)</a></li>
<li><a rel="nofollow" class="external text" href="http://wiki.gentoo.org/wiki/LVM">LVM na wiki.gentoo.org (anglicky)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.joshbryan.com/blog/2008/01/02/lvm2-mirrors-vs-md-raid-1">LVM2 zrcadlení vs. MD raid 1 (anglicky)</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../cs/Category:Installation_process.html" title="Category:Installation process (Česky)">Installation process (Česky)</a></li>
<li><a href="../cs/Category:File_systems.html" title="Category:File systems (Česky)">File systems (Česky)</a></li>
</ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=LVM_(%C4%8Cesky)&amp;oldid=631276">https://wiki.archlinux.org/index.php?title=LVM_(Česky)&amp;oldid=631276</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 12 August 2020, at 06:53.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>

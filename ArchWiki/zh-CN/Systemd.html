<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>systemd (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Systemd_简体中文 rootpage-Systemd_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">systemd (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><span></span>
</p>
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../zh-CN/a87ea26bff3744e8b00320e027759a76.html" class="mw-redirect" title="Systemd/User (简体中文)">systemd/User (简体中文)</a></li>
<li><a href="../zh-CN/ac55e32d4dfdaeb996fb6e2ed9ab24e5.html" class="mw-redirect" title="Systemd/Timers (简体中文)">systemd/Timers (简体中文)</a></li>
<li><a href="../zh-CN/61459eb94c08a3c4c4402301dc7b793b.html" class="mw-redirect" title="Systemd/Journal (简体中文)">systemd/Journal (简体中文)</a></li>
<li><a href="../zh-CN/059bfdbeae50ac50d57704f5575af336.html" class="mw-redirect" title="Systemd FAQ (简体中文)">Systemd FAQ (简体中文)</a></li>
<li><a href="../en/Daemons.html#List_of_deamons" title="Daemons">Daemons#List of deamons</a></li>
<sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>
<li><a href="../zh-CN/Udev.html" title="Udev (简体中文)">udev (简体中文)</a></li>
<li><a href="../zh-CN/6d9695d7cc01d6e70cbdedb13033d4b2.html" class="mw-redirect" title="Improve Boot Performance (简体中文)">Improve Boot Performance (简体中文)</a></li>
<li><a href="../en/Allow_users_to_shutdown.html" title="Allow users to shutdown">Allow users to shutdown</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Systemd.html" title="Systemd">Systemd</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2019-01-29。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Systemd&amp;diff=0&amp;oldid=564454">更改</a>，则您可以帮助同步翻译。</div>
<p>摘自<a rel="nofollow" class="external text" href="https://freedesktop.org/wiki/Software/systemd">项目主页</a>：
</p>
<dl><dd>
<i>systemd</i> 是一个 Linux 系统基础组件的集合，提供了一个系统和服务管理器，运行为 PID 1 并负责启动其它程序。功能包括：支持并行化任务；同时采用 socket 式与 <a href="../zh-CN/D-Bus.html" title="D-Bus (简体中文)">D-Bus</a> 总线式激活服务；按需启动守护进程（daemon）；利用 Linux 的 <a href="../en/Cgroups.html" title="Cgroups">cgroups</a> 监视进程；支持快照和系统恢复；维护挂载点和自动挂载点；各服务间基于依赖关系进行精密控制。<i>systemd</i> 支持 SysV 和 LSB 初始脚本，可以替代 sysvinit。除此之外，功能还包括日志进程、控制基础系统配置，维护登陆用户列表以及系统账户、运行时目录和设置，可以运行容器和虚拟机，可以简单的管理网络配置、网络时间同步、日志转发和名称解析等。</dd></dl>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1149530#p1149530">Arch Linux 论坛的这篇帖子</a> 详细地解释了 Arch Linux 迁移到 systemd 的原因。</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#systemd_%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7"><span class="tocnumber">1</span> <span class="toctext">systemd 基本工具</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%E7%8A%B6%E6%80%81"><span class="tocnumber">1.1</span> <span class="toctext">分析系统状态</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#%E4%BD%BF%E7%94%A8%E5%8D%95%E5%85%83"><span class="tocnumber">1.2</span> <span class="toctext">使用单元</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86"><span class="tocnumber">1.3</span> <span class="toctext">电源管理</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5">
<a href="#%E7%BC%96%E5%86%99%E5%8D%95%E5%85%83%E6%96%87%E4%BB%B6"><span class="tocnumber">2</span> <span class="toctext">编写单元文件</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#%E5%A4%84%E7%90%86%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="tocnumber">2.1</span> <span class="toctext">处理依赖关系</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B"><span class="tocnumber">2.2</span> <span class="toctext">服务类型</span></a></li>
<li class="toclevel-2 tocsection-8">
<a href="#%E4%BF%AE%E6%94%B9%E7%8E%B0%E5%AD%98%E5%8D%95%E5%85%83%E6%96%87%E4%BB%B6"><span class="tocnumber">2.3</span> <span class="toctext">修改现存单元文件</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#%E6%9B%BF%E6%8D%A2%E5%8D%95%E5%85%83%E6%96%87%E4%BB%B6"><span class="tocnumber">2.3.1</span> <span class="toctext">替换单元文件</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#%E9%99%84%E5%8A%A0%E9%85%8D%E7%BD%AE%E7%89%87%E6%AE%B5"><span class="tocnumber">2.3.2</span> <span class="toctext">附加配置片段</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#%E9%87%8D%E7%BD%AE%E5%88%B0%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%89%88%E6%9C%AC"><span class="tocnumber">2.3.3</span> <span class="toctext">重置到软件包版本</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#%E7%A4%BA%E4%BE%8B"><span class="tocnumber">2.3.4</span> <span class="toctext">示例</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#%E7%9B%AE%E6%A0%87%EF%BC%88target%EF%BC%89"><span class="tocnumber">3</span> <span class="toctext">目标（target）</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E6%A0%87"><span class="tocnumber">3.1</span> <span class="toctext">获取当前目标</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E6%A0%87"><span class="tocnumber">3.2</span> <span class="toctext">创建自定义目标</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#%22SysV_%E8%BF%90%E8%A1%8C%E7%BA%A7%E5%88%AB%22_%E4%B8%8E_%22systemd_%E7%9B%AE%E6%A0%87%22_%E5%AF%B9%E7%85%A7%E8%A1%A8"><span class="tocnumber">3.3</span> <span class="toctext">"SysV 运行级别" 与 "systemd 目标" 对照表</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%E5%88%87%E6%8D%A2%E5%BD%93%E5%89%8D%E8%BF%90%E8%A1%8C%E7%9B%AE%E6%A0%87"><span class="tocnumber">3.4</span> <span class="toctext">切换当前运行目标</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E6%9B%B4%E6%94%B9%E5%BC%80%E6%9C%BA%E9%BB%98%E8%AE%A4%E5%90%AF%E5%8A%A8%E7%9B%AE%E6%A0%87"><span class="tocnumber">3.5</span> <span class="toctext">更改开机默认启动目标</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#%E9%BB%98%E8%AE%A4%E7%9B%AE%E6%A0%87%E9%A1%BA%E5%BA%8F"><span class="tocnumber">3.6</span> <span class="toctext">默认目标顺序</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20"><a href="#%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6"><span class="tocnumber">4</span> <span class="toctext">临时文件</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="tocnumber">5</span> <span class="toctext">定时器</span></a></li>
<li class="toclevel-1 tocsection-22">
<a href="#%E6%8C%82%E8%BD%BD"><span class="tocnumber">6</span> <span class="toctext">挂载</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#GPT_%E5%88%86%E5%8C%BA%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD"><span class="tocnumber">6.1</span> <span class="toctext">GPT 分区自动挂载</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24">
<a href="#Tips_and_tricks"><span class="tocnumber">7</span> <span class="toctext">Tips and tricks</span></a>
<ul>
<li class="toclevel-2 tocsection-25"><a href="#Running_services_after_the_network_is_up"><span class="tocnumber">7.1</span> <span class="toctext">Running services after the network is up</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Enable_installed_units_by_default"><span class="tocnumber">7.2</span> <span class="toctext">Enable installed units by default</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Sandboxing_application_environments"><span class="tocnumber">7.3</span> <span class="toctext">Sandboxing application environments</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28">
<a href="#%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94"><span class="tocnumber">8</span> <span class="toctext">疑难解答</span></a>
<ul>
<li class="toclevel-2 tocsection-29"><a href="#%E5%AF%BB%E6%89%BE%E9%94%99%E8%AF%AF"><span class="tocnumber">8.1</span> <span class="toctext">寻找错误</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#%E8%AF%8A%E6%96%AD%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98"><span class="tocnumber">8.2</span> <span class="toctext">诊断启动问题</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#%E8%AF%8A%E6%96%AD%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1"><span class="tocnumber">8.3</span> <span class="toctext">诊断一个服务</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#%E5%85%B3%E6%9C%BA/%E9%87%8D%E5%90%AF%E5%8D%81%E5%88%86%E7%BC%93%E6%85%A2"><span class="tocnumber">8.4</span> <span class="toctext">关机/重启十分缓慢</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#%E7%9F%AD%E6%97%B6%E8%BF%9B%E7%A8%8B%E6%97%A0%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95"><span class="tocnumber">8.5</span> <span class="toctext">短时进程无日志记录</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#%E7%A6%81%E6%AD%A2%E5%9C%A8%E7%A8%8B%E5%BA%8F%E5%B4%A9%E6%BA%83%E6%97%B6%E8%BD%AC%E5%82%A8%E5%86%85%E5%AD%98"><span class="tocnumber">8.6</span> <span class="toctext">禁止在程序崩溃时转储内存</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#%E5%90%AF%E5%8A%A8%E7%9A%84%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF"><span class="tocnumber">8.7</span> <span class="toctext">启动的时间太长</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#systemd-tmpfiles-setup.service_%E5%9C%A8%E5%90%AF%E5%8A%A8%E6%97%B6%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5"><span class="tocnumber">8.8</span> <span class="toctext">systemd-tmpfiles-setup.service 在启动时启动失败</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#%E5%90%AF%E5%8A%A8%E6%97%B6%E6%98%BE%E7%A4%BA%E7%9A%84_systemd_%E7%89%88%E6%9C%AC%E5%92%8C%E5%AE%89%E8%A3%85%E7%89%88%E6%9C%AC%E4%B8%8D%E4%B8%80%E8%87%B4"><span class="tocnumber">8.9</span> <span class="toctext">启动时显示的 systemd 版本和安装版本不一致</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#%E7%A6%81%E7%94%A8%E8%BF%9C%E7%A8%8B%E6%9C%BA%E5%99%A8%E7%9A%84_emergency_%E6%A8%A1%E5%BC%8F"><span class="tocnumber">8.10</span> <span class="toctext">禁用远程机器的 emergency 模式</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39"><a href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90"><span class="tocnumber">9</span> <span class="toctext">相关资源</span></a></li>
</ul>
</div>

<h2>
<span id="systemd_.E5.9F.BA.E6.9C.AC.E5.B7.A5.E5.85.B7"></span><span class="mw-headline" id="systemd_基本工具">systemd 基本工具</span>
</h2>
<p>监视和控制systemd的主要命令是<code>systemctl</code>。该命令可用于查看系统状态和管理系统及服务。详见<span class="plainlinks archwiki-template-man" title="$ man 1 systemctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemctl.1">systemctl(1)</a></span>。、
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 
<ul>
<li>在 <code>systemctl</code> 参数中添加 <code>-H &lt;用户名&gt;@&lt;主机名&gt;</code> 可以实现对其他机器的远程控制。该功能使用 <a href="../zh-CN/Secure_Shell.html" class="mw-redirect" title="SSH (简体中文)">SSH</a> 连接。</li>
<li>
<a href="../en/KDE.html#Plasma" class="mw-redirect" title="Plasma">Plasma</a> 用户可以安装 <i>systemctl</i> 图形前端 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-kcm/">systemd-kcm</a></span><sup><small>AUR</small></sup>。安装后可以在 <i>System administration</i> 下找到。</li>
</ul>
</div>
<h3>
<span id=".E5.88.86.E6.9E.90.E7.B3.BB.E7.BB.9F.E7.8A.B6.E6.80.81"></span><span class="mw-headline" id="分析系统状态">分析系统状态</span>
</h3>
<p>显示 <b>系统状态</b>：
</p>
<pre>$ systemctl status
</pre>
<p>输出激活的单元：
</p>
<pre>$ systemctl
</pre>
<p>以下命令等效：
</p>
<pre>$ systemctl list-units
</pre>
<p>输出运行失败的单元：
</p>
<pre>$ systemctl --failed
</pre>
<p>所有可用的单元文件存放在 <code>/usr/lib/systemd/system/</code> 和 <code>/etc/systemd/system/</code> 目录（后者优先级更高）。查看所有已安装服务：
</p>
<pre>$ systemctl list-unit-files
</pre>
<p>显示 <a href="../en/Cgroups.html" title="Cgroups">cgroup slice</a>, 内存和父 PID:
</p>
<pre>$ systemctl status <i>pid</i>
</pre>
<h3>
<span id=".E4.BD.BF.E7.94.A8.E5.8D.95.E5.85.83"></span><span class="mw-headline" id="使用单元">使用单元</span>
</h3>
<p>一个单元配置文件可以描述如下内容之一：系统服务（<code>.service</code>）、挂载点（<code>.mount</code>）、sockets（<code>.sockets</code>） 、系统设备（<code>.device</code>）、交换分区（<code>.swap</code>）、文件路径（<code>.path</code>）、启动目标（<code>.target</code>）、由 systemd 管理的计时器（<code>.timer</code>）。详情参阅 <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5">systemd.unit(5)</a></span> 。
</p>
<p>使用 <code>systemctl</code> 控制单元时，通常需要使用单元文件的全名，包括扩展名（例如 <code>sshd.service</code> ）。但是有些单元可以在 <code>systemctl</code> 中使用简写方式。
</p>
<ul>
<li>如果无扩展名，systemctl 默认把扩展名当作 <code>.service</code> 。例如 <code>netcfg</code> 和 <code>netcfg.service</code> 是等价的。</li>
<li>挂载点会自动转化为相应的 <code>.mount</code> 单元。例如 <code>/home</code> 等价于 <code>home.mount</code> 。</li>
<li>设备会自动转化为相应的 <code>.device</code> 单元，所以 <code>/dev/sda2</code> 等价于 <code>dev-sda2.device</code> 。</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 有一些单元的名称包含一个 <code>@</code> 标记（例如： <code>name@<i>string</i>.service</code> ），这意味着它是模板单元 <code>name@.service</code> 的一个 <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/instances.html">实例</a>。 <code><i>string</i></code> 被称作实例标识符，在 <i>systemctl</i> 调用模板单元时，会将其当作一个参数传给模板单元，模板单元会使用这个传入的参数代替模板中的 <code>%I</code> 指示符。 
<p>在实例化之前，<i>systemd</i> 会先检查 <code>name@string.suffix</code> 文件是否存在（如果存在，就直接使用这个文件，而不是模板实例化）。大多数情况下，包含 <code>@</code> 标记都意味着这个文件是模板。如果一个模板单元没有实例化就调用，该调用会返回失败，因为模板单元中的 <code>%I</code> 指示符没有被替换。
</p>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 
<ul>
<li>下面的大部分命令都可以跟多个单元名, 详细信息参见 <span class="plainlinks archwiki-template-man" title="$ man 1 systemctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemctl.1">systemctl(1)</a></span>。</li>
<li>
<code>systemctl</code>命令在<code>enable</code>、<code>disable</code>和<code>mask</code>子命令中增加了<code>--now</code>选项，可以实现激活的同时启动服务，取消激活的同时停止服务。</li>
<li>一个软件包可能会提供多个不同的单元。如果你已经安装了软件包，可以通过<code>pacman -Qql <i>package</i> | grep systemd</code>命令检查这个软件包提供了哪些单元。</li>
</ul>
</div>
<p>立即激活单元：
</p>
<pre># systemctl start &lt;单元&gt;
</pre>
<p>立即停止单元：
</p>
<pre># systemctl stop &lt;单元&gt;
</pre>
<p>重启单元：
</p>
<pre># systemctl restart &lt;单元&gt;
</pre>
<p>重新加载配置：
</p>
<pre># systemctl reload &lt;单元&gt;
</pre>
<p>输出单元运行状态：
</p>
<pre>$ systemctl status &lt;单元&gt;
</pre>
<p>检查单元是否配置为自动启动：
</p>
<pre>$ systemctl is-enabled &lt;单元&gt;
</pre>
<p>开机自动激活单元：
</p>
<pre># systemctl enable &lt;单元&gt;
</pre>
<p>设置单元为自动启动并立即启动这个单元:
</p>
<pre># systemctl enable --now <i>unit</i>
</pre>
<p>取消开机自动激活单元：
</p>
<pre># systemctl disable &lt;单元&gt;
</pre>
<p>禁用一个单元（禁用后，间接启动也是不可能的）：
</p>
<pre># systemctl mask &lt;单元&gt;
</pre>
<p>取消禁用一个单元：
</p>
<pre># systemctl unmask &lt;单元&gt;
</pre>
<p>显示单元的手册页（必须由单元文件提供）：
</p>
<pre># systemctl help &lt;单元&gt;
</pre>
<p>重新载入 systemd 系统配置，扫描单元文件的变动。注意这里不会重新加载变更的单元文件。参考上面的 <code>reload</code> 示例。
</p>
<pre># systemctl daemon-reload
</pre>
<h3>
<span id=".E7.94.B5.E6.BA.90.E7.AE.A1.E7.90.86"></span><span class="mw-headline" id="电源管理">电源管理</span>
</h3>
<p>安装 <a href="../en/Polkit.html" title="Polkit">polkit</a> 后才能以普通用户身份使用电源管理。
</p>
<p>如果你正登录在一个本地的 <code>systemd-logind</code> 用户会话，且当前没有其它活动的会话，那么以下命令无需 root 权限即可执行。否则（例如，当前有另一个用户登录在某个 tty ）， systemd 将会自动请求输入root密码。
</p>
<p>重启：
</p>
<pre>$ systemctl reboot
</pre>
<p>退出系统并关闭电源：
</p>
<pre>$ systemctl poweroff
</pre>
<p>待机：
</p>
<pre>$ systemctl suspend
</pre>
<p>休眠：
</p>
<pre>$ systemctl hibernate
</pre>
<p>混合休眠模式（同时休眠到硬盘并待机）：
</p>
<pre>$ systemctl hybrid-sleep
</pre>
<h2>
<span id=".E7.BC.96.E5.86.99.E5.8D.95.E5.85.83.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="编写单元文件">编写单元文件</span>
</h2>
<p><code>systemd</code> <a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/systemd.unit.html">单元文件</a>的语法来源于 XDG 桌面项配置文件<code>.desktop</code>文件，最初的源头则是Microsoft Windows的<code>.ini</code>文件。单元文件可以从多个地方加载，<code>systemctl show --property=UnitPath</code> 可以按优先级从低到高显示加载目录：
</p>
<ul>
<li>
<code>/usr/lib/systemd/system/</code> ：软件包安装的单元</li>
<li>
<code>/etc/systemd/system/</code> ：系统管理员安装的单元</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 
<ul>
<li>当 <code>systemd</code> 运行在<a href="../en/Systemd/User.html#How_it_works" title="Systemd/User">用户模式</a>下时，使用的加载路径是完全不同的。</li>
<li>systemd 单元名仅能包含 ASCII 字符，下划线和点号和有特殊意义的字符('@', '-')。其它字符需要用 C-style "\x2d" 替换。参阅 <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5">systemd.unit(5)</a></span> 和 <span class="plainlinks archwiki-template-man" title="$ man 1 systemd-escape"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-escape.1">systemd-escape(1)</a></span> 。</li>
</ul>
</div>
<p>单元文件的语法，可以参考系统已经安装的单元，也可以参考 <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.service"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.service.5">systemd.service(5)</a></span> 中的<a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/systemd.service.html#Examples">EXAMPLES章节</a>。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong>  以 <code>#</code> 开头的注释可能也能用在 unit-files 中，但是只能在新行中使用。不要在 <i>systemd</i> 的参数后面使用行末注释， 否则 unit 将会启动失败。</div>
<h3>
<span id=".E5.A4.84.E7.90.86.E4.BE.9D.E8.B5.96.E5.85.B3.E7.B3.BB"></span><span class="mw-headline" id="处理依赖关系">处理依赖关系</span>
</h3>
<p>使用 systemd 时，可通过正确编写单元配置文件来解决其依赖关系。典型的情况是，单元 <code>A</code> 要求单元 <code>B</code> 在 <code>A</code> 启动之前运行。在此情况下，向单元 <code>A</code> 配置文件中的 <code>[Unit]</code> 段添加 <code>Requires=B</code> 和 <code>After=B</code> 即可。若此依赖关系是可选的，可添加 <code>Wants=B</code> 和 <code>After=B</code> 。请注意 <code>Wants=</code> 和 <code>Requires=</code> 并不意味着 <code>After=</code> ，即如果 <code>After=</code> 选项没有制定，这两个单元将被并行启动。
</p>
<p>依赖关系通常被用在服务（service）而不是<a href="#%E7%9B%AE%E6%A0%87%EF%BC%88target%EF%BC%89">目标（target）</a>上。例如， <code>network.target</code> 一般会被某个配置网络接口的服务引入，所以，将自定义的单元排在该服务之后即可，因为 <code>network.target</code> 已经启动。
</p>
<h3>
<span id=".E6.9C.8D.E5.8A.A1.E7.B1.BB.E5.9E.8B"></span><span class="mw-headline" id="服务类型">服务类型</span>
</h3>
<p>编写自定义的 service 文件时，可以选择几种不同的服务启动方式。启动方式可通过配置文件 <code>[Service]</code> 段中的 <code>Type=</code> 参数进行设置。
</p>
<ul>
<li>
<code>Type=simple</code> ：（默认值） systemd认为该服务将立即启动。服务进程不会 fork 。如果该服务要启动其他服务，不要使用此类型启动，除非该服务是socket 激活型。</li>
<li>
<code>Type=forking</code> ：systemd认为当该服务进程fork，且父进程退出后服务启动成功。对于常规的守护进程（daemon），除非你确定此启动方式无法满足需求，使用此类型启动即可。使用此启动类型应同时指定 <code>PIDFile=</code>，以便 systemd 能够跟踪服务的主进程。</li>
<li>
<code>Type=oneshot</code> ：这一选项适用于只执行一项任务、随后立即退出的服务。可能需要同时设置 <code>RemainAfterExit=yes</code> 使得 systemd 在服务进程退出之后仍然认为服务处于激活状态。</li>
<li>
<code>Type=notify</code> ：与 <code>Type=simple</code> 相同，但约定服务会在就绪后向 systemd 发送一个信号。这一通知的实现由 <code>libsystemd-daemon.so</code> 提供。</li>
<li>
<code>Type=dbus</code> ：若以此方式启动，当指定的 <code>BusName</code> 出现在DBus系统总线上时，systemd认为服务就绪。</li>
<li>
<code>Type=idle</code> ：<code>systemd</code>会等待所有任务处理完成后，才开始执行 <code>idle</code> 类型的单元。其他行为与 <code>Type=simple</code> 类似。</li>
</ul>
<p><code>type</code> 的更多解释可以参考 <a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/systemd.service.html#Type=">systemd.service(5)</a>。
</p>
<h3>
<span id=".E4.BF.AE.E6.94.B9.E7.8E.B0.E5.AD.98.E5.8D.95.E5.85.83.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="修改现存单元文件">修改现存单元文件</span>
</h3>
<p>为了避免和 pacman 冲突，不应该直接编辑软件包提供的文件。有两种方法可以不改动原始文件就做到修改单元文件：创建一个优先级更高的本地单元文件或创建一个片段，应用到原始单元文件之上。两种方法都需要在修改后重新加载单元，用 <code>systemctl edit</code> 编辑单元(会自动重载单元)或通过下面命令重新加载单元：
</p>
<pre># systemctl daemon-reload
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 
<ul>
<li>
<code>systemd-delta</code> 命令用来查看哪些单元文件被覆盖、哪些被修改。系统维护的时候需要及时了解哪些单元已经有了更新。</li>
<li>使用 <code>systemctl cat <i>unit</i></code> 可以查看单元的内容和所有相关的片段.</li>
</ul>
</div>
<h4>
<span id=".E6.9B.BF.E6.8D.A2.E5.8D.95.E5.85.83.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="替换单元文件">替换单元文件</span>
</h4>
<p>要替换 <code>/usr/lib/systemd/system/<i>unit</i></code>, 创建文件 <code>/etc/systemd/system/<i>unit</i></code> 并重新启用单元以更新链接：
</p>
<pre># systemctl reenable <i>unit</i>
</pre>
<p>或者运行：
</p>
<pre># systemctl edit --full <i>unit</i>
</pre>
<p>这将会在记事本中打开 <code>/etc/systemd/system/<i>unit</i></code>，如果文件不存在，可以将安装的版本复制到这里，在编辑完成之后，会自动加载新版本。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 即使 Pacman 更新了新的单元文件，软件包中的版本也不会被使用，所以这个方式会增加系统维护的难度，推荐使用下面一种方法。</div>
<h4>
<span id=".E9.99.84.E5.8A.A0.E9.85.8D.E7.BD.AE.E7.89.87.E6.AE.B5"></span><span class="mw-headline" id="附加配置片段">附加配置片段</span>
</h4>
<p>要附加配置片段，先创建名为 <code>/etc/systemd/system/&lt;单元名&gt;.d/</code> 的目录，然后放入 <code>*.conf</code> 文件，其中可以添加或重置参数。这里设置的参数优先级高于原来的单元文件。下面的更新方式比较简单：
</p>
<pre># systemctl edit <i>unit</i>
</pre>
<p>这将会在编辑器中打开文件 <code>/etc/systemd/system/<i>unit</i>.d/override.conf</code>，编辑完成之后自动加载。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 并不是所有参数都会被子配置文件覆盖。例如要修改 <code>Conflicts=</code> 就必须 <a rel="nofollow" class="external text" href="https://lists.freedesktop.org/archives/systemd-devel/2017-June/038976.html">替换原始文件</a>。</div>
<h4>
<span id=".E9.87.8D.E7.BD.AE.E5.88.B0.E8.BD.AF.E4.BB.B6.E5.8C.85.E7.89.88.E6.9C.AC"></span><span class="mw-headline" id="重置到软件包版本">重置到软件包版本</span>
</h4>
<p>要回退单元的变更，使用 <code>systemctl edit</code> 并执行:
</p>
<pre># systemctl revert <i>unit</i>
</pre>
<h4>
<span id=".E7.A4.BA.E4.BE.8B"></span><span class="mw-headline" id="示例">示例</span>
</h4>
<p>例如，如果想添加一个额外的依赖，创建如下文件即可：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/&lt;unit&gt;.d/customdependency.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Requires=&lt;新依赖&gt;
After=&lt;新依赖&gt;</pre>
<p>要修改一个非  <code>oneshot</code> 单元的 <code>ExecStart</code> 命令，创建下面文件:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>unit</i>.d/customexec.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
ExecStart=
ExecStart=<i>new command</i></pre>
<p>修改 <code>ExecStart</code> 前必须将其置空，参见 (<a rel="nofollow" class="external autonumber" href="https://bugzilla.redhat.com/show_bug.cgi?id=756787#c9">[1]</a> 。所有可能多次赋值的变量都需要这个操作，例如定时器的 <code>OnCalendar</code> 。
</p>
<p>下面是自动重启服务的一个例子：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>unit</i>.d/restart.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
Restart=always
RestartSec=30</pre>
<h2>
<span id=".E7.9B.AE.E6.A0.87.EF.BC.88target.EF.BC.89"></span><span class="mw-headline" id="目标（target）">目标（target）</span>
</h2>
<p>运行级别（runlevel）是一个旧的概念。现在，systemd 引入了一个和运行级别功能相似又不同的概念——目标（target）。不像数字表示的启动级别，每个<i>目标</i>都有名字和独特的功能，并且能同时启用多个。一些<i>目标</i>继承其他<i>目标</i>的服务，并启动新服务。systemd 提供了一些模仿 sysvinit 运行级别的<i>目标</i>，仍可以使用旧的 <code>telinit 运行级别</code> 命令切换。
</p>
<h3>
<span id=".E8.8E.B7.E5.8F.96.E5.BD.93.E5.89.8D.E7.9B.AE.E6.A0.87"></span><span class="mw-headline" id="获取当前目标">获取当前目标</span>
</h3>
<p>不要使用 <code>runlevel</code> 命令了：
</p>
<pre>$ systemctl list-units --type=target
</pre>
<h3>
<span id=".E5.88.9B.E5.BB.BA.E8.87.AA.E5.AE.9A.E4.B9.89.E7.9B.AE.E6.A0.87"></span><span class="mw-headline" id="创建自定义目标">创建自定义目标</span>
</h3>
<p>在 <i>sysvinit</i> 中有明确定义的运行级别（如：0、1、3、5、6）与 <i>systemd</i> 中特定的 <i>目标</i> 存在一一对应的关系。然而，对于用户自定义运行级别（2、4）却没有。如需要同样功能，建议你以原有运行级别所对应的 systemd 目标为基础，新建一个<code>/etc/systemd/system/<i>&lt;目标名&gt;.target</i></code>（可参考<code>/usr/lib/systemd/system/graphical.target</code>）, 然后创建目录<code>/etc/systemd/system/&lt;目标名&gt;.wants</code>，并向其中加入需启用的服务链接（指向<code>/ur/lib/systemd/system/</code>）。
</p>
<h3>
<span id=".22SysV_.E8.BF.90.E8.A1.8C.E7.BA.A7.E5.88.AB.22_.E4.B8.8E_.22systemd_.E7.9B.AE.E6.A0.87.22_.E5.AF.B9.E7.85.A7.E8.A1.A8"></span><span class="mw-headline" id='"SysV_运行级别"_与_"systemd_目标"_对照表'>"SysV 运行级别" 与 "systemd 目标" 对照表</span>
</h3>
<table class="wikitable">
<tbody>
<tr>
<th>SysV 运行级别</th>
<th>Systemd 目标</th>
<th>注释
</th>
</tr>
<tr>
<td>0</td>
<td>runlevel0.target, poweroff.target</td>
<td>中断系统（halt）
</td>
</tr>
<tr>
<td>1, s, single</td>
<td>runlevel1.target, rescue.target</td>
<td>单用户模式
</td>
</tr>
<tr>
<td>2, 4</td>
<td>runlevel2.target, runlevel4.target, multi-user.target</td>
<td>用户自定义运行级别，通常识别为级别3。
</td>
</tr>
<tr>
<td>3</td>
<td>runlevel3.target, multi-user.target</td>
<td>多用户，无图形界面。用户可以通过终端或网络登录。
</td>
</tr>
<tr>
<td>5</td>
<td>runlevel5.target, graphical.target</td>
<td>多用户，图形界面。继承级别3的服务，并启动图形界面服务。
</td>
</tr>
<tr>
<td>6</td>
<td>runlevel6.target, reboot.target</td>
<td>重启
</td>
</tr>
<tr>
<td>emergency</td>
<td>emergency.target</td>
<td>急救模式（Emergency shell）
</td>
</tr>
</tbody>
</table>
<h3>
<span id=".E5.88.87.E6.8D.A2.E5.BD.93.E5.89.8D.E8.BF.90.E8.A1.8C.E7.9B.AE.E6.A0.87"></span><span class="mw-headline" id="切换当前运行目标">切换当前运行目标</span>
</h3>
<p>systemd中，运行目标通过“目标单元”访问。通过如下命令切换：
</p>
<pre># systemctl isolate graphical.target
</pre>
<p>该命令仅更改当前运行目标，对下次启动无影响。这等价于sysvinit中的 <code>telinit 3</code> 或 <code>telinit 5</code> 命令。
</p>
<h3>
<span id=".E6.9B.B4.E6.94.B9.E5.BC.80.E6.9C.BA.E9.BB.98.E8.AE.A4.E5.90.AF.E5.8A.A8.E7.9B.AE.E6.A0.87"></span><span class="mw-headline" id="更改开机默认启动目标">更改开机默认启动目标</span>
</h3>
<p>开机启动的目标是 <code>default.target</code>，默认链接到 <code>graphical.target</code> （大致相当于原来的运行级别5）。
</p>
<p>用 <i>systemctl</i> 检查当前的默认启动目标：
</p>
<pre># systemctl get-default
</pre>
<p>用 <i>systemctl</i> 修改<code>default.target</code>以变更开机默认启动目标：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ systemctl set-default multi-user.target</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Removed /etc/systemd/system/default.target.
Created symlink /etc/systemd/system/default.target -&gt; /usr/lib/systemd/system/graphical.target.</pre>
<p>另一方法是向bootloader添加<a href="../zh-CN/Kernel_parameters.html" title="Kernel parameters (简体中文)">内核参数</a>：
</p>
<ul>
<li>
<code>systemd.unit=multi-user.target</code> （大致相当于运行级别3）</li>
<li>
<code>systemd.unit=rescue.target</code> （大致相当于运行级别1）</li>
</ul>
<h3>
<span id=".E9.BB.98.E8.AE.A4.E7.9B.AE.E6.A0.87.E9.A1.BA.E5.BA.8F"></span><span class="mw-headline" id="默认目标顺序">默认目标顺序</span>
</h3>
<p>Systemd 根据下面顺序选择 <code>default.target</code>：
</p>
<ol>
<li>上面的内核参数</li>
<li>
<code>/etc/systemd/system/default.target</code> 软链接</li>
<li>
<code>/usr/lib/systemd/system/default.target</code> 软链接</li>
</ol>
<h2>
<span id=".E4.B8.B4.E6.97.B6.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="临时文件">临时文件</span>
</h2>
<p><code>/usr/lib/tmpfiles.d/</code> 和 <code>/etc/tmpfiles.d/</code> 中的文件描述了 systemd-tmpfiles 如何创建、清理、删除临时文件和目录，这些文件和目录通常存放在 <code>/run</code> 和 <code>/tmp</code> 中。配置文件名称为 <code>/etc/tmpfiles.d/&lt;program&gt;.conf</code>。此处的配置能覆盖 <code>/usr/lib/tmpfiles.d/</code> 目录中的同名配置。
</p>
<p>临时文件通常和服务文件同时提供，以生成守护进程需要的文件和目录。例如 <a href="../zh-CN/Samba.html" title="Samba (简体中文)">Samba</a> 服务需要目录 <code>/run/samba</code> 存在并设置正确的权限位，就象这样：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/tmpfiles.d/samba.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">D /run/samba 0755 root root
</pre>
<p>此外，临时文件还可以用来在开机时向特定文件写入某些内容。比如，要禁止系统从USB设备唤醒，利用旧的 <code>/etc/rc.local</code> 可以用 <code>echo USBE &gt; /proc/acpi/wakeup</code>，而现在可以这么做：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/tmpfiles.d/disable-usb-wake.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">w /proc/acpi/wakeup - - - - USBE
</pre>
<p>详情参见<code>systemd-tmpfiles(8)</code> 和 <span class="plainlinks archwiki-template-man" title="$ man 5 tmpfiles.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/tmpfiles.d.5">tmpfiles.d(5)</a></span>。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 该方法不能向 <code>/sys</code> 中的配置文件添加参数，因为 <code>systemd-tmpfiles-setup</code> 有可能在相关模块加载前运行。这种情况下，需要首先通过 <code>modinfo &lt;模块名&gt;</code> 确认需要的参数，然后在 <a href="../zh-CN/Kernel_module.html#%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%9D%97%E5%8F%82%E6%95%B0" class="mw-redirect" title="Kernel modules (简体中文)"><code>/etc/modprobe.d</code> 目录下的配置文件</a>中修改配置参数。另外，还可以使用 <a href="../zh-CN/Udev.html#udev_%E8%A7%84%E5%88%99" title="Udev (简体中文)">udev 规则</a>，在设备就绪时设置相应属性。</div>
<h2>
<span id=".E5.AE.9A.E6.97.B6.E5.99.A8"></span><span class="mw-headline" id="定时器">定时器</span>
</h2>
<p>一个定时器是一个以 <code>.timer</code> 为结尾的单元配置文件并包含由 <code>systemd</code> 控制和监督的信息。<a href="../zh-CN/ac55e32d4dfdaeb996fb6e2ed9ab24e5.html" class="mw-redirect" title="Systemd/Timers (简体中文)">systemd/Timers (简体中文)</a>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 定时器很大程度上可取代 <code>cron</code>。<a href="../zh-CN/ac55e32d4dfdaeb996fb6e2ed9ab24e5.html#%E6%9B%BF%E4%BB%A3_cron" class="mw-redirect" title="Systemd/Timers (简体中文)">systemd/Timers (简体中文)#替代 cron</a>
</div>
<h2>
<span id=".E6.8C.82.E8.BD.BD"></span><span class="mw-headline" id="挂载">挂载</span>
</h2>
<p>因为 systemd 也负责按 <code>/etc/fstab</code> 挂载目录。在系统启动和重新加载系统管理器时，<span class="plainlinks archwiki-template-man" title="$ man 8 systemd-fstab-generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-fstab-generator.8">systemd-fstab-generator(8)</a></span> 会将 <code>/etc/fstab</code> 中的配置转化为 systemd 单元。
</p>
<p><i>systemd</i> 扩展了 <a href="../en/Fstab.html" title="Fstab">fstab</a> 的传统功能，提供了额外的挂载选项。例如可以确保一个挂载仅在网络已经连接时进行，或者仅当另外一个分区已挂载时再挂载。这些选项通常以 <code>x-systemd.</code> 开头，<span class="plainlinks archwiki-template-man" title="$ man 5 systemd.mount"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.mount.5#FSTAB">systemd.mount(5) § FSTAB</a></span> 中包含了完整说明。
</p>
<p><i>automounting</i> 也是一个例子，可以在使用时，而不是启动时挂载分区，详情请参考 <a href="../en/Fstab.html#Automount_with_systemd" title="Fstab">fstab#Automount with systemd</a>。
</p>
<h3>
<span id="GPT_.E5.88.86.E5.8C.BA.E8.87.AA.E5.8A.A8.E6.8C.82.E8.BD.BD"></span><span class="mw-headline" id="GPT_分区自动挂载">GPT 分区自动挂载</span>
</h3>
<p>在 <a href="../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GPT">GPT</a> 分区磁盘系统上，<span class="plainlinks archwiki-template-man" title="$ man 8 systemd-gpt-auto-generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-gpt-auto-generator.8">systemd-gpt-auto-generator(8)</a></span> 会按照 <a rel="nofollow" class="external text" href="https://systemd.io/DISCOVERABLE_PARTITIONS/">可探测分区规范</a> 进行挂载。可以在 <code>fstab</code> 中忽略。
</p>
<p>要禁用自动挂载，请修改分区的 <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs" class="extiw" title="wikipedia:GUID Partition Table">类型 GUID</a> 或设置分区属性 63 位 "不自动挂载"，详情参考 <a href="../en/GPT_fdisk.html#Prevent_GPT_partition_automounting" class="mw-redirect" title="Gdisk">gdisk#Prevent GPT partition automounting</a>。
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Running_services_after_the_network_is_up">Running services after the network is up</span></h3>
<p>To delay a service after the network is up, include the following dependencies in the <i>.service</i> file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>foo</i>.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]	
...
<b>Wants=network-online.target</b>
<b>After=network-online.target</b>	
...</pre>
<p>The network wait service of the particular application that manages the network, must also be enabled so that <code>network-online.target</code> properly reflects the network status.
</p>
<ul>
<li>For the ones using <a href="../en/NetworkManager.html" title="NetworkManager">NetworkManager</a>, <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Enable">enable</a> <code>NetworkManager-wait-online.service</code>.</li>
<li>If using <a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a>, <code>systemd-networkd-wait-online.service</code> is by default enabled automatically whenever <code>systemd-networkd.service</code> has been enabled; check this is the case with <code>systemctl is-enabled systemd-networkd-wait-online.service</code>, there is no other action needed.</li>
</ul>
<p>For more detailed explanations see <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/NetworkTarget/">Running services after the network is up</a> in the systemd wiki.
</p>
<h3><span class="mw-headline" id="Enable_installed_units_by_default">Enable installed units by default</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> How does it work with instantiated units? (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Systemd (简体中文)#</a>)</div>
</div>
<p>Arch Linux ships with <code>/usr/lib/systemd/system-preset/99-default.preset</code> containing <code>disable *</code>. This causes <i>systemctl preset</i> to disable all units by default, such that when a new package is installed, the user must manually enable the unit.
</p>
<p>If this behavior is not desired, simply create a symlink from <code>/etc/systemd/system-preset/99-default.preset</code> to <code>/dev/null</code> in order to override the configuration file. This will cause <i>systemctl preset</i> to enable all units that get installed—regardless of unit type—unless specified in another file in one <i>systemctl preset'</i>s configuration directories. User units are not affected. See the manpage for <code>systemd.preset</code> for more information.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Enabling all units by default may cause problems with packages that contain two or more mutually exclusive units. <i>systemctl preset</i> is designed to be used by distributions and spins or system administrators. In the case where two conflicting units would be enabled, you should explicitly specify which one is to be disabled in a preset configuration file as specified in the manpage for <code>systemd.preset</code>.</div>
<h3><span class="mw-headline" id="Sandboxing_application_environments">Sandboxing application environments</span></h3>
<p>A unit file can be created as a sandbox to isolate applications and their processes within a hardened virtual environment. systemd leverages <a href="https://en.wikipedia.org/wiki/Linux_namespaces" class="extiw" title="wikipedia:Linux namespaces">namespaces</a>, white-/blacklisting of <a href="../en/Capabilities.html" title="Capabilities">Capabilities</a>, and <a href="../en/Cgroups.html" class="mw-redirect" title="Control groups">control groups</a> to container processes through an extensive <a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html">execution environment configuration</a>.
</p>
<p>The enhancement of an existing systemd unit file with application sandboxing typically requires trial-and-error tests accompanied by the generous use of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=strace">strace</a></span>, <a href="https://en.wikipedia.org/wiki/Standard_streams#Standard_error_.28stderr.29" class="extiw" title="wikipedia:Standard streams">stderr</a> and <a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/journalctl.html">journalctl</a> error logging and output facilities. You may want to first search upstream documentation for already done tests to base trials on.
</p>
<p>Some examples on how sandboxing with systemd can be deployed:
</p>
<ul><li>
<code>CapabilityBoundingSet</code> defines a whitelisted set of allowed capabilities, but may also be used to blacklist a specific capability for a unit.
<ul><li>The <code>CAP_SYS_ADM</code> capability, for example, which should be one of the <a rel="nofollow" class="external text" href="https://lwn.net/Articles/486306/">goals of a secure sandbox</a>: <code>CapabilityBoundingSet=~ CAP_SYS_ADM</code>
</li></ul>
</li></ul>
<h2>
<span id=".E7.96.91.E9.9A.BE.E8.A7.A3.E7.AD.94"></span><span class="mw-headline" id="疑难解答">疑难解答</span>
</h2>
<h3>
<span id=".E5.AF.BB.E6.89.BE.E9.94.99.E8.AF.AF"></span><span class="mw-headline" id="寻找错误">寻找错误</span>
</h3>
<p>这个例子中的失败的服务是 <code>systemd-modules-load</code> :
</p>
<p><b>1.</b> 通过 <i>systemd</i> 寻找启动失败的服务:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ systemctl --state=failed</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">systemd-modules-load.service   loaded <b>failed failed</b>  Load Kernel Modules</pre>
<p>或者使用 <i>systemd</i> 消息:
</p>
<pre>$ journalctl -fp err
</pre>
<p><b>2.</b> 我们发现了启动失败的 <code>systemd-modules-load</code> 服务. 我们想知道更多信息:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ systemctl status systemd-modules-load</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">systemd-modules-load.service - Load Kernel Modules
   Loaded: loaded (/usr/lib/systemd/system/systemd-modules-load.service; static)
   Active: <b>failed</b> (Result: exit-code) since So 2013-08-25 11:48:13 CEST; 32s ago
     Docs: man:systemd-modules-load.service(8).
           man:modules-load.d(5)
  Process: <b>15630</b> ExecStart=/usr/lib/systemd/systemd-modules-load (<b>code=exited, status=1/FAILURE</b>)</pre>
<p>如果没列出 <code>Process ID</code>, 通过 <code>systemctl</code> 重新启动失败的服务 ( 例如 <code>systemctl restart systemd-modules-load</code> )
</p>
<p><b>3.</b> 现在得到了 PID ,你就可以进一步探查错误的详细信息了.通过下列的命令收集日志,PID 参数是你刚刚得到的 <code>Process ID</code> (例如 15630):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ journalctl -b _PID=15630</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">-- Logs begin at Sa 2013-05-25 10:31:12 CEST, end at So 2013-08-25 11:51:17 CEST. --
Aug 25 11:48:13 mypc systemd-modules-load[15630]: <b>Failed to find module 'blacklist usblp'</b>
Aug 25 11:48:13 mypc systemd-modules-load[15630]: <b>Failed to find module 'install usblp /bin/false'</b></pre>
<p><b>4.</b> 我们发现有些内核模块的配置文件不正确,因此在  <code>/etc/modules-load.d/</code> 中检查一下:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ls -Al /etc/modules-load.d/</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
-rw-r--r--   1 root root    79  1. Dez 2012  blacklist.conf
-rw-r--r--   1 root root     1  2. Mär 14:30 encrypt.conf
-rw-r--r--   1 root root     3  5. Dez 2012  printing.conf
-rw-r--r--   1 root root     6 14. Jul 11:01 realtek.conf
-rw-r--r--   1 root root    65  2. Jun 23:01 virtualbox.conf
...
</pre>
<p><b>5.</b> 错误消息 <code>Failed to find module 'blacklist usblp'</code> 也许和  <code>blacklist.conf</code> 相关. 让我们注释掉第三步发现的错误的选项:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modules-load.d/blacklist.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"><b>#</b> blacklist usblp
<b>#</b> install usblp /bin/false
</pre>
<p><b>6.</b> 最后重新启动 <code>systemd-modules-load</code> 服务:
</p>
<pre># systemctl start systemd-modules-load
</pre>
<p>如果服务成功启动,不会有任何输出.如果你还是遇到了错误,回到步骤三,获得新的 PID 来跟踪日志并解决错误.
</p>
<p>可以像这样确认服务成功启动:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ systemctl status systemd-modules-load</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">systemd-modules-load.service - Load Kernel Modules
   Loaded: <b>loaded</b> (/usr/lib/systemd/system/systemd-modules-load.service; static)
   Active: <b>active (exited)</b> since So 2013-08-25 12:22:31 CEST; 34s ago
     Docs: man:systemd-modules-load.service(8)
           man:modules-load.d(5)
 Process: 19005 ExecStart=/usr/lib/systemd/systemd-modules-load (code=exited, status=0/SUCCESS)
Aug 25 12:22:31 mypc systemd[1]: <b>Started Load Kernel Modules</b>.</pre> 
<h3>
<span id=".E8.AF.8A.E6.96.AD.E5.90.AF.E5.8A.A8.E9.97.AE.E9.A2.98"></span><span class="mw-headline" id="诊断启动问题">诊断启动问题</span>
</h3>
<p>使用如下内核参数引导：
<code>systemd.log_level=debug systemd.log_target=kmsg log_buf_len=1M</code>
</p>
<p>更多有关调试的信息，参见<a rel="nofollow" class="external text" href="https://freedesktop.org/wiki/Software/systemd/Debugging">该文</a>。
</p>
<h3>
<span id=".E8.AF.8A.E6.96.AD.E4.B8.80.E4.B8.AA.E6.9C.8D.E5.8A.A1"></span><span class="mw-headline" id="诊断一个服务">诊断一个服务</span>
</h3>
<p>如果某个 <i>systemd</i> 服务的工作状况不合预期,希望调试的话,设置 <code>SYSTEMD_LOG_LEVEL</code> <a href="../en/Environment_variables.html" class="mw-redirect" title="Environment variable">环境变量</a> 为 <code>debug</code> . 例如以调试模式运行 <i>systemd-networkd</i> 服务:
</p>
<p>在此服务的配置文件片段中加入：
</p>
<pre>[Service]
Environment=SYSTEMD_LOG_LEVEL=debug
</pre>
<p>或者等价的,临时编辑系统单元文件,例如:
</p>
<ol><li>SYSTEMD_LOG_LEVEL=debug /lib/systemd/systemd-networkd</li></ol>
<p><a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Restart">重启</a> <i>systemd-networkd</i> 服务，用 <code>--follow</code> 选项检查日志。
</p>
<h3>
<span id=".E5.85.B3.E6.9C.BA.2F.E9.87.8D.E5.90.AF.E5.8D.81.E5.88.86.E7.BC.93.E6.85.A2"></span><span class="mw-headline" id="关机/重启十分缓慢">关机/重启十分缓慢</span>
</h3>
<p>如果关机特别慢（甚至跟死机了一样），很可能是某个拒不退出的服务在作怪。systemd 会等待一段时间，然后再尝试杀死它。请阅读<a rel="nofollow" class="external text" href="https://freedesktop.org/wiki/Software/systemd/Debugging#Shutdown_Completes_Eventually">这篇文章</a>，确认你是否是该问题受害者。
</p>
<h3>
<span id=".E7.9F.AD.E6.97.B6.E8.BF.9B.E7.A8.8B.E6.97.A0.E6.97.A5.E5.BF.97.E8.AE.B0.E5.BD.95"></span><span class="mw-headline" id="短时进程无日志记录">短时进程无日志记录</span>
</h3>
<p>若 <code>journalctl -u foounit.service</code> 没有显示某个短时进程的任何输出，那么改用 PID 试试。例如，若 <code>systemd-modules-load.service</code> 执行失败，那么先用 <code>systemctl status systemd-modules-load</code> 查询其 PID（比如是123），然后检索该 PID 相关的日志 <code>journalctl -b _PID=123</code>。运行时进程的日志元数据（诸如 _SYSTEMD_UNIT 和 _COMM）被乱序收集在 <code>/proc</code> 目录。要修复该问题，必须修改内核，使其通过套接字连接来提供上述数据，该过程类似于 SCM_CREDENTIALS。
</p>
<h3>
<span id=".E7.A6.81.E6.AD.A2.E5.9C.A8.E7.A8.8B.E5.BA.8F.E5.B4.A9.E6.BA.83.E6.97.B6.E8.BD.AC.E5.82.A8.E5.86.85.E5.AD.98"></span><span class="mw-headline" id="禁止在程序崩溃时转储内存">禁止在程序崩溃时转储内存</span>
</h3>
<p>要使用老的内核转储，创建下面文件:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/49-coredump.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.core_pattern = core
kernel.core_uses_pid = 0</pre>
<p>然后运行：
</p>
<pre># /usr/lib/systemd/systemd-sysctl
</pre>
<p>同样可能需要执行“unlimit”设置文件大小：
</p>
<pre>$ ulimit -c unlimited
</pre>
<p>更多信息请参阅 <a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/sysctl.d.html">sysctl.d</a> 和 <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/Documentation/sysctl/kernel.txt">/proc/sys/kernel 文档</a>。
</p>
<h3>
<span id=".E5.90.AF.E5.8A.A8.E7.9A.84.E6.97.B6.E9.97.B4.E5.A4.AA.E9.95.BF"></span><span class="mw-headline" id="启动的时间太长">启动的时间太长</span>
</h3>
<p>不少用户用了 <code>systemd-analyze</code> 命令以后报告启动的时间比预计的要长,通常会说 <code>systemd-analyze</code> 分析结果表示 <a href="../en/NetworkManager.html" title="NetworkManager">NetworkManager</a> 占据了太多的启动的时间.
</p>
<p>有些用户的问题是 <code>/var/log/journal</code> 文件夹似乎过大.这也许也会对像<code>systemctl status</code> 或 <code>journalctl</code> 的命令有影响.一种解决方案是删除其中的文件 (但最好将它们备份到某处) 然后限制日志文件的大小.
</p>
<h3>
<span id="systemd-tmpfiles-setup.service_.E5.9C.A8.E5.90.AF.E5.8A.A8.E6.97.B6.E5.90.AF.E5.8A.A8.E5.A4.B1.E8.B4.A5"></span><span class="mw-headline" id="systemd-tmpfiles-setup.service_在启动时启动失败">systemd-tmpfiles-setup.service 在启动时启动失败</span>
</h3>
<p>从 systemd 219 开始, <code>/usr/lib/tmpfiles.d/systemd.conf</code> 指定 <code>/var/log/journal</code> 的 ACL 属性和目录, 因此日志所在的文件系统上要启用ACL.
</p>
<p>参阅 <a href="../en/Access_Control_Lists.html#Enable_ACL" title="Access Control Lists">Access Control Lists#Enable ACL</a> 获得如何包含 <code>/var/log/journal</code> 启动 ACL 的详细信息.
</p>
<h3>
<span id=".E5.90.AF.E5.8A.A8.E6.97.B6.E6.98.BE.E7.A4.BA.E7.9A.84_systemd_.E7.89.88.E6.9C.AC.E5.92.8C.E5.AE.89.E8.A3.85.E7.89.88.E6.9C.AC.E4.B8.8D.E4.B8.80.E8.87.B4"></span><span class="mw-headline" id="启动时显示的_systemd_版本和安装版本不一致">启动时显示的 systemd 版本和安装版本不一致</span>
</h3>
<p>需要 <a href="../en/Mkinitcpio.html#Image_creation_and_activation" title="Mkinitcpio">重新生成 initramfs</a>。 
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 可以使用 pacman 钩子在更新 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span>时重新生成 initramfs。参考 <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=215411">这个帖子</a> 和 <a href="../en/Pacman.html#Hooks" title="Pacman">Pacman#Hooks</a>.</div>
<h3>
<span id=".E7.A6.81.E7.94.A8.E8.BF.9C.E7.A8.8B.E6.9C.BA.E5.99.A8.E7.9A.84_emergency_.E6.A8.A1.E5.BC.8F"></span><span class="mw-headline" id="禁用远程机器的_emergency_模式">禁用远程机器的 emergency 模式</span>
</h3>
<p>如果远程机器位于云主机，emergency 模式会导致系统无法远程连接，可以通过下面方式禁用紧急模式：
</p>
<pre># systemctl mask emergency.service
# systemctl mask emergency.target
</pre>
<h2>
<span id=".E7.9B.B8.E5.85.B3.E8.B5.84.E6.BA.90"></span><span class="mw-headline" id="相关资源">相关资源</span>
</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/systemd" class="extiw" title="wikipedia:systemd">Wikipedia article</a></li>
<li><a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd">systemd Official web site</a></li>
<li><a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/Optimizations">systemd optimizations</a></li>
<li><a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/FrequentlyAskedQuestions">systemd FAQ</a></li>
<li><a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/TipsAndTricks">systemd Tips and tricks</a></li>
<li><a rel="nofollow" class="external text" href="http://wiki.gentoo.org/wiki/Systemd">Gentoo Wiki systemd page</a></li>
<li><a rel="nofollow" class="external text" href="http://fedoraproject.org/wiki/Systemd">Fedora Project - About systemd</a></li>
<li><a rel="nofollow" class="external text" href="http://fedoraproject.org/wiki/How_to_debug_Systemd_problems">Fedora Project - How to debug systemd problems</a></li>
<li><a rel="nofollow" class="external text" href="http://fedoraproject.org/wiki/SysVinit_to_Systemd_Cheatsheet">Fedora Project - SysVinit to systemd cheatsheet</a></li>
<li><a href="https://wiki.debian.org/systemd" class="extiw" title="debian:systemd">Debian Wiki systemd page</a></li>
<li><a rel="nofollow" class="external text" href="http://0pointer.de/public/systemd-man/">Manual pages</a></li>
<li>
<a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd.html">Lennart's blog story</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd-update.html">update 1</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd-update-2.html">update 2</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd-update-3.html">update 3</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/why.html">summary</a>
</li>
<li><a rel="nofollow" class="external text" href="http://0pointer.de/public/systemd-ebook-psankar.pdf">systemd for Administrators (PDF)</a></li>
<li><a rel="nofollow" class="external text" href="https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units">How To Use Systemctl to Manage Systemd Services and Units </a></li>
<li><a rel="nofollow" class="external text" href="https://dvdhrm.wordpress.com/2013/08/24/session-management-on-linux/">Session management with systemd-logind</a></li>
<li><a href="../en/Emacs.html#Syntax_highlighting_for_systemd_Files" title="Emacs">Emacs Syntax highlighting for Systemd files</a></li>
<li>
<a rel="nofollow" class="external text" href="http://www.h-online.com/open/features/Control-Centre-The-systemd-Linux-init-system-1565543.html">Two</a> <a rel="nofollow" class="external text" href="http://www.h-online.com/open/features/Booting-up-Tools-and-tips-for-systemd-1570630.html">part</a> introductory article in <i>The H Open</i> magazine.</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Init.html" title="Category:Init (简体中文)">Init (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=637000">https://wiki.archlinux.org/index.php?title=Systemd_(简体中文)&amp;oldid=637000</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 2 October 2020, at 12:36.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
